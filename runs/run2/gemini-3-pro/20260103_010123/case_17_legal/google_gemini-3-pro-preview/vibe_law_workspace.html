<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vibe-Law | Legal Workspace</title>
    <style>
        :root {
            --bg-dark: #121212;
            --bg-panel: #1e1e1e;
            --bg-header: #252526;
            --bg-hover: #2a2d2e;
            --bg-active: #37373d;
            --accent: #007acc;
            --accent-hover: #0062a3;
            --text-main: #e1e1e1;
            --text-muted: #a0a0a0;
            --border: #333333;
            --highlight: #ffd700;
            --highlight-text: #000000;
            --entity-name: #4ec9b0;
            --entity-date: #ce9178;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-dark);
            color: var(--text-main);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            font-size: 14px;
        }

        /* Header */
        header {
            background-color: var(--bg-header);
            border-bottom: 1px solid var(--border);
            padding: 0 20px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-shrink: 0;
        }

        .logo {
            font-weight: 700;
            font-size: 18px;
            letter-spacing: -0.5px;
            color: var(--text-main);
            margin-right: 40px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo span {
            color: var(--accent);
        }

        .search-container {
            flex: 1;
            max-width: 600px;
            position: relative;
        }

        .search-input {
            width: 100%;
            background-color: var(--bg-dark);
            border: 1px solid var(--border);
            color: var(--text-main);
            padding: 8px 12px;
            border-radius: 4px;
            outline: none;
            font-size: 13px;
        }

        .search-input:focus {
            border-color: var(--accent);
        }

        /* Main Workspace */
        .workspace {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* Results List (Left Pane) */
        .results-pane {
            width: 350px;
            border-right: 1px solid var(--border);
            background-color: var(--bg-panel);
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
        }

        .results-header {
            padding: 10px 15px;
            border-bottom: 1px solid var(--border);
            font-size: 11px;
            text-transform: uppercase;
            color: var(--text-muted);
            letter-spacing: 1px;
            display: flex;
            justify-content: space-between;
        }

        .case-list {
            overflow-y: auto;
            flex: 1;
        }

        .case-item {
            padding: 15px;
            border-bottom: 1px solid var(--border);
            cursor: pointer;
            transition: background 0.2s;
        }

        .case-item:hover {
            background-color: var(--bg-hover);
        }

        .case-item.active {
            background-color: var(--bg-active);
            border-left: 3px solid var(--accent);
        }

        .case-title {
            font-weight: 600;
            margin-bottom: 4px;
            color: var(--accent);
        }

        .case-meta {
            font-size: 11px;
            color: var(--text-muted);
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
        }

        .case-snippet {
            font-size: 12px;
            color: var(--text-main);
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            opacity: 0.8;
        }

        /* Detail View (Right Pane) */
        .detail-pane {
            flex: 1;
            display: flex;
            flex-direction: column;
            background-color: var(--bg-dark);
            overflow: hidden;
        }

        .empty-state {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: var(--text-muted);
            font-style: italic;
        }

        /* Detail Header */
        .detail-header {
            padding: 20px;
            background-color: var(--bg-panel);
            border-bottom: 1px solid var(--border);
        }

        .detail-title {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .detail-meta {
            color: var(--text-muted);
            font-size: 12px;
            display: flex;
            gap: 15px;
        }

        /* Toolbar */
        .toolbar {
            padding: 10px 20px;
            background-color: var(--bg-panel);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .tabs {
            display: flex;
            gap: 5px;
        }

        .tab-btn {
            background: none;
            border: none;
            color: var(--text-muted);
            padding: 6px 12px;
            cursor: pointer;
            font-size: 13px;
            border-radius: 3px;
        }

        .tab-btn:hover {
            color: var(--text-main);
            background-color: var(--bg-hover);
        }

        .tab-btn.active {
            color: var(--text-main);
            background-color: var(--bg-active);
            font-weight: 600;
        }

        .action-btn {
            background-color: var(--accent);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
        }

        .action-btn:hover {
            background-color: var(--accent-hover);
        }

        .action-btn.secondary {
            background-color: transparent;
            border: 1px solid var(--border);
            color: var(--text-main);
        }

        .action-btn.secondary:hover {
            background-color: var(--bg-hover);
        }

        /* Content Area (Split for Notes) */
        .content-wrapper {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .document-view {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            line-height: 1.6;
            font-family: "Georgia", serif;
            font-size: 16px;
            color: #dcdcdc;
            position: relative;
        }

        /* Notes Sidebar */
        .notes-sidebar {
            width: 300px;
            background-color: var(--bg-panel);
            border-left: 1px solid var(--border);
            display: flex;
            flex-direction: column;
        }

        .notes-header {
            padding: 10px 15px;
            border-bottom: 1px solid var(--border);
            font-weight: 600;
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            background-color: var(--bg-header);
        }

        .notes-list {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
        }

        .note-card {
            background-color: var(--bg-dark);
            border: 1px solid var(--border);
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 4px;
            font-size: 12px;
            position: relative;
            animation: fadeIn 0.3s ease;
        }

        .note-card .delete-note {
            position: absolute;
            top: 5px;
            right: 5px;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 14px;
        }
        
        .note-card .delete-note:hover {
            color: #ff5555;
        }

        .note-text {
            color: var(--text-main);
            word-wrap: break-word;
        }

        .note-timestamp {
            font-size: 10px;
            color: var(--text-muted);
            margin-top: 5px;
            text-align: right;
        }

        .notes-input-area {
            padding: 15px;
            border-top: 1px solid var(--border);
            background-color: var(--bg-panel);
        }

        .note-input {
            width: 100%;
            background-color: var(--bg-dark);
            border: 1px solid var(--border);
            color: var(--text-main);
            padding: 8px;
            border-radius: 4px;
            resize: none;
            height: 60px;
            margin-bottom: 8px;
            font-size: 12px;
        }

        .note-input:focus {
            border-color: var(--accent);
            outline: none;
        }

        /* Entity Highlighting */
        .highlight-entity-name {
            background-color: rgba(78, 201, 176, 0.2);
            color: var(--entity-name);
            border-bottom: 1px solid var(--entity-name);
            padding: 0 2px;
            border-radius: 2px;
        }

        .highlight-entity-date {
            background-color: rgba(206, 145, 120, 0.2);
            color: var(--entity-date);
            border-bottom: 1px solid var(--entity-date);
            padding: 0 2px;
            border-radius: 2px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }
        ::-webkit-scrollbar-thumb {
            background: #424242;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #4f4f4f;
        }

    </style>
</head>
<body>

<header>
    <div class="logo">Vibe<span>Law</span></div>
    <div class="search-container">
        <input type="text" id="searchInput" class="search-input" placeholder="Search case law, statutes, or entities...">
    </div>
    <div style="font-size: 12px; color: var(--text-muted);">User: Associate_007</div>
</header>

<div class="workspace">
    <!-- Left Pane: Results -->
    <div class="results-pane">
        <div class="results-header">
            <span>Query Results</span>
            <span id="resultCount">0 Cases</span>
        </div>
        <div id="caseList" class="case-list">
            <!-- Items injected by JS -->
        </div>
    </div>

    <!-- Right Pane: Detail View -->
    <div class="detail-pane" id="detailPane">
        <div class="empty-state">Select a case to view details</div>
        <!-- Content injected by JS -->
    </div>
</div>

<script>
/**
 * MOCK DATA
 */
const mockCases = [
    {
        id: "c1",
        title: "TechnoCorp v. State of California",
        court: "Supreme Court of California",
        date: "2023-05-12",
        summary: "A landmark ruling concerning data privacy rights for autonomous vehicle passengers. The court held that biometric data collected without explicit consent violates the State Privacy Act.",
        fullText: "IN THE SUPREME COURT OF CALIFORNIA\n\nTECHNOCORP, Plaintiff and Appellant,\nv.\nSTATE OF CALIFORNIA, Defendant and Respondent.\n\nFiled May 12, 2023\n\nOPINION OF THE COURT\n\nJUSTICE ALVARADO delivered the opinion of the Court.\n\nThis case presents a novel question regarding the intersection of autonomous vehicle technology and individual privacy rights. Plaintiff TechnoCorp argues that the collection of passenger biometric data is necessary for safety protocols. However, the State of California contends that such collection without explicit, opt-in consent violates the California Consumer Privacy Act (CCPA) of 2018.\n\nWe agree with the State. The record shows that on January 15, 2022, TechnoCorp implemented firmware version 4.5 which enabled continuous facial recognition scanning. Users were not notified. This constitutes a breach of reasonable expectation of privacy.\n\nFurthermore, referencing the precedent set in United States v. Jones (2012), the physical intrusion into the private sphere of the vehicle cabin for data mining purposes is unconstitutional under state statutes. The argument that 'safety requires surveillance' is rejected when less intrusive means are available.\n\nThe judgment of the Court of Appeal is affirmed.",
    },
    {
        id: "c2",
        title: "In re Estate of Harrison",
        court: "New York Surrogate's Court",
        date: "2021-11-03",
        summary: "Dispute over the validity of a digital will signed via blockchain authentication. The court recognized the digital signature as valid under the E-SIGN Act.",
        fullText: "SURROGATE'S COURT OF THE STATE OF NEW YORK\nCOUNTY OF NEW YORK\n\nIn the Matter of the Estate of\nARTHUR HARRISON, Deceased.\n\nDECISION AND ORDER\n\nNovember 3, 2021\n\nThe Petitioner, Sarah Harrison, seeks probate of an instrument purporting to be the Last Will and Testament of the decedent, Arthur Harrison. The instrument in question exists solely as a smart contract on the Ethereum blockchain, executed on August 20, 2021.\n\nObjectants argue that the will fails to meet the formalities required by EPTL 3-2.1 because it was not signed in the physical presence of witnesses. However, the digital audit trail confirms that two witnesses digitally signed the transaction hash within minutes of the testator.\n\nUnder the Electronic Signatures in Global and National Commerce Act (E-SIGN Act), electronic signatures cannot be denied legal effect solely because they are electronic. This court finds that the cryptographic signature provided by the decedent constitutes a valid subscription.\n\nProbate is granted.",
    },
    {
        id: "c3",
        title: "Global Finance Ltd. v. Delta Hedge Fund",
        court: "U.S. District Court, S.D.N.Y.",
        date: "2022-02-14",
        summary: "Breach of contract suit involving high-frequency trading algorithms. The court dismissed the motion to dismiss, citing sufficient evidence of bad faith manipulation.",
        fullText: "UNITED STATES DISTRICT COURT\nSOUTHERN DISTRICT OF NEW YORK\n\nGLOBAL FINANCE LTD.,\nPlaintiff,\nv.\nDELTA HEDGE FUND,\nDefendant.\n\nCase No. 21-cv-5509\n\nMEMORANDUM OPINION\n\nFebruary 14, 2022\n\nJUDGE MERCER:\n\nPlaintiff alleges that Defendant Delta Hedge Fund utilized a 'spoofing' algorithm to artificially depress the price of certain securities, thereby triggering a liquidation clause in the parties' Master Service Agreement (MSA).\n\nDefendant moves to dismiss under Rule 12(b)(6). The motion is DENIED.\n\nThe complaint details specific trading patterns on December 10, 2021, where Defendant placed and immediately canceled orders. These actions, if proven, constitute market manipulation under the Commodity Exchange Act. The MSA implies a covenant of good faith and fair dealing, which is fundamentally breached by illegal market manipulation aimed at the counterparty.\n\nDiscovery shall proceed.",
    },
    {
        id: "c4",
        title: "Rivera v. City of Austin",
        court: "Texas Court of Appeals",
        date: "2020-08-30",
        summary: "Zoning dispute regarding the construction of a commercial high-rise in a historic preservation district. The court sided with the preservation society.",
        fullText: "TEXAS COURT OF APPEALS, THIRD DISTRICT, AT AUSTIN\n\nNO. 03-19-00451-CV\n\nMARIA RIVERA, Appellant,\nv.\nCITY OF AUSTIN, Appellee.\n\nOPINION\n\nAugust 30, 2020\n\nAppellant Maria Rivera challenges the City of Austin's denial of a building permit for a 40-story mixed-use tower at 400 Congress Avenue. The site is located within the Congress Avenue Historic District.\n\nThe City Council denied the permit based on Code Ordinance 25-2-101, which limits building height to preserve the view corridor of the State Capitol. Rivera argues this constitutes a regulatory taking.\n\nWe find that the preservation of historic landmarks and view corridors is a legitimate government interest. The regulation does not deprive the owner of all economically viable use of the land, merely the most profitable use. Under the Penn Central transportation Co. v. New York City (1978) test, no taking has occurred.\n\nAffirmed.",
    },
    {
        id: "c5",
        title: "United States v. O'Malley",
        court: "U.S. Court of Appeals, 1st Circuit",
        date: "2019-04-15",
        summary: "Criminal appeal regarding the admissibility of evidence obtained from a smart home assistant (Alexa).",
        fullText: "UNITED STATES COURT OF APPEALS\nFOR THE FIRST CIRCUIT\n\nNo. 18-1234\n\nUNITED STATES OF AMERICA,\nAppellee,\nv.\nSEAN O'MALLEY,\nDefendant, Appellant.\n\nApril 15, 2019\n\nBefore LYNCH, KAYATTA, and BARRON, Circuit Judges.\n\nDefendant appeals his conviction for wire fraud. The primary issue is whether the District Court erred in admitting audio recordings captured by an Amazon Echo device located in the defendant's kitchen.\n\nO'Malley argues he had a reasonable expectation of privacy. However, the device was activated by the 'wake word.' By voluntarily interacting with a third-party device that transmits data to the cloud, the defendant assumed the risk of disclosure. The Third Party Doctrine applies here.\n\nFurthermore, the warrant obtained by the FBI to request these logs from Amazon was supported by probable cause based on independent evidence. The Fourth Amendment rights of the defendant were not violated.\n\nConviction affirmed.",
    },
    {
        id: "c6",
        title: "Green Energy Corp v. SolarTech Inc.",
        court: "Delaware Court of Chancery",
        date: "2023-01-22",
        summary: "Patent infringement and trade secret misappropriation regarding next-gen photovoltaic cells.",
        fullText: "IN THE COURT OF CHANCERY OF THE STATE OF DELAWARE\n\nGREEN ENERGY CORP,\nPlaintiff,\nv.\nSOLARTECH INC.,\nDefendant.\n\nC.A. No. 2022-0891-JTL\n\nMEMORANDUM OPINION\n\nJanuary 22, 2023\n\nVICE CHANCELLOR LASTER:\n\nThis is a case about solar panels and corporate espionage. Plaintiff alleges that its former Chief Technology Officer, Dr. Elena Rostova, downloaded gigabytes of proprietary schematics before resigning to join Defendant SolarTech.\n\nThe evidence presented at the preliminary injunction hearing is damning. Server logs from October 2022 show massive data exfiltration at 3:00 AM from Rostova's workstation. SolarTech's new 'Helios' product line bears striking similarities to Green Energy's 'Apollo' prototype.\n\nThe motion for Preliminary Injunction is GRANTED. SolarTech is enjoined from selling, marketing, or producing the Helios line pending final adjudication.",
    },
    {
        id: "c7",
        title: "Doe v. Meta-Health",
        court: "U.S. District Court, N.D. Cal.",
        date: "2023-09-10",
        summary: "Class action lawsuit alleging negligence in handling patient mental health records within a VR therapy app.",
        fullText: "UNITED STATES DISTRICT COURT\nNORTHERN DISTRICT OF CALIFORNIA\n\nJANE DOE, on behalf of herself and others similarly situated,\nPlaintiff,\nv.\nMETA-HEALTH INC.,\nDefendant.\n\nORDER DENYING MOTION TO COMPEL ARBITRATION\n\nSeptember 10, 2023\n\nPlaintiff brings this class action alleging that Meta-Health's VR therapy application leaked sensitive patient conversations to advertisers. Defendant moves to compel arbitration based on the Terms of Service (TOS).\n\nThe Court finds that the arbitration clause was buried in a 'browsewrap' agreement that did not provide sufficient notice to the consumer. The hyperlink to the TOS was small, grey, and located at the bottom of the sign-up screen. Under Nguyen v. Barnes & Noble Inc., this does not constitute valid assent.\n\nGiven the sensitive nature of health data (PHI), a higher standard of notice is appropriate. The motion is denied.",
    },
    {
        id: "c8",
        title: "State v. Peterson",
        court: "Minnesota Supreme Court",
        date: "2018-11-20",
        summary: "Appeal regarding the definition of 'constructive possession' of narcotics found in a shared vehicle.",
        fullText: "STATE OF MINNESOTA\nIN SUPREME COURT\n\nA17-0982\n\nState of Minnesota,\nRespondent,\nv.\nLars Peterson,\nAppellant.\n\nFiled: November 20, 2018\n\nAppellant was convicted of fifth-degree possession of a controlled substance. The drugs were found in the glove compartment of a car he was driving but did not own. There were two passengers in the car.\n\nTo prove constructive possession, the State must show that the defendant exercised dominion and control over the area where the contraband was found. Here, the car belonged to Appellant's girlfriend. No fingerprints were found on the baggies.\n\nMere proximity is insufficient to establish possession. Without corroborating evidence linking Peterson specifically to the drugs, the evidence is insufficient as a matter of law.\n\nReversed.",
    },
    {
        id: "c9",
        title: "Orbital Logistics v. SpaceX",
        court: "Federal Aviation Administration Adjudication",
        date: "2024-02-01",
        summary: "Regulatory dispute over launch window priority and orbital debris mitigation plans.",
        fullText: "BEFORE THE FEDERAL AVIATION ADMINISTRATION\nWASHINGTON, D.C.\n\nIn the Matter of\nORBITAL LOGISTICS, LLC\nand\nSPACEX EXPLORATION TECHNOLOGIES CORP.\n\nDocket No. FAA-2023-9901\n\nORDER REGARDING LAUNCH ALLOCATION\n\nFebruary 1, 2024\n\nOrbital Logistics challenges the assignment of the February 14, 2024 launch window at Kennedy Space Center Pad 39A to SpaceX. Orbital claims it had reserved the slot for its Heavy-Lift Cargo mission.\n\nThe FAA Office of Commercial Space Transportation has reviewed the manifest. Priority is generally given to missions critical to national infrastructure. The SpaceX mission carries a classified payload for the NRO.\n\nFurthermore, Orbital's debris mitigation plan was found deficient by the FCC in a report dated January 10, 2024. Until the mitigation plan is updated to comply with new sustainability standards, Orbital's launch license is suspended.\n\nPetition denied.",
    },
    {
        id: "c10",
        title: "Baker v. NeuralLink Interface",
        court: "Nevada District Court",
        date: "2025-06-15",
        summary: "Product liability case involving a malfunction of a brain-computer interface causing motor control loss.",
        fullText: "DISTRICT COURT\nCLARK COUNTY, NEVADA\n\nJOHN BAKER,\nPlaintiff,\nv.\nNEURALLINK INTERFACE CORP.,\nDefendant.\n\nCase No. A-25-890123-C\n\nCOMPLAINT FOR DAMAGES\n\nJune 15, 2025\n\nCOMES NOW Plaintiff John Baker and alleges as follows:\n\n1. On March 1, 2025, Plaintiff underwent surgery to implant the 'Cortex-V' chip manufactured by Defendant.\n2. The device was marketed as a tool to enhance memory recall.\n3. On April 10, 2025, a software update caused the device to send erratic electrical impulses to Plaintiff's motor cortex.\n4. As a result, Plaintiff suffered temporary paralysis of the left arm and severe migraines.\n\nPlaintiff asserts claims for Strict Product Liability, Negligence, and Breach of Implied Warranty. The software update was not adequately tested (beta testing was bypassed to meet quarterly goals).",
    }
];

/**
 * STATE MANAGEMENT
 */
const state = {
    cases: mockCases,
    searchQuery: "",
    selectedCaseId: null,
    activeTab: "summary", // 'summary' or 'fullText'
    entitiesHighlighted: false
};

/**
 * UTILS
 */
function getNotes(caseId) {
    const saved = localStorage.getItem(`vibe_law_notes_${caseId}`);
    return saved ? JSON.parse(saved) : [];
}

function saveNote(caseId, text) {
    if (!text.trim()) return;
    const notes = getNotes(caseId);
    const newNote = {
        id: Date.now(),
        text: text,
        timestamp: new Date().toLocaleString()
    };
    notes.unshift(newNote);
    localStorage.setItem(`vibe_law_notes_${caseId}`, JSON.stringify(notes));
    renderNotes(caseId);
}

function deleteNote(caseId, noteId) {
    let notes = getNotes(caseId);
    notes = notes.filter(n => n.id !== noteId);
    localStorage.setItem(`vibe_law_notes_${caseId}`, JSON.stringify(notes));
    renderNotes(caseId);
}

/**
 * RENDER FUNCTIONS
 */

function renderCaseList() {
    const listEl = document.getElementById('caseList');
    const countEl = document.getElementById('resultCount');
    
    // Filter
    const query = state.searchQuery.toLowerCase();
    const filtered = state.cases.filter(c => 
        c.title.toLowerCase().includes(query) || 
        c.court.toLowerCase().includes(query) ||
        c.summary.toLowerCase().includes(query)
    );

    countEl.textContent = `${filtered.length} Case${filtered.length !== 1 ? 's' : ''}`;
    listEl.innerHTML = '';

    filtered.forEach(c => {
        const item = document.createElement('div');
        item.className = `case-item ${state.selectedCaseId === c.id ? 'active' : ''}`;
        item.onclick = () => selectCase(c.id);
        
        item.innerHTML = `
            <div class="case-title">${c.title}</div>
            <div class="case-meta">
                <span>${c.court}</span>
                <span>${c.date}</span>
            </div>
            <div class="case-snippet">${c.summary}</div>
        `;
        listEl.appendChild(item);
    });
}

function selectCase(id) {
    state.selectedCaseId = id;
    state.entitiesHighlighted = false; // Reset toggle on new case
    state.activeTab = 'summary'; // Reset tab
    renderCaseList();
    renderDetailView();
}

function renderDetailView() {
    const pane = document.getElementById('detailPane');
    const c = state.cases.find(x => x.id === state.selectedCaseId);

    if (!c) {
        pane.innerHTML = '<div class="empty-state">Select a case to view details</div>';
        return;
    }

    // Determine content based on tab
    let contentHtml = '';
    if (state.activeTab === 'summary') {
        contentHtml = `<p>${c.summary}</p>`;
    } else {
        // Full text formatted
        contentHtml = c.fullText.split('\n').map(line => line.trim() ? `<p>${line}</p>` : '<br>').join('');
    }

    // Process highlighting if active
    if (state.entitiesHighlighted) {
        // Highlight Dates (YYYY-MM-DD or Month DD, YYYY or just YYYY)
        // Simple regex for demonstration
        const dateRegex = /\b(January|February|March|April|May|June|July|August|September|October|November|December)\s+\d{1,2},?\s+\d{4}\b|\b\d{4}-\d{2}-\d{2}\b|\b(19|20)\d{2}\b/g;
        
        // Highlight Capitalized Names (Approximate: Capitalized words not at start of sentence is hard without NLP, 
        // so we'll just look for specific patterns or just capitalized words for the "simulation" vibe)
        // Let's improve: Look for "Mr. X", "Ms. Y", "Company Inc", or just capitalized words within the text.
        // For a coding challenge, simple is better. Let's highlight specific legal entities or capitalized phrases.
        const nameRegex = /\b([A-Z][a-z]+(\s[A-Z][a-z]+)+)\b/g; 

        contentHtml = contentHtml.replace(dateRegex, match => `<span class="highlight-entity-date" title="Date Entity">${match}</span>`);
        contentHtml = contentHtml.replace(nameRegex, match => `<span class="highlight-entity-name" title="Named Entity">${match}</span>`);
    }

    pane.innerHTML = `
        <div class="detail-header">
            <div class="detail-title">${c.title}</div>
            <div class="detail-meta">
                <span><strong>Court:</strong> ${c.court}</span>
                <span><strong>Date:</strong> ${c.date}</span>
                <span><strong>ID:</strong> ${c.id.toUpperCase()}</span>
            </div>
        </div>
        <div class="toolbar">
            <div class="tabs">
                <button class="tab-btn ${state.activeTab === 'summary' ? 'active' : ''}" onclick="switchTab('summary')">Summary</button>
                <button class="tab-btn ${state.activeTab === 'fullText' ? 'active' : ''}" onclick="switchTab('fullText')">Full Text</button>
            </div>
            <div style="display:flex; gap:10px;">
                <button class="action-btn secondary" onclick="toggleEntities()">
                    ${state.entitiesHighlighted ? 'Hide Entities' : 'Extract Entities'}
                </button>
                <button class="action-btn" onclick="copySelectionToNotes()">
                    + Add Selection to Notes
                </button>
            </div>
        </div>
        <div class="content-wrapper">
            <div class="document-view" id="documentView">
                ${contentHtml}
            </div>
            <div class="notes-sidebar">
                <div class="notes-header">Case Notes</div>
                <div class="notes-input-area">
                    <textarea id="noteInput" class="note-input" placeholder="Type a note here..."></textarea>
                    <button class="action-btn" style="width:100%" onclick="addManualNote()">Save Note</button>
                </div>
                <div id="notesList" class="notes-list">
                    <!-- Notes injected here -->
                </div>
            </div>
        </div>
    `;

    renderNotes(c.id);
}

function switchTab(tab) {
    state.activeTab = tab;
    renderDetailView();
}

function toggleEntities() {
    state.entitiesHighlighted = !state.entitiesHighlighted;
    renderDetailView();
}

function renderNotes(caseId) {
    const listEl = document.getElementById('notesList');
    if (!listEl) return; // Might not be rendered yet

    const notes = getNotes(caseId);
    listEl.innerHTML = '';

    if (notes.length === 0) {
        listEl.innerHTML = '<div style="color:var(--text-muted); text-align:center; margin-top:20px;">No notes yet.</div>';
        return;
    }

    notes.forEach(note => {
        const div = document.createElement('div');
        div.className = 'note-card';
        div.innerHTML = `
            <div class="delete-note" onclick="deleteNote('${caseId}', ${note.id})">&times;</div>
            <div class="note-text">${note.text}</div>
            <div class="note-timestamp">${note.timestamp}</div>
        `;
        listEl.appendChild(div);
    });
}

function addManualNote() {
    const input = document.getElementById('noteInput');
    if (input && state.selectedCaseId) {
        saveNote(state.selectedCaseId, input.value);
        input.value = '';
    }
}

function copySelectionToNotes() {
    const selection = window.getSelection().toString();
    if (selection && state.selectedCaseId) {
        saveNote(state.selectedCaseId, `"${selection}"`);
    } else {
        alert("Please select text in the document view first.");
    }
}

/**
 * EVENT LISTENERS
 */
document.getElementById('searchInput').addEventListener('input', (e) => {
    state.searchQuery = e.target.value;
    renderCaseList();
});

// Initial Render
renderCaseList();

</script>
</body>
</html>