<!DOCTYPE html>
<html>
<head>
   <title>Color Palette Generator</title>
   <style>
      body {
         font-family: Arial, sans-serif;
         max-width: 500px;
         margin: 20px auto;
         padding: 20px;
      }
      h1 {
         text-align: center;
         color: #333;
      }
      #color-container {
         display: flex;
         flex-wrap: wrap;
         gap: 10px;
      }
      .color-tile {
         width: 100px;
         height: 100px;
         margin: 5px;
         border: 1px solid #ddd;
         transition: background-color 0.3s ease, transform 0.3s ease;
         background-color: #000;
         border-radius: 5px;
         overflow: hidden;
         transform: translate(-5px, -5px);
      }
      .color-tile:hover {
         transform: translate(5px, 5px);
      }
      .info {
         padding: 5px;
         margin-top: 5px;
         font-size: 12px;
      }
      .copy-btn {
         cursor: pointer;
         margin-right: 5px;
         color: white;
         background: none;
         border: none;
         padding: 2px 5px;
         transition: background 0.2s;
      }
      .copy-btn:active {
         transform: scale(0.95);
      }
      .lock-btn {
         display: block;
         width: 100%;
         text-align: center;
         margin-top: 5px;
     }
      .locked {
         background: rgba(76, 175, 80, 0.15);
         border-color: #4CAF50;
         transition: background 0.3s, transform 0.3s;
      }
      .locked:active {
         transform: scale(1.05);
      }
      button {
         margin: 10px;
         padding: 8px 16px;
         background: #4CAF50;
         color: white;
         border: none;
         border-radius: 4px;
         cursor: pointer;
         transition: background 0.2s;
      }
      button:hover {
         background: #45a049;
      }
   </style>
</head>
<body>
   <h1>Color Palette Generator</h1>
   <div id="color-container"></div>
   <button id="save-btn">Save Palette</button>
   <button id="generate-btn">Generate</button>
   <button id="load-btn" onclick="loadPalette()">Load Saved</button>
   <script>
let currentPalette = [];
let locked = Array(5).fill(false);

function randomHexColor() {
   const colorCode = Math.floor(Math.random() * 16777215).toString(16);
   return `#${colorCode.padStart(6, '0')}`;
}

function hexToRgb(hex) {
   hex = hex.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i, function(m, r, g, b) {
      return r + r + g + g + b + b;
   });
   const match = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
   if (!match) return '0, 0, 0';
   const r = parseInt(match[1], 16);
   const g = parseInt(match[2], 16);
   const b = parseInt(match[3], 16);
   return `${r}, ${g}, ${b}`;
}

function copyColor(button) {
   navigator.clipboard.writeText(button.dataset.color).then(() => {
      button.textContent = 'Copied!';
      setTimeout(() => button.textContent = '✓', 2000);
   }).catch(console.error);
}

function toggleLock(index) {
   locked[index] = !locked[index];
   const tile = document.querySelector(`.color-tile:nth-child(${index + 1})`);
   tile.classList.toggle('locked', locked[index]);
   const lockBtn = tile.querySelector('.lock-btn');
   lockBtn.textContent = locked[index] ? 'Locked' : 'Lock';
}

function generatePalette() {
   const used = new Set(currentPalette); // Ensures all colors are unique
   const newColors = [];
   const needed = 5 - locked.filter(b => b).length;
   
   while (newColors.length < needed) {
      const color = randomHexColor();
      if (!used.has(color) && !newColors.includes(color)) {
         used.add(color);
         newColors.push(color);
      }
   }
   
   const newPalette = [];
   let newColorIndex = 0;
   for (let i = 0; i < 5; i++) {
      if (locked[i]) {
         newPalette.push(currentPalette[i]);
      } else {
         newPalette.push(newColors[newColorIndex]);
         newColorIndex++;
      }
   }
   currentPalette = newPalette;
   updateTiles();
}

function updateTiles() {
   const container = document.getElementById('color-container');
   container.innerHTML = '';
   currentPalette.forEach((color, index) => {
      const isLocked = locked[index];
      const tile = document.createElement('div');
      tile.className = 'color-tile';
      tile.style.backgroundColor = color;
      tile.dataset.color = color;
      
      const info = document.createElement('div');
      info.className = 'info';
      info.innerHTML = `Hex: ${color} <span>RGB: ${hexToRgb(color)}</span>`;
      
      const copyBtn = document.createElement('span');
      copyBtn.className = 'copy-btn';
      copyBtn.dataset.color = color;
      copyBtn.textContent = '✓';
      copyBtn.onclick = function() { copyColor(this); };
      info.appendChild(copyBtn);
      
      const lockBtn = document.createElement('button');
      lockBtn.className = 'lock-btn';
      lockBtn.textContent = isLocked ? 'Locked' : 'Lock';
      lockBtn.onclick = function() { toggleLock(index); };
      
      tile.appendChild(info);
      tile.appendChild(lockBtn);
      container.appendChild(tile);
   });
}

window.onload = function() {
   const saved = localStorage.getItem('palette');
   if (saved) {
      currentPalette = JSON.parse(saved);
      updateTiles();
   } else {
      generatePalette();
   }
};

document.getElementById('save-btn').onclick = function() {
   localStorage.setItem('palette', JSON.stringify(currentPalette));
   alert('Palette saved!');
};

document.getElementById('generate-btn').onclick = generatePalette;
document.addEventListener('keydown', function(e) {
   if (e.key === ' ' && !e.ctrlKey && !e.metaKey && !e.shiftKey) {
      generatePalette();
   }
});
</script>
</body>
</html>