<!DOCTYPE html>
<html>
<head>
    <title>Typing Speed Test</title>
    <style>
        body { font-family: Arial, sans-serif; }
        #displayText { font-size: 16px; }
        #inputBox { width: 100%; height: 200px; padding: 10px; }
        #charHighlight { font-size: 18px; }
        .correct { color: green; }
        .incorrect { color: red; }
        #results { display: none; }
    </style>
</head>
<body>
    <button id="startBtn">Start Typing Test</button>
    <div id="displayText"></div>
    <textarea id="inputBox"></textarea>
    <div id="charHighlight"></div>
    <div>
        <p>Time: <span id="timer">30s</span></p>
        <p>Accuracy: <span id="accuracy">0%</span></p>
        <p>WPM: <span id="wpm">0</span></p>
    </div>
    <div id="results" style="display: none;">
        <p>Final Accuracy: <span id="finalAccuracy">0%</span></p>
        <p>WPM: <span id="finalWPM">0</span></p>
        <button onclick="startTest()">Try Again</button>
    </div>
    <script>
const SAMPLE_TEXTS = [
    "The quick brown fox jumps over the lazy dog.",
    "Python is a high-level, interpreted, general-purpose programming language.",
    "Efficient and clean code is essential for maintainability.",
    "Data structures and algorithms are fundamental to computer science.",
    "Machine learning involves training models to make predictions or decisions.",
    "Web development often uses HTML, CSS, and JavaScript for building interactive sites.",
    "Version control systems like Git help manage changes in code.",
    "Testing ensures software reliability and reduces bugs.",
    "Optimizing code can significantly improve performance and resource usage.",
    "Understanding complexity is crucial for writing efficient algorithms."
];

let targetText = '';
let startTime = null;
let timerInterval = null;
let isTesting = false;

function startTest() {
    const startBtn = document.getElementById('startBtn');
    startBtn.style.display = 'none';
    const inputBox = document.getElementById('inputBox');
    inputBox.style.display = 'block';
    
    targetText = SAMPLE_TEXTS[Math.floor(Math.random() * SAMPLE_TEXTS.length)];
    document.getElementById('displayText').textContent = targetText;
    inputBox.value = '';
    
    document.getElementById('timer').textContent = '30s';
    document.getElementById('accuracy').textContent = '0%';
    document.getElementById('wpm').textContent = '0';
    document.getElementById('results').style.display = 'none';
    
    startTime = new Date().getTime();
    timerInterval = setInterval(() => {
        const now = new Date().getTime();
        const elapsed = (now - startTime) / 1000;
        const remaining = 30 - Math.floor(elapsed);
        if (remaining <= 0) {
            clearInterval(timerInterval);
            showResults();
        } else {
            document.getElementById('timer').textContent = remaining + 's';
        }
    }, 1000);
    
    inputBox.addEventListener('input', () => {
        updateStats();
        updateHighlight();
    });
    isTesting = true;
}

function updateStats() {
    if (!isTesting) return;
    const inputBox = document.getElementById('inputBox');
    const userText = inputBox.value;
    const accuracyDiv = document.getElementById('accuracy');
    const wpmDiv = document.getElementById('wpm');
    
    let correct = 0;
    const userLen = userText.length;
    if (userLen === 0) {
        accuracyDiv.textContent = '0%';
        return;
    }
    const targetLen = targetText.length;
    const minLen = Math.min(userLen, targetLen);
    for (let i = 0; i < minLen; i++) {
        if (userText[i] === targetText[i]) correct++;
    }
    const accuracy = Math.round((correct / userLen) * 100);
    accuracyDiv.textContent = accuracy + '%';
    
    const now = new Date().getTime();
    const elapsedSec = (now - startTime) / 1000;
    let correctCount = 0;
    for (let i = 0; i < targetLen; i++) {
        if (i < userLen && userText[i] === targetText[i]) correctCount++;
    }
    const words = correctCount / 5;
    let wpm = 0;
    if (elapsedSec > 0) {
        const minutes = elapsedSec / 60;
        wpm = Math.round(words / minutes);
    }
    wpmDiv.textContent = wpm;
}

function updateHighlight() {
    if (!isTesting) return;
    const inputBox = document.getElementById('inputBox');
    const userText = inputBox.value;
    const highlightDiv = document.getElementById('charHighlight');
    highlightDiv.innerHTML = '';
    const target = targetText;
    for (let i = 0; i < userText.length; i++) {
        const char = userText[i];
        const targetChar = target[i];
        const span = document.createElement('span');
        span.textContent = char;
        span.className = targetChar === char ? 'correct' : 'incorrect';
        highlightDiv.appendChild(span);
    }
}

function showResults() {
    isTesting = false;
    const inputBox = document.getElementById('inputBox');
    inputBox.removeEventListener('input', updateStats);
    inputBox.disabled = true;
    
    const userText = inputBox.value;
    let finalCorrect = 0;
    const targetLen = targetText.length;
    const minLen = Math.min(userText.length, targetLen);
    for (let i = 0; i < minLen; i++) {
        if (userText[i] === targetText[i]) finalCorrect++;
    }
    const finalAccuracy = Math.round((finalCorrect / targetLen) * 100);
    document.getElementById('finalAccuracy').textContent = finalAccuracy + '%';
    
    const totalWords = finalCorrect / 5;
    const finalWPM = Math.round(totalWords / 0.5);
    document.getElementById('finalWPM').textContent = finalWPM;
    
    document.getElementById('results').style.display = 'block';
}
</script>
</body>
</html>