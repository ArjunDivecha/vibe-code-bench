<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Stopwatch & Timer</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background-color: #000;
            color: #0f0;
            text-align: center;
            padding: 20px;
        }
        .clock-display {
            font-size: 48px;
            margin: 20px 0;
            letter-spacing: 3px;
        }
        .controls, .mode-toggle, .input-time {
            margin: 10px 0;
        }
        button {
            font-size: 16px;
            margin: 5px;
            padding: 10px 20px;
            background-color: #222;
            color: #0f0;
            border: 1px solid #0f0;
            cursor: pointer;
        }
        button:hover {
            background-color: #0f0;
            color: #000;
        }
        .laps {
            text-align: left;
            max-width: 400px;
            margin: 0 auto;
        }
        .hidden {
            display: none;
        }
        input[type="number"] {
            width: 60px;
            font-size: 18px;
            text-align: center;
            background-color: #000;
            color: #0f0;
            border: 1px solid #0f0;
        }
    </style>
</head>
<body>
    <h1>Stopwatch & Timer</h1>
    <div class="mode-toggle">
        <button id="toggleMode">Switch to Timer</button>
    </div>

    <div id="stopwatchMode">
        <div class="clock-display" id="stopwatchDisplay">00:00:00.000</div>
        <div class="controls">
            <button id="startStopwatch">Start</button>
            <button id="stopStopwatch">Stop</button>
            <button id="lapStopwatch">Lap</button>
            <button id="resetStopwatch">Reset</button>
        </div>
        <div class="laps" id="lapsList"></div>
    </div>

    <div id="timerMode" class="hidden">
        <div class="input-time">
            <input type="number" id="timerHours" min="0" max="99" value="0"> :
            <input type="number" id="timerMinutes" min="0" max="59" value="0"> :
            <input type="number" id="timerSeconds" min="0" max="59" value="0">
        </div>
        <div class="clock-display" id="timerDisplay">00:00:00</div>
        <div class="controls">
            <button id="startTimer">Start</button>
            <button id="pauseTimer">Pause</button>
            <button id="resetTimer">Reset</button>
        </div>
    </div>

    <audio id="alarmSound">
        <source src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YQAAAAA=" type="audio/wav">
    </audio>

    <script>
        // Mode toggle
        const toggleBtn = document.getElementById('toggleMode');
        const stopwatchMode = document.getElementById('stopwatchMode');
        const timerMode = document.getElementById('timerMode');

        toggleBtn.addEventListener('click', () => {
            if (stopwatchMode.classList.contains('hidden')) {
                stopwatchMode.classList.remove('hidden');
                timerMode.classList.add('hidden');
                toggleBtn.textContent = "Switch to Timer";
            } else {
                stopwatchMode.classList.add('hidden');
                timerMode.classList.remove('hidden');
                toggleBtn.textContent = "Switch to Stopwatch";
            }
        });

        // Stopwatch logic
        let swStartTime = null;
        let swElapsed = 0;
        let swInterval = null;
        const swDisplay = document.getElementById('stopwatchDisplay');
        const swLaps = document.getElementById('lapsList');

        function formatTime(ms) {
            let milliseconds = ms % 1000;
            let totalSeconds = Math.floor(ms / 1000);
            let seconds = totalSeconds % 60;
            let minutes = Math.floor(totalSeconds / 60) % 60;
            let hours = Math.floor(totalSeconds / 3600);
            return (
                String(hours).padStart(2, '0') + ':' +
                String(minutes).padStart(2, '0') + ':' +
                String(seconds).padStart(2, '0') + '.' +
                String(milliseconds).padStart(3, '0')
            );
        }

        function updateStopwatch() {
            const now = Date.now();
            const diff = now - swStartTime + swElapsed;
            swDisplay.textContent = formatTime(diff);
        }

        document.getElementById('startStopwatch').addEventListener('click', () => {
            if (!swInterval) {
                swStartTime = Date.now();
                swInterval = setInterval(updateStopwatch, 50);
            }
        });

        document.getElementById('stopStopwatch').addEventListener('click', () => {
            if (swInterval) {
                clearInterval(swInterval);
                swInterval = null;
                swElapsed += Date.now() - swStartTime;
            }
        });

        document.getElementById('resetStopwatch').addEventListener('click', () => {
            clearInterval(swInterval);
            swInterval = null;
            swStartTime = null;
            swElapsed = 0;
            swDisplay.textContent = "00:00:00.000";
            swLaps.innerHTML = '';
        });

        document.getElementById('lapStopwatch').addEventListener('click', () => {
            if (swInterval) {
                const now = Date.now();
                const diff = now - swStartTime + swElapsed;
                const lap = document.createElement('div');
                lap.textContent = formatTime(diff);
                swLaps.appendChild(lap);
            }
        });

        // Timer logic
        let timerDuration = 0;
        let timerRemaining = 0;
        let timerInterval = null;
        let timerRunning = false;
        const timerDisplay = document.getElementById('timerDisplay');
        const alarm = document.getElementById('alarmSound');

        function formatCountdown(ms) {
            let totalSeconds = Math.ceil(ms / 1000);
            let seconds = totalSeconds % 60;
            let minutes = Math.floor(totalSeconds / 60) % 60;
            let hours = Math.floor(totalSeconds / 3600);
            return (
                String(hours).padStart(2, '0') + ':' +
                String(minutes).padStart(2, '0') + ':' +
                String(seconds).padStart(2, '0')
            );
        }

        function updateTimer() {
            timerRemaining -= 1000;
            if (timerRemaining <= 0) {
                clearInterval(timerInterval);
                timerInterval = null;
                timerDisplay.textContent = "00:00:00";
                alarm.play();
                return;
            }
            timerDisplay.textContent = formatCountdown(timerRemaining);
        }

        document.getElementById('startTimer').addEventListener('click', () => {
            if (!timerRunning) {
                let h = parseInt(document.getElementById('timerHours').value) || 0;
                let m = parseInt(document.getElementById('timerMinutes').value) || 0;
                let s = parseInt(document.getElementById('timerSeconds').value) || 0;
                timerDuration = (h * 3600 + m * 60 + s) * 1000;
                if (timerDuration <= 0) return;
                timerRemaining = timerDuration;
                timerDisplay.textContent = formatCountdown(timerRemaining);
                timerInterval = setInterval(updateTimer, 1000);
                timerRunning = true;
            }
        });

        document.getElementById('pauseTimer').addEventListener('click', () => {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
                timerRunning = false;
            } else if (timerRemaining > 0) {
                timerInterval = setInterval(updateTimer, 1000);
                timerRunning = true;
            }
        });

        document.getElementById('resetTimer').addEventListener('click', () => {
            clearInterval(timerInterval);
            timerInterval = null;
            timerRunning = false;
            timerDisplay.textContent = "00:00:00";
        });
    </script>
</body>
</html>