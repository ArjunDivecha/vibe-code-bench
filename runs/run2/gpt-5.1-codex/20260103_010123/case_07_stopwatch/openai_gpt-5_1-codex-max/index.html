<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Stopwatch & Timer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
    :root {
        --glow: #1eff8e;
        --bg: #0a0f0d;
        --panel: #101712;
    }
    * { box-sizing: border-box; }
    body {
        margin: 0;
        background: radial-gradient(circle at top left, #122218, #030503 60%);
        font-family: "Lucida Console", "Courier New", monospace;
        color: #e8ffe8;
        display: flex;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        padding: 20px;
    }
    .wrapper {
        width: 100%;
        max-width: 900px;
        background: rgba(10, 15, 12, 0.9);
        border: 2px solid #14301f;
        border-radius: 16px;
        padding: 24px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.45), inset 0 0 12px rgba(30,255,142,0.12);
    }
    h1 {
        text-align: center;
        margin-top: 0;
        letter-spacing: 2px;
        text-shadow: 0 0 10px #0f5, 0 0 20px rgba(30,255,142,0.4);
    }
    .mode-toggle {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-bottom: 18px;
    }
    .mode-btn {
        flex: 1;
        max-width: 200px;
        padding: 12px 16px;
        font-size: 15px;
        color: var(--glow);
        background: linear-gradient(135deg, #0c130f, #1b3122);
        border: 1px solid #124228;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.2s ease;
        text-transform: uppercase;
        letter-spacing: 1px;
    }
    .mode-btn.active {
        box-shadow: 0 0 12px rgba(30,255,142,0.35), inset 0 0 8px rgba(30,255,142,0.3);
        background: linear-gradient(135deg, #14241a, #214f31);
    }
    .panel { display: none; }
    .panel.active { display: block; }
    .display {
        background: #050805;
        border: 2px solid #0f5;
        border-radius: 14px;
        padding: 18px 22px;
        font-size: 48px;
        letter-spacing: 2px;
        color: #22ff99;
        text-align: center;
        text-shadow: 0 0 12px rgba(30,255,142,0.55), 0 0 25px rgba(30,255,142,0.35);
        box-shadow: inset 0 0 30px rgba(30,255,142,0.12), 0 18px 35px rgba(0,0,0,0.3);
        margin-bottom: 16px;
        min-height: 80px;
    }
    .controls {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        justify-content: center;
        margin-bottom: 16px;
    }
    button.action {
        min-width: 110px;
        padding: 12px 16px;
        font-size: 14px;
        border-radius: 10px;
        border: 1px solid #124228;
        background: linear-gradient(135deg, #0c120e, #1f3527);
        color: #eaffef;
        cursor: pointer;
        transition: all 0.18s ease;
        letter-spacing: 0.5px;
        text-transform: uppercase;
    }
    button.action:hover:not(:disabled) {
        transform: translateY(-1px);
        box-shadow: 0 0 12px rgba(30,255,142,0.28);
    }
    button.action:active:not(:disabled) { transform: translateY(0); }
    button.action:disabled {
        opacity: 0.45;
        cursor: not-allowed;
    }
    .laps {
        background: rgba(15,30,21,0.4);
        border: 1px solid #173824;
        border-radius: 12px;
        padding: 12px 14px;
        max-height: 220px;
        overflow: auto;
    }
    .lap-header {
        font-weight: bold;
        margin-bottom: 8px;
        letter-spacing: 1px;
        color: #b5ffd6;
    }
    ol#lap-list {
        margin: 0;
        padding-left: 20px;
        color: #dfffe9;
    }
    #lap-list li {
        margin: 6px 0;
        background: rgba(0,0,0,0.25);
        padding: 6px 8px;
        border-radius: 8px;
        border: 1px solid rgba(30,255,142,0.15);
        font-size: 14px;
    }
    .input-row {
        display: flex;
        gap: 12px;
        justify-content: center;
        margin-bottom: 12px;
        flex-wrap: wrap;
    }
    .input-row label {
        display: flex;
        flex-direction: column;
        align-items: center;
        color: #b0f5c9;
        font-size: 12px;
        letter-spacing: 0.5px;
    }
    .input-row input {
        margin-top: 6px;
        padding: 10px;
        width: 90px;
        text-align: center;
        background: #0c130f;
        border: 1px solid #1d3f2a;
        border-radius: 10px;
        color: #dfffe9;
        font-size: 16px;
    }
    .alert {
        text-align: center;
        min-height: 22px;
        color: #ffbdbd;
        letter-spacing: 0.4px;
    }
    .flash {
        animation: flash 0.9s step-start infinite;
    }
    @keyframes flash {
        50% { color: #ff8f8f; text-shadow: 0 0 16px rgba(255,80,80,0.6); border-color: #ff8f8f; }
    }
    @media (max-width: 600px) {
        .display { font-size: 36px; }
        button.action { min-width: 90px; font-size: 12px; }
        .input-row input { width: 80px; }
    }
</style>
</head>
<body>
<div class="wrapper">
    <h1>Stopwatch &amp; Timer</h1>
    <div class="mode-toggle">
        <button class="mode-btn active" data-target="stopwatch-panel">Stopwatch</button>
        <button class="mode-btn" data-target="timer-panel">Timer</button>
    </div>

    <div id="stopwatch-panel" class="panel active">
        <div id="stopwatch-display" class="display">00:00:00.00</div>
        <div class="controls">
            <button id="sw-start" class="action">Start</button>
            <button id="sw-stop" class="action" disabled>Stop</button>
            <button id="sw-lap" class="action" disabled>Lap</button>
            <button id="sw-reset" class="action" disabled>Reset</button>
        </div>
        <div class="laps">
            <div class="lap-header">Lap Times</div>
            <ol id="lap-list"></ol>
        </div>
    </div>

    <div id="timer-panel" class="panel">
        <div class="input-row">
            <label>Hours
                <input type="number" id="timer-hours" min="0" max="99" value="0">
            </label>
            <label>Minutes
                <input type="number" id="timer-minutes" min="0" max="59" value="0">
            </label>
            <label>Seconds
                <input type="number" id="timer-seconds" min="0" max="59" value="0">
            </label>
        </div>
        <div id="timer-display" class="display">00:00:00.00</div>
        <div class="controls">
            <button id="timer-start" class="action">Start</button>
            <button id="timer-pause" class="action" disabled>Pause</button>
            <button id="timer-reset" class="action">Reset</button>
        </div>
        <div id="timer-alert" class="alert"></div>
    </div>
</div>

<script>
(function() {
    /* Helper formatting */
    function pad(num, size=2) {
        let s = String(num);
        while (s.length < size) s = "0" + s;
        return s;
    }
    function formatTime(ms) {
        ms = Math.max(0, ms);
        const hours = Math.floor(ms / 3600000);
        const minutes = Math.floor((ms % 3600000) / 60000);
        const seconds = Math.floor((ms % 60000) / 1000);
        const centiseconds = Math.floor((ms % 1000) / 10);
        return `${pad(hours)}:${pad(minutes)}:${pad(seconds)}.${pad(centiseconds)}`;
    }

    /* Mode toggle */
    const modeButtons = document.querySelectorAll('.mode-btn');
    modeButtons.forEach(btn => {
        btn.addEventListener('click', () => {
            modeButtons.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            const target = btn.dataset.target;
            document.querySelectorAll('.panel').forEach(p => {
                p.classList.toggle('active', p.id === target);
            });
        });
    });

    /* Stopwatch logic */
    const swDisplay = document.getElementById('stopwatch-display');
    const swStartBtn = document.getElementById('sw-start');
    const swStopBtn = document.getElementById('sw-stop');
    const swLapBtn = document.getElementById('sw-lap');
    const swResetBtn = document.getElementById('sw-reset');
    const lapList = document.getElementById('lap-list');

    let swRunning = false;
    let swStartStamp = 0;
    let swElapsed = 0;
    let lapTimes = [];

    function updateStopwatchButtons() {
        swStartBtn.disabled = swRunning;
        swStopBtn.disabled = !swRunning;
        swLapBtn.disabled = !swRunning;
        swResetBtn.disabled = swRunning || (swElapsed === 0 && lapTimes.length === 0);
    }

    function swUpdate(now) {
        if (!swRunning) return;
        swElapsed = now - swStartStamp;
        swDisplay.textContent = formatTime(swElapsed);
        requestAnimationFrame(swUpdate);
    }

    swStartBtn.addEventListener('click', () => {
        if (swRunning) return;
        swStartStamp = performance.now() - swElapsed;
        swRunning = true;
        updateStopwatchButtons();
        requestAnimationFrame(swUpdate);
    });

    swStopBtn.addEventListener('click', () => {
        swRunning = false;
        updateStopwatchButtons();
    });

    swResetBtn.addEventListener('click', () => {
        swRunning = false;
        swElapsed = 0;
        lapTimes = [];
        lapList.innerHTML = '';
        swDisplay.textContent = '00:00:00.00';
        updateStopwatchButtons();
    });

    swLapBtn.addEventListener('click', () => {
        if (!swRunning) return;
        lapTimes.push(swElapsed);
        const lapNum = lapTimes.length;
        const delta = lapNum === 1 ? swElapsed : swElapsed - lapTimes[lapNum - 2];
        const li = document.createElement('li');
        li.textContent = `Lap ${lapNum}: ${formatTime(swElapsed)}  (Î” ${formatTime(delta)})`;
        lapList.prepend(li);
    });

    updateStopwatchButtons();

    /* Timer logic */
    const tHours = document.getElementById('timer-hours');
    const tMinutes = document.getElementById('timer-minutes');
    const tSeconds = document.getElementById('timer-seconds');
    const tDisplay = document.getElementById('timer-display');
    const tStart = document.getElementById('timer-start');
    const tPause = document.getElementById('timer-pause');
    const tReset = document.getElementById('timer-reset');
    const tAlert = document.getElementById('timer-alert');

    let timerRunning = false;
    let timerBaseRemaining = 0; // ms at last (re)start
    let timerStartStamp = 0;

    function readTimerInput() {
        const h = Math.max(0, parseInt(tHours.value, 10) || 0);
        const m = Math.max(0, parseInt(tMinutes.value, 10) || 0);
        const s = Math.max(0, parseInt(tSeconds.value, 10) || 0);
        return (h * 3600000) + (m * 60000) + (s * 1000);
    }

    function beep() {
        try {
            const ctx = new (window.AudioContext || window.webkitAudioContext)();
            const osc = ctx.createOscillator();
            const gain = ctx.createGain();
            osc.type = 'square';
            osc.frequency.value = 880;
            osc.connect(gain);
            gain.connect(ctx.destination);
            gain.gain.setValueAtTime(0.05, ctx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + 1.0);
            osc.start();
            osc.stop(ctx.currentTime + 1.0);
        } catch (e) {
            // Fallback alert if audio fails
            alert('Time is up!');
        }
    }

    function showTimerAlert(msg) {
        tAlert.textContent = msg || '';
    }

    function setTimerButtons() {
        tPause.disabled = timerBaseRemaining <= 0;
        tPause.textContent = timerRunning ? 'Pause' : 'Resume';
        tStart.disabled = timerRunning;
    }

    function timerUpdate(now) {
        if (!timerRunning) return;
        const elapsed = (now || performance.now()) - timerStartStamp;
        const remaining = timerBaseRemaining - elapsed;

        if (remaining <= 0) {
            timerRunning = false;
            timerBaseRemaining = 0;
            tDisplay.textContent = '00:00:00.00';
            tDisplay.classList.add('flash');
            showTimerAlert('Time is up!');
            beep();
            setTimerButtons();
            return;
        }
        tDisplay.textContent = formatTime(remaining);
        requestAnimationFrame(timerUpdate);
    }

    tStart.addEventListener('click', () => {
        const total = readTimerInput();
        tDisplay.classList.remove('flash');
        showTimerAlert('');
        if (total <= 0) {
            showTimerAlert('Enter a time greater than 0.');
            tDisplay.textContent = '00:00:00.00';
            timerBaseRemaining = 0;
            setTimerButtons();
            return;
        }
        timerBaseRemaining = total;
        timerStartStamp = performance.now();
        timerRunning = true;
        setTimerButtons();
        requestAnimationFrame(timerUpdate);
    });

    tPause.addEventListener('click', () => {
        if (timerBaseRemaining <= 0) return;
        const now = performance.now();
        if (timerRunning) {
            const remaining = timerBaseRemaining - (now - timerStartStamp);
            timerBaseRemaining = Math.max(0, remaining);
            timerRunning = false;
        } else {
            timerStartStamp = performance.now();
            timerRunning = true;
            requestAnimationFrame(timerUpdate);
        }
        setTimerButtons();
    });

    tReset.addEventListener('click', () => {
        timerRunning = false;
        timerBaseRemaining = 0;
        tDisplay.textContent = '00:00:00.00';
        tDisplay.classList.remove('flash');
        showTimerAlert('');
        setTimerButtons();
    });

    [tHours, tMinutes, tSeconds].forEach(input => {
        input.addEventListener('input', () => {
            if (!timerRunning) {
                const total = readTimerInput();
                tDisplay.textContent = formatTime(total);
                timerBaseRemaining = total;
                setTimerButtons();
            }
        });
    });

    setTimerButtons();
})();
</script>
</body>
</html>