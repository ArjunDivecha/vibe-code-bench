<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown Editor</title>
    <style>
        /* Global Styles */
        body {
            font-family: monospace;
            background-color: #f0f0f0;
            padding: 20px;
        }
        
        /* Dark Mode Styles */
        .dark-mode {
            background-color: #2f2f2f;
            color: #fff;
        }
        
        /* Editor Styles */
        .editor {
            display: flex;
            background-color: #fff;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        .editor-left {
            width: 50%;
            padding: 10px;
            border-right: 1px solid #ddd;
        }
        
        .editor-right {
            width: 50%;
            padding: 10px;
        }
        
        /* Preview Styles */
        .preview {
            padding: 10px;
        }
        
        /* Button Styles */
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            background-color: #4CAF50;
            color: #fff;
            cursor: pointer;
        }
        
        button:hover {
            background-color: #3e8e41;
        }
    </style>
</head>
<body>
    <div class="editor">
        <div class="editor-left">
            <textarea id="markdown-input" rows="10" cols="50"></textarea>
        </div>
        <div class="editor-right">
            <div id="preview"></div>
        </div>
    </div>
    <button id="save-button">Save to localStorage</button>
    <button id="load-button">Load from localStorage</button>
    <button id="export-button">Export as HTML</button>
    <button id="toggle-button">Toggle Dark Mode</button>
    
    <script>
        // Get elements
        const markdownInput = document.getElementById('markdown-input');
        const preview = document.getElementById('preview');
        const saveButton = document.getElementById('save-button');
        const loadButton = document.getElementById('load-button');
        const exportButton = document.getElementById('export-button');
        const toggleButton = document.getElementById('toggle-button');
        
        // Initialize dark mode
        const darkMode = localStorage.getItem('dark-mode') === 'true';
        document.body.classList.toggle('dark-mode', darkMode);
        
        // Save to localStorage
        saveButton.addEventListener('click', () => {
            localStorage.setItem('markdown', markdownInput.value);
        });
        
        // Load from localStorage
        loadButton.addEventListener('click', () => {
            const markdown = localStorage.getItem('markdown');
            if (markdown) {
                markdownInput.value = markdown;
            }
        });
        
        // Export as HTML
        exportButton.addEventListener('click', () => {
            const html = markdownToHtml(markdownInput.value);
            const a = document.createElement('a');
            a.href = URL.createObjectURL(new Blob([html], { type: 'text/html' }));
            a.download = 'markdown.html';
            a.click();
        });
        
        // Toggle dark mode
        toggleButton.addEventListener('click', () => {
            const darkMode = !darkMode;
            document.body.classList.toggle('dark-mode', darkMode);
            localStorage.setItem('dark-mode', darkMode);
        });
        
        // Live preview
        markdownInput.addEventListener('input', () => {
            const html = markdownToHtml(markdownInput.value);
            preview.innerHTML = html;
        });
        
        // Function to convert markdown to HTML
        function markdownToHtml(markdown) {
            // Simplified markdown parser
            const lines = markdown.split('\n');
            let html = '';
            let inList = false;
            let listType = '';
            for (const line of lines) {
                if (line.startsWith('#')) {
                    html += `<h${line.match(/^#+/)[0].length}">${line.slice(1)}</h${line.match(/^#+/)[0].length}>`;
                } else if (line.startsWith('**')) {
                    html += `<b>${line.slice(2, -2)}</b>`;
                } else if (line.startsWith('*')) {
                    html += `<i>${line.slice(1, -1)}</i>`;
                } else if (line.startsWith('-') || line.startsWith('1. ')) {
                    if (line.startsWith('-')) {
                        inList = true;
                        listType = 'unordered';
                    } else {
                        inList = true;
                        listType = 'ordered';
                    }
                    html += `<ul><li>${line.slice(line.startsWith('-') ? 2 : 3)}</li>`;
                } else if (line.startsWith('>')) {
                    html += `<blockquote>${line.slice(1)}</blockquote>`;
                } else if (line.startsWith('```')) {
                    html += `<pre><code>${line.slice(3)}</code></pre>`;
                } else {
                    html += `<p>${line}</p>`;
                }
                if (inList) {
                    if (line.startsWith('1. ') || line.startsWith('- ')) {
                        html += '</li>';
                    } else {
                        inList = false;
                        html += '</ul>';
                    }
                }
            }
            return html;
        }
    </script>
</body>
</html>