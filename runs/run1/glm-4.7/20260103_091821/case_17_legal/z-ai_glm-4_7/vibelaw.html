<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vibe-Law | Legal Case Search Workspace</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0d1117;
            --bg-secondary: #161b22;
            --bg-tertiary: #21262d;
            --bg-elevated: #30363d;
            --border-color: #30363d;
            --text-primary: #e6edf3;
            --text-secondary: #8b949e;
            --text-muted: #6e7681;
            --accent-blue: #58a6ff;
            --accent-blue-hover: #1f6feb;
            --accent-green: #3fb950;
            --accent-gold: #d29922;
            --accent-red: #f85149;
            --highlight-name: rgba(88, 166, 255, 0.3);
            --highlight-date: rgba(248, 81, 73, 0.3);
            --highlight-org: rgba(63, 185, 80, 0.3);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans', Helvetica, Arial, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
        }

        /* Header */
        .header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 12px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 60px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-blue-hover));
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 14px;
        }

        .search-container {
            flex: 1;
            max-width: 600px;
            margin: 0 24px;
        }

        .search-bar {
            width: 100%;
            display: flex;
            align-items: center;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 8px 12px;
            transition: border-color 0.2s;
        }

        .search-bar:focus-within {
            border-color: var(--accent-blue);
        }

        .search-bar input {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 14px;
            outline: none;
        }

        .search-bar input::placeholder {
            color: var(--text-muted);
        }

        .search-icon {
            color: var(--text-muted);
            margin-right: 8px;
        }

        .header-actions {
            display: flex;
            gap: 12px;
        }

        .btn {
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
        }

        .btn-primary {
            background: var(--accent-blue);
            color: white;
        }

        .btn-primary:hover {
            background: var(--accent-blue-hover);
        }

        .btn-secondary {
            background: var(--bg-elevated);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--bg-tertiary);
        }

        .btn-ghost {
            background: transparent;
            color: var(--text-secondary);
        }

        .btn-ghost:hover {
            color: var(--text-primary);
            background: var(--bg-elevated);
        }

        /* Main Layout */
        .main-container {
            display: flex;
            height: calc(100vh - 60px);
        }

        /* Results Panel */
        .results-panel {
            width: 400px;
            background: var(--bg-secondary);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .results-header {
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .results-count {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .results-list {
            flex: 1;
            overflow-y: auto;
            padding: 8px;
        }

        .case-card {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 14px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .case-card:hover {
            border-color: var(--accent-blue);
            background: var(--bg-elevated);
        }

        .case-card.active {
            border-color: var(--accent-blue);
            background: rgba(88, 166, 255, 0.1);
        }

        .case-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 6px;
            line-height: 1.4;
        }

        .case-meta {
            display: flex;
            gap: 12px;
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 8px;
        }

        .case-court {
            color: var(--accent-blue);
        }

        .case-snippet {
            font-size: 13px;
            color: var(--text-muted);
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Detail Panel */
        .detail-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: var(--bg-primary);
            overflow: hidden;
        }

        .detail-header {
            padding: 16px 24px;
            border-bottom: 1px solid var(--border-color);
            background: var(--bg-secondary);
        }

        .detail-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .detail-citation {
            font-size: 13px;
            color: var(--text-secondary);
            font-family: 'Courier New', monospace;
        }

        .detail-toolbar {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 24px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
        }

        .tabs {
            display: flex;
            gap: 4px;
        }

        .tab {
            padding: 8px 16px;
            font-size: 13px;
            color: var(--text-secondary);
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.2s;
        }

        .tab:hover {
            color: var(--text-primary);
        }

        .tab.active {
            color: var(--accent-blue);
            border-bottom-color: var(--accent-blue);
        }

        .toolbar-divider {
            width: 1px;
            height: 24px;
            background: var(--border-color);
            margin: 0 12px;
        }

        /* Detail Content */
        .detail-content {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        .content-main {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
        }

        .notes-sidebar {
            width: 320px;
            background: var(--bg-secondary);
            border-left: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .notes-header {
            padding: 16px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .notes-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .notes-list {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
        }

        .note-item {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 8px;
            position: relative;
        }

        .note-text {
            font-size: 13px;
            color: var(--text-primary);
            line-height: 1.5;
            margin-bottom: 8px;
        }

        .note-meta {
            font-size: 11px;
            color: var(--text-muted);
        }

        .note-delete {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 20px;
            height: 20px;
            border-radius: 4px;
            background: transparent;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .note-delete:hover {
            color: var(--accent-red);
            background: rgba(248, 81, 73, 0.1);
        }

        .add-note-form {
            padding: 12px;
            border-top: 1px solid var(--border-color);
        }

        .add-note-form textarea {
            width: 100%;
            min-height: 80px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 10px;
            color: var(--text-primary);
            font-size: 13px;
            resize: vertical;
            outline: none;
            font-family: inherit;
        }

        .add-note-form textarea:focus {
            border-color: var(--accent-blue);
        }

        .add-note-form .btn-row {
            display: flex;
            justify-content: flex-end;
            margin-top: 8px;
        }

        /* Content Styles */
        .summary-section {
            margin-bottom: 24px;
        }

        .section-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
        }

        .summary-text {
            font-size: 14px;
            line-height: 1.7;
            color: var(--text-secondary);
        }

        .full-text {
            font-size: 14px;
            line-height: 1.8;
            color: var(--text-primary);
            max-width: 800px;
        }

        .full-text p {
            margin-bottom: 16px;
        }

        .full-text h3 {
            font-size: 16px;
            margin: 24px 0 12px;
            color: var(--text-primary);
        }

        /* Entity Highlights */
        .entity-name {
            background: var(--highlight-name);
            color: var(--accent-blue);
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 500;
        }

        .entity-date {
            background: var(--highlight-date);
            color: var(--accent-red);
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 500;
        }

        .entity-org {
            background: var(--highlight-org);
            color: var(--accent-green);
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: 500;
        }

        /* Empty State */
        .empty-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: var(--text-muted);
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .empty-state-text {
            font-size: 14px;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--bg-elevated);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--border-color);
        }

        /* Legend */
        .legend {
            display: flex;
            gap: 16px;
            padding: 8px 12px;
            background: var(--bg-tertiary);
            border-radius: 6px;
            font-size: 12px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }

        .legend-color.name { background: var(--highlight-name); }
        .legend-color.date { background: var(--highlight-date); }
        .legend-color.org { background: var(--highlight-org); }

        /* Selection for notes */
        ::selection {
            background: rgba(88, 166, 255, 0.3);
        }

        .highlight-selection {
            background: rgba(88, 166, 255, 0.4);
        }

        /* Hidden class */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="logo">
            <div class="logo-icon">VL</div>
            Vibe-Law
        </div>
        <div class="search-container">
            <div class="search-bar">
                <span class="search-icon">üîç</span>
                <input type="text" id="searchInput" placeholder="Search case law by title, court, or keywords...">
            </div>
        </div>
        <div class="header-actions">
            <button class="btn btn-ghost">‚öôÔ∏è</button>
            <button class="btn btn-secondary">Export</button>
        </div>
    </div>

    <div class="main-container">
        <div class="results-panel">
            <div class="results-header">
                <span class="results-count" id="resultsCount">15 cases found</span>
            </div>
            <div class="results-list" id="resultsList">
                <!-- Cases will be rendered here -->
            </div>
        </div>

        <div class="detail-panel" id="detailPanel">
            <div class="empty-state" id="emptyState">
                <div class="empty-state-icon">‚öñÔ∏è</div>
                <div class="empty-state-text">Select a case to view details</div>
            </div>
            
            <div class="detail-content hidden" id="detailContent">
                <div class="content-main">
                    <div class="detail-header">
                        <h1 class="detail-title" id="detailTitle">Case Title</h1>
                        <div class="detail-citation" id="detailCitation">Citation</div>
                    </div>
                    
                    <div class="detail-toolbar">
                        <div class="tabs">
                            <div class="tab active" data-tab="summary">Summary</div>
                            <div class="tab" data-tab="fulltext">Full Text</div>
                        </div>
                        <div class="toolbar-divider"></div>
                        <button class="btn btn-secondary" id="extractBtn">‚ú® Extract Entities</button>
                        <button class="btn btn-secondary" id="addSelectionBtn">üìù Save Selection</button>
                        <div class="toolbar-divider"></div>
                        <div class="legend hidden" id="entityLegend">
                            <div class="legend-item">
                                <div class="legend-color name"></div>
                                <span>Names</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color date"></div>
                                <span>Dates</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color org"></div>
                                <span>Organizations</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="content-main" id="tabContent">
                        <!-- Tab content will be rendered here -->
                    </div>
                </div>
                
                <div class="notes-sidebar">
                    <div class="notes-header">
                        <span class="notes-title">üìå Notes & Annotations</span>
                        <span class="results-count" id="notesCount">0 notes</span>
                    </div>
                    <div class="notes-list" id="notesList">
                        <!-- Notes will be rendered here -->
                    </div>
                    <div class="add-note-form">
                        <textarea id="noteInput" placeholder="Add a note or paste selected text..."></textarea>
                        <div class="btn-row">
                            <button class="btn btn-primary" id="addNoteBtn">Add Note</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Mock Legal Cases Data
        const cases = [
            {
                id: 1,
                title: "Miranda v. Arizona",
                court: "Supreme Court of the United States",
                date: "June 13, 1966",
                citation: "384 U.S. 436",
                snippet: "The Supreme Court held that the Fifth Amendment's protection against self-incrimination requires law enforcement officials to advise a suspect of their rights before interrogation begins.",
                summary: {
                    holding: "The Court held that the Fifth Amendment's protection against self-incrimination requires law enforcement officials to advise a suspect of their rights before interrogation begins. These rights include the right to remain silent and the right to an attorney.",
                    facts: "Ernesto Miranda was arrested in Phoenix and taken to police station where he was identified by the victim. After two hours of interrogation, he signed a written confession.",
                    issue: "Does the police practice of interrogating individuals without notifying them of their right to counsel and their protection against self-incrimination violate the Fifth Amendment?"
                },
                fullText: `<h3>OPINION OF THE COURT</h3>
                    <p>The cases before us raise questions which go to the roots of our concepts of American criminal jurisprudence: the restraints society must observe consistent with the Federal Constitution in prosecuting individuals for crime. More specifically, we deal with the admissibility of statements obtained from an individual who is subjected to custodial police interrogation and the necessity for procedures which assure that the individual is accorded his privilege under the Fifth Amendment to the Constitution not to be compelled to incriminate himself.</p>
                    <p>We dealt with certain phases of this problem recently in Escobedo v. Illinois, 378 U.S. 478 (1964). In Escobedo, the Court held that statements obtained from defendant while he was under police interrogation were inadmissible because he had been denied his request for the assistance of counsel. The holding in Escobedo was predicated upon the Court's recognition of the right to counsel as having application to the period of police interrogation.</p>
                    <p>It is with this background that we must consider whether the prosecution may use statements obtained from a defendant questioned while in custody, without the warnings or effective waiver of the rights to remain silent and to have counsel present.</p>
                    <h3>MR. CHIEF JUSTICE WARREN delivered the opinion of the Court.</h3>
                    <p>The person in custody must, prior to interrogation, be clearly informed that he has the right to remain silent, and that anything he says will be used against him in a court of law; he must be clearly informed that he has the right to consult with a lawyer and to have the lawyer with him during interrogation, and that, if he is indigent, a lawyer will be appointed to represent him.</p>
                    <p>If the individual indicates in any manner, at any time prior to or during questioning, that he wishes to remain silent, the interrogation must cease. If the individual states that he wants an attorney, the interrogation must cease until an attorney is present.</p>`
            },
            {
                id: 2,
                title: "Brown v. Board of Education",
                court: "Supreme Court of the United States",
                date: "May 17, 1954",
                citation: "347 U.S. 483",
                snippet: "The Court declared that state laws establishing separate public schools for black and white students were unconstitutional, overturning Plessy v. Ferguson.",
                summary: {
                    holding: "The Court held that segregation of children in public schools solely on the basis of race deprives children of the minority group of equal educational opportunities, even though physical facilities and other tangible factors may be equal.",
                    facts: "Multiple cases from Kansas, South Carolina, Virginia, and Delaware were consolidated. African American minors sought admission to public schools that required or permitted segregation based on race.",
                    issue: "Does segregation of children in public schools solely on the basis of race violate the Equal Protection Clause of the Fourteenth Amendment?"
                },
                fullText: `<h3>OPINION OF THE COURT</h3>
                    <p>These cases come to us from the States of Kansas, South Carolina, Virginia, and Delaware. They are premised on different facts and different local conditions, but a common legal question justifies their consideration together in this consolidated opinion.</p>
                    <p>In each of the cases, minors of the Negro race, through their legal representatives, seek the aid of the courts in obtaining admission to the public schools of their community on a nonsegregated basis. In each instance, they had been denied admission to schools attended by white children under laws requiring or permitting segregation according to race.</p>
                    <h3>MR. CHIEF JUSTICE WARREN delivered the opinion of the Court.</h3>
                    <p>Today, education is perhaps the most important function of state and local governments. Compulsory school attendance laws and the great expenditures for education both demonstrate our recognition of the importance of education to our democratic society. It is required in the performance of our most basic public responsibilities, even service in the armed forces. It is the very foundation of good citizenship. Today it is a principal instrument in awakening the child to cultural values, in preparing him for later professional training, and in helping him to adjust normally to his environment. In these days, it is doubtful that any child may reasonably be expected to succeed in life if he is denied the opportunity of an education. Such an opportunity, where the state has undertaken to provide it, is a right which must be made available to all on equal terms.</p>
                    <p>We conclude that in the field of public education the doctrine of "separate but equal" has no place. Separate educational facilities are inherently unequal.</p>`
            },
            {
                id: 3,
                title: "Marbury v. Madison",
                court: "Supreme Court of the United States",
                date: "February 24, 1803",
                citation: "5 U.S. 137",
                snippet: "This case established the principle of judicial review, giving the Supreme Court the power to declare laws unconstitutional.",
                summary: {
                    holding: "The Court established the principle of judicial review, holding that it is the duty of the judiciary to say what the law is, and that courts have the authority to declare acts of Congress unconstitutional.",
                    facts: "William Marbury had been appointed Justice of the Peace by President Adams but his commission was not delivered before Jefferson took office. Madison, as Secretary of State, refused to deliver the commission.",
                    issue: "Does Marbury have a right to his commission, and if so, does the law provide a remedy? If the law provides a remedy, is it a mandamus issuing from the Supreme Court?"
                },
                fullText: `<h3>OPINION OF THE COURT</h3>
                    <p>The peculiar circumstances of this case require that it should be decided here. The plaintiff has a right to the commission; the refusal to deliver it is a plain violation of that right, for which the laws of his country afford him a remedy.</p>
                    <p>It is emphatically the province and duty of the judicial department to say what the law is. Those who apply the rule to particular cases, must of necessity expound and interpret that rule. If two laws conflict with each other, the courts must decide on the operation of each.</p>
                    <h3>MR. CHIEF JUSTICE MARSHALL delivered the opinion of the Court.</h3>
                    <p>So if a law be in opposition to the constitution; if both the law and the constitution apply to a particular case, so that the court must either decide that case conformably to the law, disregarding the constitution; or conformably to the constitution, disregarding the law; the court must determine which of these conflicting rules governs the case. This is of the very essence of judicial duty.</p>
                    <p>If, then, the courts are to regard the constitution, and the constitution is superior to any ordinary act of the legislature, the constitution, and not such ordinary act, must govern the case to which they both apply.</p>
                    <p>Those, then, who controvert the principle that the constitution is to be considered, in court, as a paramount law, are reduced to the necessity of maintaining that courts must close their eyes on the constitution, and see only the law.</p>
                    <p>This doctrine would subvert the very foundation of all written constitutions. It would declare that an act which, according to the principles and theory of our government, is entirely void, is yet, in practice, completely obligatory.</p>`
            },
            {
                id: 4,
                title: "Gideon v. Wainwright",
                court: "Supreme Court of the United States",
                date: "March 18, 1963",
                citation: "372 U.S. 335",
                snippet: "The Court held that the Sixth Amendment's guarantee of counsel is a fundamental right essential to a fair trial, applicable to the states through the Fourteenth Amendment.",
                summary: {
                    holding: "The Court held that the Sixth Amendment's guarantee of counsel is a fundamental right essential to a fair trial, applicable to the states through the Fourteenth Amendment's Due Process Clause.",
                    facts: "Clarence Earl Gideon was charged with breaking and entering. He requested an attorney but was denied because Florida only provided counsel in capital cases. He represented himself and was convicted.",
                    issue: "Does the Sixth Amendment's right to counsel in criminal cases apply to state proceedings through the Fourteenth Amendment's Due Process Clause?"
                },
                fullText: `<h3>OPINION OF THE COURT</h3>
                    <p>Clarence Earl Gideon was charged in a Florida State Court with having broken and entered a poolroom with intent to commit a misdemeanor. This offense is a felony under Florida law. Appearing in court without funds and without a lawyer, Gideon asked the Florida trial judge to appoint counsel for him, whereupon the following colloquy took place:</p>
                    <p>The COURT: Mr. Gideon, I am sorry, but I cannot appoint Counsel to represent you in this case. Under the laws of the State of Florida, the only time the Court can appoint Counsel to represent a Defendant is when that person is charged with a capital offense. I am sorry, but I will have to deny your request to appoint Counsel to defend you in this case.</p>
                    <h3>MR. JUSTICE BLACK delivered the opinion of the Court.</h3>
                    <p>In our adversary system of criminal justice, any person haled into court, who is too poor to hire a lawyer, cannot be assured a fair trial unless counsel is provided for him. This seems to us to be an obvious truth. Governments, both state and federal, quite properly spend vast sums of money to establish machinery to try defendants accused of crime. Lawyers to prosecute are everywhere deemed essential to protect the public's interest in an orderly society.</p>
                    <p>The right of one charged with crime to counsel may not be deemed fundamental and essential to fair trials in some countries, but it is in ours. From the very beginning, our state and national constitutions and laws have laid great emphasis on procedural and substantive safeguards designed to assure fair trials before impartial tribunals in which every defendant stands equal before the law.</p>`
            },
            {
                id: 5,
                title: "Roe v. Wade",
                court: "Supreme Court of the United States",
                date: "January 22, 1973",
                citation: "410 U.S. 113",
                snippet: "The Court ruled that the Constitution protects a pregnant woman's liberty to choose to have an abortion without excessive government restriction.",
                summary: {
                    holding: "The Court ruled that the Constitution protects a pregnant woman's liberty to choose to have an abortion without excessive government restriction, balancing this right against the state's interests in protecting women's health and prenatal life.",
                    facts: "Jane Roe, a pseudonym for Norma McCorvey, challenged Texas laws criminalizing abortion except to save the mother's life. She claimed the laws were unconstitutional.",
                    issue: "Does the Constitution recognize a woman's right to terminate her pregnancy by abortion?"
                },
                fullText: `<h3>OPINION OF THE COURT</h3>
                    <p>We forthwith acknowledge our awareness of the sensitive and emotional nature of the controversy of the subject of this case. Our task, of course, is to resolve the issue by constitutional measurement, free of emotion and of predilection.</p>
                    <h3>MR. JUSTICE BLACKMUN delivered the opinion of the Court.</h3>
                    <p>The Constitution does not explicitly mention any right of privacy. However, the Court has recognized that a right of personal privacy does exist under the Constitution. In varying contexts, the Court or individual Justices have found it in the First Amendment, the Fourth and Fifth Amendments, the penumbras of the Bill of Rights, or the concept of liberty guaranteed by the Due Process Clause of the Fourteenth Amendment.</p>
                    <p>This right of privacy, whether it be founded in the Fourteenth Amendment's concept of personal liberty and restrictions upon state action, as we feel it is, or in the Ninth Amendment's reservation of rights to the people, is broad enough to encompass a woman's decision whether or not to terminate her pregnancy.</p>
                    <p>The State does have an important and legitimate interest in preserving and protecting the health of the pregnant woman, and another important and legitimate interest in protecting the potentiality of human life. These interests are separate and distinct. Each grows in substantiality as the woman approaches term and, at a point during pregnancy, each becomes "compelling."</p>`
            },
            {
                id: 6,
                title: "United States v. Nixon",
                court: "Supreme Court of the United States",
                date: "July 24, 1974",
                citation: "418 U.S. 683",
                snippet: "The Court unanimously ruled that President Nixon must turn over the Watergate tapes, rejecting his claim of absolute executive privilege.",
                summary: {
                    holding: "The Court unanimously ruled that executive privilege is not absolute and that the President must comply with a subpoena for tapes and documents, rejecting Nixon's claim of absolute executive privilege.",
                    facts: "The Special Prosecutor subpoenaed tape recordings of conversations between President Nixon and his advisers. Nixon claimed executive privilege and refused to turn them over.",
                    issue: "Is the President's right to safeguard certain information, using his "executive privilege" confidentiality power, entirely immune from judicial review?"
                },
                fullText: `<h3>PER CURIAM OPINION</h3>
                    <p>The judgment of the Court of Appeals is affirmed. The case is remanded to the District Court for further proceedings consistent with this opinion.</p>
                    <h3>MR. CHIEF JUSTICE BURGER delivered the opinion of the Court.</h3>
                    <p>In the performance of assigned constitutional duties each branch of the Government must initially interpret the Constitution, and the interpretation of its powers by any branch is due great respect from the others. The President's counsel, as we have noted, reads the Constitution as providing an absolute privilege of confidentiality for all Presidential communications. Many decisions of this Court, however, have unequivocally reaffirmed the holding of Marbury v. Madison that "[i]t is emphatically the province and duty of the judicial department to say what the law is."</p>
                    <p>The question whether executive privilege exists is a constitutional matter, and the Court has a responsibility to interpret the Constitution. The President's claim of absolute privilege cannot be sustained.</p>
                    <p>However, neither the doctrine of separation of powers, nor the need for confidentiality of high-level communications, without more, can sustain an absolute, unqualified Presidential privilege of immunity from judicial process under all circumstances.</p>
                    <p>The President's need for complete candor and objectivity from advisors calls for great deference from the courts. However, when the privilege depends solely on the broad, undifferentiated claim of public interest in the confidentiality of such conversations, a confrontation with other values arises.</p>`
            },
            {
                id: 7,
                title: "Citizens United v. FEC",
                court: "Supreme Court of the United States",
                date: "January 21, 2010",
                citation: "558 U.S. 310",
                snippet: "The Court held that the free speech clause of the First Amendment prohibits the government from restricting independent expenditures for political communications by corporations.",
                summary: {
                    holding: "The Court held that the free speech clause of the First Amendment prohibits the government from restricting independent political expenditures by corporations, including nonprofit organizations, labor unions, and other associations.",
                    facts: "Citizens United, a conservative nonprofit, sought to air a film critical of Hillary Clinton close to the 2008 election. The FEC blocked it under the Bipartisan Campaign Reform Act.",
                    issue: "Can the government prohibit corporations and unions from using their general treasury funds to make independent expenditures for speech defined as an "electioneering communication"?"
                },
                fullText: `<h3>OPINION OF THE COURT</h3>
                    <p>The Government may regulate corporate political speech through disclaimer and disclosure requirements, but it may not suppress that speech altogether.</p>
                    <h3>MR. JUSTICE KENNEDY delivered the opinion of the Court.</h3>
                    <p>The Court has recognized that First Amendment protection extends to corporations. In First National Bank of Boston v. Bellotti, the Court invalidated a law prohibiting corporations from spending money to influence referenda on issues other than the corporation's business interests.</p>
                    <p>If the First Amendment has any force, it prohibits Congress from fining or jailing citizens, or associations of citizens, for simply engaging in political speech. The Government may regulate corporate political speech through disclaimer and disclosure requirements, but it may not suppress that speech altogether.</p>
                    <p>The Court has recognized that the First Amendment applies to corporations and unions. The Austin decision, which allowed restrictions on corporate independent expenditures, cannot be reconciled with the Court's earlier precedents.</p>
                    <p>Speech is an essential mechanism of democracy, because it is the means to hold officials accountable to the people. The right of citizens to inquire, to hear, to speak, and to use information to reach consensus is a precondition to enlightened self-government and a necessary means to protect it.</p>`
            },
            {
                id: 8,
                title: "Obergefell v. Hodges",
                court: "Supreme Court of the United States",
                date: "June 26, 2015",
                citation: "576 U.S. 644",
                snippet: "The Court ruled that the fundamental right to marry is guaranteed to same-sex couples under the Due Process and Equal Protection Clauses of the Fourteenth Amendment.",
                summary: {
                    holding: "The Court held that the fundamental right to marry is guaranteed to same-sex couples under the Due Process and Equal Protection Clauses of the Fourteenth Amendment.",
                    facts: "Multiple same-sex couples challenged state bans on same-sex marriage and refusal to recognize same-sex marriages performed in other states.",
                    issue: "Does the Fourteenth Amendment require a state to license a marriage between two people of the same sex?"
                },
                fullText: `<h3>OPINION OF THE COURT</h3>
                    <p>The Constitution promises liberty to all within its reach, a liberty that includes certain specific rights that allow persons, within a lawful realm, to define and express their identity.</p>
                    <h3>MR. JUSTICE KENNEDY delivered the opinion of the Court.</h3>
                    <p>The petitioners in these cases seek to find that liberty by marrying someone of the same sex and having their marriages deemed lawful on the same terms and conditions as marriages between persons of the opposite sex.</p>
                    <p>The right to personal choice regarding marriage is inherent in the concept of individual autonomy. Choices about marriage shape an individual's destiny. As the Supreme Judicial Court of Massachusetts has explained, because "it fulfills yearnings for security, safe haven, and connection that express our common humanity, civil marriage is an esteemed institution, and the decision whether and whom to marry is among life's momentous acts of self-definition."</p>
                    <p>There is dignity in the bond between two men or two women who seek to marry and in their autonomy to make such profound choices. The Constitution grants them that right. The judgment of the Court of Appeals for the Sixth Circuit is reversed.</p>
                    <p>No union is more profound than marriage, for it embodies the highest ideals of love, fidelity, devotion, sacrifice, and family. In forming a marital union, two people become something greater than once they were. As some of the petitioners in these cases demonstrate, marriage embodies a love that may endure even past death.</p>`
            },
            {
                id: 9,
                title: "New York Times Co. v. Sullivan",
                court: "Supreme Court of the United States",
                date: "March 9, 1964",
                citation: "376 U.S. 254",
                snippet: "The Court established the "actual malice" standard for defamation claims by public officials, requiring proof of knowledge of falsity or reckless disregard for the truth.",
                summary: {
                    holding: "The Court held that the First Amendment protects the publication of all statements about public officials except those made with actual malice‚Äîknowledge of falsity or reckless disregard for the truth.",
                    facts: "The New York Times published an advertisement describing police action against civil rights protesters. L.B. Sullivan, a Montgomery commissioner, sued for defamation, claiming the ad contained false statements.",
                    issue: "Does Alabama's libel law, by requiring public officials to prove "actual malice" in order to recover damages for libel, violate the First Amendment?"
                },
                fullText: `<h3>OPINION OF THE COURT</h3>
                    <p>We hold that Alabama's libel law, as applied to this case, violates the First and Fourteenth Amendments.</p>
                    <h3>MR. JUSTICE BRENNAN delivered the opinion of the Court.</h3>
                    <p>The constitutional guarantees require, we think, a federal rule that prohibits a public official from recovering damages for a defamatory falsehood whose substance makes no such allegation unless he proves "actual malice"‚Äîthat the statement was made with knowledge of its falsity or with reckless disregard of whether it was true or false.</p>
                    <p>The present advertisement, as an expression of grievance and protest on one of the major public issues of our time, would seem clearly to qualify for the constitutional protection. The question is whether it forfeits that protection by the falsity of some of its factual statements and by its alleged defamation of respondent.</p>
                    <p>A rule compelling the critic of official conduct to guarantee the truth of all his factual assertions‚Äîand to do so on pain of libel judgments virtually unlimited in amount‚Äîleads to a comparable "self-censorship." Allowance of the defense of truth, with the burden of proving it on the defendant, does not mean that false but innocent misstatements of fact will be invariably protected.</p>
                    <p>The First Amendment, said Judge Learned Hand, "presupposes that right conclusions are more likely to be gathered out of a multitude of tongues, than through any kind of authoritative selection. To many this is, and always will be, folly; but we have staked upon it our all."</p>`
            },
            {
                id: 10,
                title: "Terry v. Ohio",
                court: "Supreme Court of the United States",
                date: "June 10, 1968",
                citation: "392 U.S. 1",
                snippet: "The Court held that police may stop and frisk a person if they have reasonable suspicion that criminal activity is afoot, even if probable cause for arrest is lacking.",
                summary: {
                    holding: "The Court held that police may stop and briefly detain a person for investigative purposes based on reasonable suspicion, and may conduct a limited search for weapons if they have reasonable belief the person is armed and dangerous.",
                    facts: "Officer Martin McFadden observed two men acting suspiciously, pacing back and forth and looking into a store window. He approached them, identified himself as a police officer, and frisked them, finding weapons.",
                    issue: "Was the search and seizure of Terry and his companions unconstitutional under the Fourth Amendment?"
                },
                fullText: `<h3>OPINION OF THE COURT</h3>
                    <p>The judgment of the Supreme Court of Ohio is reversed, and the cause is remanded for further proceedings not inconsistent with this opinion.</p>
                    <h3>MR. CHIEF JUSTICE WARREN delivered the opinion of the Court.</h3>
                    <p>The issue in this case is not whether the search for weapons was reasonable as a matter of constitutional law, but whether the evidence obtained by the search was admissible at Terry's trial.</p>
                    <p>We merely hold today that where a police officer observes unusual conduct which leads him reasonably to conclude in light of his experience that criminal activity may be afoot and that the persons with whom he is dealing may be armed and presently dangerous, where in the course of investigating this behavior he identifies himself as a policeman and makes reasonable inquiries, and where nothing in the initial stages of the encounter serves to dispel his reasonable fear for his own or others' safety, he is entitled for the protection of himself and others in the area to conduct a carefully limited search of the outer clothing of such persons in an attempt to discover weapons which might be used to assault him.</p>
                    <p>Such a search is a reasonable search under the Fourth Amendment, and any weapons seized may properly be introduced in evidence against the person from whom they were taken.</p>`
            },
            {
                id: 11,
                title: "Mapp v. Ohio",
                court: "Supreme Court of the United States",
                date: "June 19, 1961",
                citation: "367 U.S. 643",
                snippet: "The Court extended the exclusionary rule to state courts, holding that evidence obtained in violation of the Fourth Amendment cannot be used in state criminal prosecutions.",
                summary: {
                    holding: "The Court held that all evidence obtained by searches and seizures in violation of the Constitution is, by that same authority, inadmissible in a state court.",
                    facts: "Police forcibly entered Dollree Mapp's home without a warrant, claiming they were searching for a bombing suspect. Instead, they found obscene materials and arrested her.",
                    issue: "Were the confiscated materials protected by the Fourth Amendment, and may they be used in a state criminal proceeding?"
                },
                fullText: `<h3>OPINION OF THE COURT</h3>
                    <p>All evidence obtained by searches and seizures in violation of the Constitution is, by that same authority, inadmissible in a state court.</p>
                    <h3>MR. JUSTICE CLARK delivered the opinion of the Court.</h3>
                    <p>The ignominious spectacle of officers of the law forcibly entering the home of a citizen without any warrant, and searching it at will, cannot be countenanced in a country which cherishes liberty and the rule of law.</p>
                    <p>The Fourth Amendment provides that "The right of the people to be secure in their persons, houses, papers, and effects, against unreasonable searches and seizures, shall not be violated, and no Warrants shall issue, but upon probable cause, supported by Oath or affirmation, and particularly describing the place to be searched, and the persons or things to be seized."</p>
                    <p>We hold that all evidence obtained by searches and seizures in violation of the Constitution is, by that same authority, inadmissible in a state court. This gives to the individual no more than that which the Constitution guarantees him, to the police officer no less than that to which honest law enforcement is entitled, and, to the courts, that judicial integrity so necessary in the true administration of justice.</p>`
            },
            {
                id: 12,
                title: "District of Columbia v. Heller",
                court: "Supreme Court of the United States",
                date: "June 26, 2008",
                citation: "554 U.S. 570",
                snippet: "The Court held that the Second Amendment protects an individual's right to possess a firearm for self-defense, unconnected with service in a militia.",
                summary: {
                    holding: "The Court held that the Second Amendment protects an individual's right to possess a firearm for traditionally lawful purposes, such as self-defense within the home.",
                    facts: "Dick Heller, a D.C. special police officer, challenged the district's handgun ban, which prohibited handgun possession by civilians and required lawful firearms to be kept unloaded and disassembled.",
                    issue: "Does the Second Amendment protect an individual's right to possess a firearm for self-defense, separate from service in a militia?"
                },
                fullText: `<h3>OPINION OF THE COURT</h3>
                    <p>We hold that the Second Amendment protects an individual right to possess a firearm unconnected with service in a militia, and to use that arm for traditionally lawful purposes, such as self-defense within the home.</p>
                    <h3>MR. JUSTICE SCALIA delivered the opinion of the Court.</h3>
                    <p>The Second Amendment provides: "A well regulated Militia, being necessary to the security of a free State, the right of the people to keep and bear Arms, shall not be infringed."</p>
                    <p>The Second Amendment's prefatory clause announces the purpose for the right: a well-regulated militia. The operative clause's text and history demonstrate that it connotes an individual right to keep and bear arms.</p>
                    <p>Before addressing the verbs "keep" and "bear," we interpret their object: "Arms." The term was applied, then as now, to weapons that were not specifically designed for military use and were not employed in a military capacity. We think that "arms" in the Second Amendment extends to all instruments that constitute bearable arms.</p>
                    <p>Putting all of these textual elements together, we find that they guarantee the individual right to possess and carry weapons in case of confrontation. This meaning is strongly confirmed by the historical background of the Second Amendment.</p>`
            },
            {
                id: 13,
                title: "Shaw v. Reno",
                court: "Supreme Court of the United States",
                date: "June 28, 1993",
                citation: "509 U.S. 630",
                snippet: "The Court held that redistricting based on race can violate the Equal Protection Clause, even if the district is not "bizarrely shaped."",
                summary: {
                    holding: "The Court held that redistricting based on race can violate the Equal Protection Clause when it creates districts that are extremely irregular in shape and cannot be explained except as an effort to segregate voters by race.",
                    facts: "North Carolina created a congressional district with a majority African American population that was described as resembling a "Rorschach ink-blot test." Five white voters challenged the district.",
                    issue: "Does North Carolina's redistricting plan violate the Equal Protection Clause?"
                },
                fullText: `<h3>OPINION OF THE COURT</h3>
                    <p>We conclude that North Carolina's reapportionment plan cannot withstand constitutional scrutiny under the Equal Protection Clause.</p>
                    <h3>MR. JUSTICE O'CONNOR delivered the opinion of the Court.</h3>
                    <p>Redistricting is one of the most political functions performed by government. However, the Equal Protection Clause empowers courts to review redistricting plans that appear to be motivated by racial considerations.</p>
                    <p>A reapportionment plan that includes in one district individuals who belong to the same race, but who are otherwise widely separated by geographical and political boundaries, and who may have little in common with one another but the color of their skin, bears an uncomfortable resemblance to political apartheid.</p>
                    <p>Racial gerrymandering, even for remedial purposes, may balkanize us into competing racial factions; it threatens to carry us further from the goal of a political system in which race no longer matters‚Äîa goal that the Fourteenth and Fifteenth Amendments embody, and toward which the Nation has striven.</p>`
            },
            {
                id: 14,
                title: "Bush v. Gore",
                court: "Supreme Court of the United States",
                date: "December 12, 2000",
                citation: "531 U.S. 98",
                snippet: "The Court ruled that the Florida Supreme Court's manual recount scheme violated the Equal Protection Clause, effectively ending the 2000 presidential election recount.",
                summary: {
                    holding: "The Court held that the Florida Supreme Court's scheme for recounting ballots violated the Equal Protection Clause because it lacked uniform standards for evaluating ballots.",
                    facts: "The 2000 presidential election hinged on Florida's 25 electoral votes. The Florida Supreme Court ordered manual recounts, but there were no uniform standards for determining voter intent.",
                    issue: "Did the Florida Supreme Court's recount scheme violate the Equal Protection Clause?"
                },
                fullText: `<h3>PER CURIAM OPINION</h3>
                    <p>The judgment of the Supreme Court of Florida is reversed, and the case is remanded for further proceedings not inconsistent with this opinion.</p>
                    <p>None are more conscious of the vital limits on judicial authority than are the Members of this Court, and none stand more in admiration of the Constitution's design to leave the selection of the President to the people, through their legislatures, and to the political sphere. When contending parties invoke the process of the courts, however, it becomes our unsought responsibility to resolve the federal and constitutional issues the judicial system has been forced to confront.</p>
                    <p>The recount process, as envisioned by the Florida Supreme Court, lacks the uniform standards necessary to ensure equal application of the law. The problem inheres in the absence of specific standards to ensure its equal application. The formulation of uniform rules to determine intent based on these recurring circumstances is practicable and, we believe, inevitable.</p>
                    <p>The State Supreme Court has ordered that the intent of the voter be discerned from ballots. But the record before us provides no standards for determining what the voter's intent was. The Florida Supreme Court has declined to elaborate on such standards.</p>`
            },
            {
                id: 15,
                title: "Dobbs v. Jackson Women's Health Organization",
                court: "Supreme Court of the United States",
                date: "June 24, 2022",
                citation: "597 U.S. ___",
                snippet: "The Court overturned Roe v. Wade and Planned Parenthood v. Casey, holding that the Constitution does not confer a right to abortion.",
                summary: {
                    holding: "The Court held that the Constitution does not confer a right to abortion, overturning Roe v. Wade and Planned Parenthood v. Casey. The authority to regulate abortion is returned to the people and their elected representatives.",
                    facts: "Jackson Women's Health Organization, Mississippi's only abortion clinic, challenged a state law banning most abortions after 15 weeks of pregnancy.",
                    issue: "Does the Constitution protect a right to abortion?"
                },
                fullText: `<h3>OPINION OF THE COURT</h3>
                    <p>The Constitution does not confer a right to abortion; Roe and Casey are overruled; and the authority to regulate abortion is returned to the people and their elected representatives.</p>
                    <h3>MR. JUSTICE ALITO delivered the opinion of the Court.</h3>
                    <p>Roe v. Wade held that the Constitution protects a woman's right to terminate her pregnancy, and that such a right may be found in the Due Process Clause of the Fourteenth Amendment. Casey reaffirmed Roe's core holding while modifying its trimester framework.</p>
                    <p>We conclude that Roe and Casey must be overruled. The Constitution makes no reference to abortion, and no such right is implicitly protected by any constitutional provision. Roe was egregiously wrong from the start. Its reasoning was exceptionally weak, and the decision has had damaging consequences.</p>
                    <p>It is time to heed the Constitution and return the issue of abortion to the people's elected representatives. The permissibility of abortion, and the limitations upon it, are to be resolved like most important questions in our democracy: by citizens trying to persuade one another and then voting.</p>
                    <p>The judgment of the Fifth Circuit is reversed, and the case is remanded for further proceedings consistent with this opinion.</p>`
            }
        ];

        // State Management
        let state = {
            selectedCase: null,
            currentTab: 'summary',
            entitiesExtracted: false,
            notes: {},
            searchQuery: ''
        };

        // Load notes from localStorage
        function loadNotes() {
            const saved = localStorage.getItem('vibelaw_notes');
            if (saved) {
                state.notes = JSON.parse(saved);
            }
        }

        // Save notes to localStorage
        function saveNotes() {
            localStorage.setItem('vibelaw_notes', JSON.stringify(state.notes));
        }

        // Render cases list
        function renderCasesList() {
            const resultsList = document.getElementById('resultsList');
            const resultsCount = document.getElementById('resultsCount');
            
            let filteredCases = cases;
            if (state.searchQuery) {
                const query = state.searchQuery.toLowerCase();
                filteredCases = cases.filter(c => 
                    c.title.toLowerCase().includes(query) ||
                    c.court.toLowerCase().includes(query) ||
                    c.snippet.toLowerCase().includes(query)
                );
            }
            
            resultsCount.textContent = `${filteredCases.length} case${filteredCases.length !== 1 ? 's' : ''} found`;
            
            resultsList.innerHTML = filteredCases.map(c => `
                <div class="case-card ${state.selectedCase?.id === c.id ? 'active' : ''}" data-id="${c.id}">
                    <div class="case-title">${c.title}</div>
                    <div class="case-meta">
                        <span class="case-court">${c.court}</span>
                        <span>‚Ä¢</span>
                        <span>${c.date}</span>
                    </div>
                    <div class="case-snippet">${c.snippet}</div>
                </div>
            `).join('');
            
            // Add click listeners
            document.querySelectorAll('.case-card').forEach(card => {
                card.addEventListener('click', () => {
                    const id = parseInt(card.dataset.id);
                    selectCase(id);
                });
            });
        }

        // Select a case
        function selectCase(id) {
            state.selectedCase = cases.find(c => c.id === id);
            state.currentTab = 'summary';
            state.entitiesExtracted = false;
            
            document.getElementById('emptyState').classList.add('hidden');
            document.getElementById('detailContent').classList.remove('hidden');
            document.getElementById('entityLegend').classList.add('hidden');
            
            renderCaseDetail();
            renderNotes();
            renderCasesList();
        }

        // Render case detail
        function renderCaseDetail() {
            if (!state.selectedCase) return;
            
            const c = state.selectedCase;
            document.getElementById('detailTitle').textContent = c.title;
            document.getElementById('detailCitation').textContent = `${c.citation} ‚Ä¢ ${c.court} ‚Ä¢ ${c.date}`;
            
            renderTabContent();
            updateTabs();
        }

        // Update tabs
        function updateTabs() {
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.tab === state.currentTab);
            });
        }

        // Render tab content
        function renderTabContent() {
            const content = document.getElementById('tabContent');
            const c = state.selectedCase;
            
            if (state.currentTab === 'summary') {
                content.innerHTML = `
                    <div class="summary-section">
                        <h3 class="section-title">Holding</h3>
                        <p class="summary-text">${c.summary.holding}</p>
                    </div>
                    <div class="summary-section">
                        <h3 class="section-title">Facts of the Case</h3>
                        <p class="summary-text">${c.summary.facts}</p>
                    </div>
                    <div class="summary-section">
                        <h3 class="section-title">Question Presented</h3>
                        <p class="summary-text">${c.summary.issue}</p>
                    </div>
                `;
            } else {
                let fullText = c.fullText;
                if (state.entitiesExtracted) {
                    fullText = highlightEntities(fullText);
                }
                content.innerHTML = `<div class="full-text" id="fullTextContent">${fullText}</div>`;
            }
        }

        // Highlight entities (simulated)
        function highlightEntities(text) {
            // Names (capitalized words that look like names)
            text = text.replace(/\b(Mr\.|MR\.|Justice|CHIEF|JUSTICE)\s+([A-Z][a-z]+(?:\s+[A-Z][a-z]+)?)\b/g, 
                '<span class="entity-name">$&</span>');
            
            // Dates (various formats)
            text = text.replace(/\b(January|February|March|April|May|June|July|August|September|October|November|December)\s+\d{1,2},?\s+\d{4}\b/g,
                '<span class="entity-date">$&</span>');
            text = text.replace(/\b\d{4}\b/g,
                '<span class="entity-date">$&</span>');
            
            // Organizations/Courts
            text = text.replace(/\b(Supreme Court|Court of Appeals|District Court|Congress|Senate|House of Representatives)\b/g,
                '<span class="entity-org">$&</span>');
            text = text.replace(/\b(United States|Florida|Texas|Ohio|Virginia|North Carolina|Mississippi|Alabama|Arizona|California)\b/g,
                '<span class="entity-org">$&</span>');
            
            return text;
        }

        // Render notes
        function renderNotes() {
            const notesList = document.getElementById('notesList');
            const notesCount = document.getElementById('notesCount');
            const caseNotes = state.notes[state.selectedCase?.id] || [];
            
            notesCount.textContent = `${caseNotes.length} note${caseNotes.length !== 1 ? 's' : ''}`;
            
            if (caseNotes.length === 0) {
                notesList.innerHTML = `
                    <div style="text-align: center; color: var(--text-muted); padding: 20px;">
                        <div style="font-size: 24px; margin-bottom: 8px;">üìù</div>
                        <div style="font-size: 12px;">No notes yet.<br>Select text and click "Save Selection"</div>
                    </div>
                `;
                return;
            }
            
            notesList.innerHTML = caseNotes.map((note, index) => `
                <div class="note-item">
                    <button class="note-delete" data-index="${index}">‚úï</button>
                    <div class="note-text">${note.text}</div>
                    <div class="note-meta">${note.date}</div>
                </div>
            `).join('');
            
            // Add delete listeners
            document.querySelectorAll('.note-delete').forEach(btn => {
                btn.addEventListener('click', () => {
                    const index = parseInt(btn.dataset.index);
                    deleteNote(index);
                });
            });
        }

        // Add note
        function addNote(text) {
            if (!state.selectedCase || !text.trim()) return;
            
            if (!state.notes[state.selectedCase.id]) {
                state.notes[state.selectedCase.id] = [];
            }
            
            state.notes[state.selectedCase.id].push({
                text: text.trim(),
                date: new Date().toLocaleString()
            });
            
            saveNotes();
            renderNotes();
            document.getElementById('noteInput').value = '';
        }

        // Delete note
        function deleteNote(index) {
            if (!state.selectedCase) return;
            
            state.notes[state.selectedCase.id].splice(index, 1);
            saveNotes();
            renderNotes();
        }

        // Event Listeners
        document.getElementById('searchInput').addEventListener('input', (e) => {
            state.searchQuery = e.target.value;
            renderCasesList();
        });

        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                state.currentTab = tab.dataset.tab;
                renderCaseDetail();
            });
        });

        document.getElementById('extractBtn').addEventListener('click', () => {
            state.entitiesExtracted = !state.entitiesExtracted;
            document.getElementById('entityLegend').classList.toggle('hidden', !state.entitiesExtracted);
            renderCaseDetail();
        });

        document.getElementById('addNoteBtn').addEventListener('click', () => {
            const input = document.getElementById('noteInput');
            addNote(input.value);
        });

        document.getElementById('addSelectionBtn').addEventListener('click', () => {
            const selection = window.getSelection().toString();
            if (selection) {
                addNote(selection);
            } else {
                document.getElementById('noteInput').focus();
            }
        });

        // Initialize
        loadNotes();
        renderCasesList();
    </script>
</body>
</html>