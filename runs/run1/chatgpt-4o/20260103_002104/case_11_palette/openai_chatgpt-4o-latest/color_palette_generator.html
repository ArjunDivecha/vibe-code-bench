<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Color Palette Generator</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', sans-serif;
      display: flex;
      flex-direction: column;
      height: 100vh;
      overflow: hidden;
    }

    .palette {
      display: flex;
      flex: 1;
      transition: all 0.5s ease;
    }

    .color-column {
      flex: 1;
      position: relative;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      transition: background-color 0.5s ease;
      cursor: pointer;
    }

    .color-info {
      background-color: rgba(255,255,255,0.7);
      padding: 10px;
      border-radius: 10px;
      text-align: center;
      transition: background-color 0.3s ease;
    }

    .color-info:hover {
      background-color: rgba(255,255,255,0.9);
    }

    .hex {
      font-weight: bold;
    }

    .rgb {
      font-size: 0.85em;
      color: #333;
    }

    .lock-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(255,255,255,0.7);
      border: none;
      border-radius: 5px;
      padding: 5px 10px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.3s ease;
    }

    .lock-btn.locked {
      background-color: rgba(255, 215, 0, 0.9);
    }

    .footer {
      background-color: #f0f0f0;
      padding: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .save-btn {
      padding: 6px 12px;
      font-size: 14px;
      cursor: pointer;
    }

    .favorites {
      max-height: 100px;
      overflow-x: auto;
      display: flex;
      gap: 5px;
    }

    .favorite-palette {
      display: flex;
      width: 100px;
      height: 30px;
      cursor: pointer;
      border: 1px solid #ccc;
    }

    .favorite-color {
      flex: 1;
    }

    .tooltip {
      position: absolute;
      bottom: 10px;
      background-color: #000;
      color: #fff;
      padding: 3px 6px;
      border-radius: 4px;
      font-size: 12px;
      display: none;
    }

    .show {
      display: block !important;
    }
  </style>
</head>
<body>
  <div class="palette" id="palette"></div>
  <div class="footer">
    <button class="save-btn" onclick="savePalette()">Save Palette</button>
    <div class="favorites" id="favorites"></div>
  </div>

  <script>
    const paletteEl = document.getElementById('palette');
    const favoritesEl = document.getElementById('favorites');
    const NUM_COLORS = 5;
    const lockStates = Array(NUM_COLORS).fill(false);
    let currentColors = [];

    function getRandomColor() {
      const r = Math.floor(Math.random() * 256);
      const g = Math.floor(Math.random() * 256);
      const b = Math.floor(Math.random() * 256);
      return { r, g, b };
    }

    function rgbToHex({r, g, b}) {
      return "#" + [r, g, b].map(x => x.toString(16).padStart(2, '0')).join('').toUpperCase();
    }

    function rgbString({r, g, b}) {
      return `rgb(${r}, ${g}, ${b})`;
    }

    function generatePalette() {
      currentColors = currentColors.map((color, idx) => {
        if (lockStates[idx]) return color;
        return getRandomColor();
      });

      renderPalette();
    }

    function renderPalette() {
      paletteEl.innerHTML = "";
      currentColors.forEach((color, idx) => {
        const hex = rgbToHex(color);
        const rgb = rgbString(color);

        const col = document.createElement('div');
        col.className = 'color-column';
        col.style.backgroundColor = hex;

        const info = document.createElement('div');
        info.className = 'color-info';
        info.innerHTML = `
          <div class="hex">${hex}</div>
          <div class="rgb">${rgb}</div>
        `;

        info.onclick = (e) => {
          e.stopPropagation();
          navigator.clipboard.writeText(hex);
          showTooltip(col, "Copied!");
        };

        const lockBtn = document.createElement('button');
        lockBtn.className = 'lock-btn' + (lockStates[idx] ? ' locked' : '');
        lockBtn.innerText = lockStates[idx] ? 'ðŸ”’' : 'ðŸ”“';
        lockBtn.onclick = (e) => {
          e.stopPropagation();
          lockStates[idx] = !lockStates[idx];
          renderPalette();
        };

        col.appendChild(lockBtn);
        col.appendChild(info);
        paletteEl.appendChild(col);
      });
    }

    function showTooltip(target, text) {
      let tooltip = target.querySelector('.tooltip');
      if (!tooltip) {
        tooltip = document.createElement('div');
        tooltip.className = 'tooltip';
        target.appendChild(tooltip);
      }
      tooltip.innerText = text;
      tooltip.classList.add('show');
      setTimeout(() => tooltip.classList.remove('show'), 1000);
    }

    function savePalette() {
      const palette = currentColors.map(rgbToHex);
      let saved = JSON.parse(localStorage.getItem('palettes') || '[]');
      saved.push(palette);
      localStorage.setItem('palettes', JSON.stringify(saved));
      renderFavorites();
    }

    function renderFavorites() {
      favoritesEl.innerHTML = "";
      let saved = JSON.parse(localStorage.getItem('palettes') || '[]');
      saved.forEach((palette, index) => {
        const paletteDiv = document.createElement('div');
        paletteDiv.className = 'favorite-palette';
        palette.forEach(color => {
          const colorDiv = document.createElement('div');
          colorDiv.className = 'favorite-color';
          colorDiv.style.backgroundColor = color;
          paletteDiv.appendChild(colorDiv);
        });
        paletteDiv.onclick = () => {
          currentColors = palette.map(hex => {
            return {
              r: parseInt(hex.slice(1,3), 16),
              g: parseInt(hex.slice(3,5), 16),
              b: parseInt(hex.slice(5,7), 16)
            };
          });
          lockStates.fill(false);
          renderPalette();
        };
        favoritesEl.appendChild(paletteDiv);
      });
    }

    function init() {
      currentColors = Array(NUM_COLORS).fill().map(getRandomColor);
      renderPalette();
      renderFavorites();
    }

    window.addEventListener('keydown', (e) => {
      if (e.code === 'Space') {
        e.preventDefault();
        generatePalette();
      }
    });

    init();
  </script>
</body>
</html>