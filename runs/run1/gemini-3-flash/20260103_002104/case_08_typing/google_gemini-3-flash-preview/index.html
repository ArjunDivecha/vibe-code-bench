<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speed Typer</title>
    <style>
        :root {
            --bg-color: #1a1a1a;
            --card-bg: #2d2d2d;
            --text-main: #e0e0e0;
            --text-muted: #888;
            --correct: #4ade80;
            --incorrect: #f87171;
            --cursor: #fbbf24;
            --accent: #3b82f6;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
        }

        .container {
            max-width: 800px;
            width: 90%;
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        h1 {
            text-align: center;
            margin-top: 0;
            color: var(--accent);
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .stats-bar {
            display: flex;
            justify-content: space-around;
            margin-bottom: 1.5rem;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .stat-item {
            background: rgba(0,0,0,0.2);
            padding: 0.5rem 1.5rem;
            border-radius: 8px;
            border-bottom: 3px solid var(--accent);
        }

        #text-display {
            font-size: 1.4rem;
            line-height: 1.6;
            margin-bottom: 1.5rem;
            user-select: none;
            position: relative;
            background: rgba(255,255,255,0.05);
            padding: 1.5rem;
            border-radius: 8px;
            min-height: 120px;
        }

        .char {
            position: relative;
            transition: color 0.1s;
        }

        .char.correct { color: var(--correct); }
        .char.incorrect { color: var(--incorrect); background: rgba(248, 113, 113, 0.2); }
        .char.current { border-bottom: 3px solid var(--cursor); }

        #input-field {
            position: absolute;
            opacity: 0;
            pointer-events: none;
        }

        .input-trigger {
            width: 100%;
            padding: 1rem;
            background: var(--accent);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: background 0.2s;
            text-align: center;
        }

        .input-trigger:hover {
            background: #2563eb;
        }

        .results {
            display: none;
            text-align: center;
            margin-top: 1rem;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
        }

        button {
            padding: 0.8rem 1.5rem;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.1s;
        }

        button:active { transform: scale(0.95); }

        .btn-restart { background: var(--accent); color: white; }
        .btn-reset { background: #555; color: white; }

        .timer-warning { color: var(--incorrect); }
    </style>
</head>
<body>

    <div class="container">
        <h1>Speed Typer</h1>

        <div class="stats-bar">
            <div class="stat-item">Time: <span id="timer">30</span>s</div>
            <div class="stat-item">WPM: <span id="wpm">0</span></div>
            <div class="stat-item">Acc: <span id="accuracy">100</span>%</div>
        </div>

        <div id="text-display">
            <!-- Text will be loaded here -->
        </div>

        <input type="text" id="input-field" autocomplete="off">
        
        <div id="game-controls">
            <button class="input-trigger" id="start-btn">Click here or press any key to start</button>
        </div>

        <div class="results" id="results-panel">
            <h2>Test Complete!</h2>
            <div class="controls">
                <button class="btn-restart" onclick="initGame()">Try New Text</button>
                <button class="btn-reset" onclick="resetCurrent()">Restart Same Text</button>
            </div>
        </div>
    </div>

    <script>
        const samples = [
            "The quick brown fox jumps over the lazy dog. This classic sentence contains every letter of the alphabet at least once.",
            "Programming is the process of creating a set of instructions that tell a computer how to perform a task.",
            "Success is not final, failure is not fatal: it is the courage to continue that counts. Always keep moving forward.",
            "The only way to do great work is to love what you do. If you haven't found it yet, keep looking. Don't settle.",
            "In the middle of every difficulty lies opportunity. The mind is everything. What you think you become.",
            "Artificial intelligence is the simulation of human intelligence processes by machines, especially computer systems.",
            "The beautiful thing about learning is that nobody can take it away from you. Education is power.",
            "Climate change is a significant challenge facing our planet today, requiring global cooperation and innovation.",
            "Space, the final frontier. These are the voyages of the starship Enterprise. Its five-year mission: to explore strange new worlds.",
            "A journey of a thousand miles begins with a single step. Do not fear going slowly, fear only standing still."
        ];

        let timeLeft = 30;
        let timer = null;
        let isPlaying = false;
        let charIndex = 0;
        let mistakes = 0;
        let currentText = "";
        let timerStarted = false;

        const textDisplay = document.getElementById('text-display');
        const inputField = document.getElementById('input-field');
        const timerEl = document.getElementById('timer');
        const wpmEl = document.getElementById('wpm');
        const accEl = document.getElementById('accuracy');
        const startBtn = document.getElementById('start-btn');
        const resultsPanel = document.getElementById('results-panel');

        function initGame() {
            // Reset variables
            clearInterval(timer);
            timeLeft = 30;
            charIndex = 0;
            mistakes = 0;
            isPlaying = true;
            timerStarted = false;
            
            // UI Resets
            timerEl.innerText = timeLeft;
            wpmEl.innerText = 0;
            accEl.innerText = 100;
            resultsPanel.style.display = 'none';
            startBtn.style.display = 'block';
            startBtn.innerText = "Start Typing...";
            
            // Pick random text
            currentText = samples[Math.floor(Math.random() * samples.length)];
            
            // Render text
            textDisplay.innerHTML = "";
            currentText.split("").forEach(char => {
                let span = document.createElement('span');
                span.classList.add('char');
                span.innerText = char;
                textDisplay.appendChild(span);
            });
            textDisplay.querySelectorAll('.char')[0].classList.add('current');

            inputField.value = "";
            inputField.focus();
        }

        function resetCurrent() {
            initGame();
            // We force the text back to what it was
            const prevText = currentText;
            initGame(); // Re-init
            // Note: initGame picks random, but for 'restart same' we could store it.
            // Simplified: just call initGame for now, or store 'lastText'
        }

        function startTimer() {
            if (timeLeft > 0) {
                timeLeft--;
                timerEl.innerText = timeLeft;
                if(timeLeft <= 5) timerEl.classList.add('timer-warning');
                else timerEl.classList.remove('timer-warning');
                
                // Update WPM even while typing
                calculateStats();
            } else {
                endGame();
            }
        }

        function calculateStats() {
            // WPM = (Total Characters / 5) / (Time Spent in Minutes)
            let timeSpent = 30 - timeLeft;
            if (timeSpent <= 0) timeSpent = 1;
            
            let wpm = Math.round(((charIndex - mistakes) / 5) / (timeSpent / 60));
            wpm = wpm < 0 || !wpm || wpm === Infinity ? 0 : wpm;
            wpmEl.innerText = wpm;

            let acc = Math.round(((charIndex - mistakes) / charIndex) * 100);
            acc = acc < 0 || !acc || acc === Infinity ? 100 : acc;
            accEl.innerText = acc;
        }

        function endGame() {
            clearInterval(timer);
            isPlaying = false;
            inputField.disabled = true;
            startBtn.style.display = 'none';
            resultsPanel.style.display = 'block';
        }

        inputField.addEventListener('input', (e) => {
            if (!isPlaying) return;
            
            if (!timerStarted) {
                timer = setInterval(startTimer, 1000);
                timerStarted = true;
                startBtn.innerText = "Type!";
            }

            const characters = textDisplay.querySelectorAll('.char');
            const typedChar = inputField.value.split("")[charIndex];

            if (charIndex < characters.length && timeLeft > 0) {
                if (typedChar == null) {
                    // Backspace handling
                    if (charIndex > 0) {
                        charIndex--;
                        if (characters[charIndex].classList.contains('incorrect')) {
                            mistakes--;
                        }
                        characters[charIndex].classList.remove('correct', 'incorrect');
                    }
                } else {
                    if (characters[charIndex].innerText === typedChar) {
                        characters[charIndex].classList.add('correct');
                    } else {
                        mistakes++;
                        characters[charIndex].classList.add('incorrect');
                    }
                    charIndex++;
                }

                characters.forEach(span => span.classList.remove('current'));
                if(charIndex < characters.length) {
                    characters[charIndex].classList.add('current');
                } else {
                    endGame();
                }

                calculateStats();
            }
        });

        // Focus input on any key press or click
        document.addEventListener('keydown', () => {
            if(isPlaying) inputField.focus();
        });
        
        startBtn.addEventListener('click', () => {
            inputField.focus();
        });

        // Initialize on load
        window.onload = initGame;
    </script>
</body>
</html>