<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Typing Speed Test</title>
<style>
    body{
        font-family: "Segoe UI", Tahoma, sans-serif;
        background: #f3f5f7;
        color: #1c1f26;
        margin:0;
        padding:0;
        display:flex;
        justify-content:center;
        align-items:flex-start;
    }
    .container{
        width: 900px;
        max-width: 95vw;
        background: #fff;
        margin: 30px 0;
        box-shadow: 0 20px 40px rgba(0,0,0,0.08);
        border-radius: 12px;
        padding: 28px 32px 36px;
    }
    h1{
        margin-top:0;
        font-size: 28px;
        letter-spacing: 0.3px;
        color:#0e1726;
    }
    .stats{
        display:flex;
        gap:24px;
        flex-wrap:wrap;
        margin: 12px 0 18px;
    }
    .stat-box{
        background: #f7f9fb;
        border: 1px solid #e4e9f1;
        border-radius: 10px;
        padding: 12px 14px;
        flex: 1 1 150px;
        min-width: 150px;
    }
    .stat-label{
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 1px;
        color:#6f7a90;
        margin-bottom: 4px;
    }
    .stat-value{
        font-size: 24px;
        font-weight: 700;
        color:#0d1524;
    }
    .paragraph{
        border: 1px solid #e3e6ee;
        background: #fbfcff;
        border-radius: 10px;
        padding: 18px;
        min-height: 120px;
        line-height: 1.6;
        font-size: 18px;
        letter-spacing: 0.2px;
        position: relative;
    }
    .paragraph .char{
        white-space: pre-wrap;
        padding: 1px 0;
    }
    .char.correct{ color: #22b573; }
    .char.incorrect{ color: #e74c3c; background: rgba(231,76,60,0.12); }
    .char.current{
        position: relative;
    }
    .char.current::after{
        content:'';
        position: absolute;
        left:0;
        right:0;
        bottom:-2px;
        height:2px;
        background:#3b82f6;
        animation: blink 1s step-start 0s infinite;
    }
    @keyframes blink{
        50%{opacity:0;}
    }
    textarea{
        width: 100%;
        box-sizing:border-box;
        margin-top:18px;
        font-size: 18px;
        padding: 12px;
        border-radius: 10px;
        border: 1px solid #d5dbe7;
        outline: none;
        resize: none;
        min-height: 120px;
        transition: border-color 0.2s, box-shadow 0.2s;
    }
    textarea:focus{
        border-color: #3b82f6;
        box-shadow: 0 0 0 3px rgba(59,130,246,0.18);
    }
    .controls{
        display:flex;
        align-items:center;
        gap:12px;
        margin-top:14px;
        flex-wrap: wrap;
    }
    button{
        padding: 10px 18px;
        border: none;
        background: #3b82f6;
        color: #fff;
        font-size: 15px;
        border-radius: 8px;
        cursor:pointer;
        transition: transform 0.08s ease, box-shadow 0.2s;
        box-shadow: 0 10px 18px rgba(59,130,246,0.25);
    }
    button:hover{ transform: translateY(-1px); }
    button:active{ transform: translateY(0); box-shadow:none;}
    .final{
        margin-top: 16px;
        padding: 14px;
        border-radius: 10px;
        background: #eef6ff;
        border: 1px solid #d9e8ff;
        display:none;
    }
    .final h3{ margin:0 0 8px; }
    .pill{
        display:inline-block;
        padding:6px 10px;
        border-radius: 999px;
        background:#e9edf5;
        color:#3c4455;
        font-size: 13px;
        margin-right:6px;
        margin-top:4px;
    }
</style>
</head>
<body>
<div class="container">
    <h1>Typing Speed Test</h1>

    <div class="stats">
        <div class="stat-box">
            <div class="stat-label">Time Left</div>
            <div class="stat-value" id="time">30s</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">WPM</div>
            <div class="stat-value" id="wpm">0</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">Accuracy</div>
            <div class="stat-value" id="accuracy">100%</div>
        </div>
        <div class="stat-box">
            <div class="stat-label">Characters</div>
            <div class="stat-value" id="chars">0 / 0</div>
        </div>
    </div>

    <div class="paragraph" id="paragraph"></div>

    <textarea id="input" placeholder="Start typing here..." disabled></textarea>

    <div class="controls">
        <button id="restart">Try Another Text</button>
        <span style="color:#6f7a90;">Starts when you begin typing. Test ends at 30 seconds or when the paragraph is complete.</span>
    </div>

    <div class="final" id="final">
        <h3>Test complete</h3>
        <div id="final-stats"></div>
    </div>
</div>

<script>
(function(){
    const samples = [
        "The curious fox darted through the meadow, weaving between tall grasses and wildflowers that swayed in the warm summer breeze.",
        "A good cup of coffee can change the course of a morning, nudging sleepy ideas into motion and making stubborn problems seem smaller.",
        "When the storm cleared, the sky turned the softest shade of blue, and the world smelled like wet earth and pine needles.",
        "She stacked the books in alphabetical order, then rearranged them by color because it made the shelf feel like a piece of art.",
        "Typing is a dance between fingers and thoughts, where rhythm matters less than honesty and clarity on the page.",
        "Mountains don't whisper advice, yet hikers return with answers to questions they didn't know how to ask.",
        "The old clock in the hallway ticked loudly, marking the quiet moments that nobody noticed until it suddenly stopped.",
        "In the glow of the campfire, stories grew taller, jokes got funnier, and time stretched longer than anyone expected.",
        "Ideas are like seeds: some sprout quickly in bright sunlight, while others wait patiently for a change in weather.",
        "On rainy afternoons, the city softens, colors deepen, and strangers huddle together beneath umbrellas like old friends."
    ];

    const paragraphEl = document.getElementById('paragraph');
    const inputEl = document.getElementById('input');
    const timeEl = document.getElementById('time');
    const wpmEl = document.getElementById('wpm');
    const accuracyEl = document.getElementById('accuracy');
    const charsEl = document.getElementById('chars');
    const restartBtn = document.getElementById('restart');
    const finalBox = document.getElementById('final');
    const finalStats = document.getElementById('final-stats');

    const TEST_DURATION = 30; // seconds
    let currentText = '';
    let timer = TEST_DURATION;
    let intervalId = null;
    let started = false;
    let startTime = null;
    let finished = false;

    function pickText(){
        const idx = Math.floor(Math.random()*samples.length);
        return samples[idx];
    }

    function renderParagraph(){
        paragraphEl.innerHTML = '';
        for(let i=0;i<currentText.length;i++){
            const span = document.createElement('span');
            span.className = 'char';
            span.textContent = currentText[i];
            paragraphEl.appendChild(span);
        }
    }

    function reset(){
        stopTimer();
        currentText = pickText();
        timer = TEST_DURATION;
        started = false;
        finished = false;
        startTime = null;
        inputEl.value = '';
        inputEl.disabled = false;
        inputEl.focus();
        renderParagraph();
        updateHighlight();
        updateStats(0,0);
        timeEl.textContent = `${timer}s`;
        finalBox.style.display = 'none';
        charsEl.textContent = `0 / ${currentText.length}`;
    }

    function stopTimer(){
        if(intervalId){
            clearInterval(intervalId);
            intervalId = null;
        }
    }

    function startTimer(){
        startTime = performance.now();
        intervalId = setInterval(()=>{
            const elapsed = Math.floor((performance.now() - startTime)/1000);
            const remaining = Math.max(0, TEST_DURATION - elapsed);
            timer = remaining;
            timeEl.textContent = `${remaining}s`;
            if(remaining <= 0){
                endTest();
            }
        }, 200);
    }

    function updateHighlight(){
        const spans = paragraphEl.querySelectorAll('.char');
        const typed = inputEl.value;
        let correct = 0;
        for(let i=0;i<spans.length;i++){
            const span = spans[i];
            const charTyped = typed[i];
            span.classList.remove('correct','incorrect','current');
            if(charTyped == null){
                // not typed yet
                if(i === typed.length && !finished){
                    span.classList.add('current');
                }
            }else if(charTyped === span.textContent){
                span.classList.add('correct');
                correct++;
            }else{
                span.classList.add('incorrect');
            }
        }
        if(typed.length === spans.length && !finished){
            // caret after end
            spans[spans.length-1].classList.remove('current');
        }
        return correct;
    }

    function updateStats(correctCount, typedCount){
        const elapsedMs = started ? (performance.now() - startTime) : 0;
        const minutes = elapsedMs>0 ? elapsedMs / 1000 / 60 : 0;
        const grossWpm = minutes>0 ? (typedCount/5)/minutes : 0;
        const netWpm = minutes>0 ? (correctCount/5)/minutes : 0;
        const wpm = Math.max(0, Math.round(netWpm));
        const accuracy = typedCount>0 ? Math.round((correctCount/typedCount)*100) : 100;

        wpmEl.textContent = wpm;
        accuracyEl.textContent = `${accuracy}%`;
        charsEl.textContent = `${typedCount} / ${currentText.length}`;
        return {wpm, accuracy};
    }

    function endTest(){
        if(finished) return;
        finished = true;
        stopTimer();
        inputEl.disabled = true;
        const typed = inputEl.value;
        const correct = updateHighlight();
        const stats = updateStats(correct, typed.length);
        finalBox.style.display = 'block';
        finalStats.innerHTML = `
            <span class="pill">WPM: <strong>${stats.wpm}</strong></span>
            <span class="pill">Accuracy: <strong>${stats.accuracy}%</strong></span>
            <span class="pill">Time: <strong>${TEST_DURATION - timer}s</strong></span>
            <span class="pill">Characters: <strong>${typed.length}/${currentText.length}</strong></span>
        `;
    }

    inputEl.addEventListener('input', ()=>{
        if(finished) return;
        if(!started){
            started = true;
            startTimer();
        }
        const typed = inputEl.value;
        const correct = updateHighlight();
        const stats = updateStats(correct, typed.length);
        if(typed.length >= currentText.length){
            endTest();
        }
    });

    restartBtn.addEventListener('click', reset);

    // init
    currentText = pickText();
    renderParagraph();
    charsEl.textContent = `0 / ${currentText.length}`;
    inputEl.disabled = false;
    inputEl.focus();
})();
</script>
</body>
</html>