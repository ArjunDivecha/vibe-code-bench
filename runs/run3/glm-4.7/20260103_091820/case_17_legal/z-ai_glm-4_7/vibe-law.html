<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vibe-Law | Legal Case Search Workspace</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0e17;
            --bg-secondary: #111827;
            --bg-tertiary: #1a2332;
            --bg-hover: #242f42;
            --border-color: #2d3a4f;
            --text-primary: #e2e8f0;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --accent-blue: #3b82f6;
            --accent-blue-hover: #2563eb;
            --accent-gold: #f59e0b;
            --highlight-name: #06b6d4;
            --highlight-date: #a855f7;
            --highlight-org: #22c55e;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Header */
        header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 1.5rem;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 1rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo-icon {
            width: 36px;
            height: 36px;
            background: linear-gradient(135deg, var(--accent-blue), var(--accent-gold));
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .logo-text {
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .logo-text span {
            color: var(--accent-blue);
        }

        .search-container {
            flex: 1;
            max-width: 600px;
            position: relative;
        }

        .search-input {
            width: 100%;
            padding: 0.875rem 1rem 0.875rem 2.75rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 0.95rem;
            transition: all 0.2s;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .btn {
            padding: 0.625rem 1rem;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--accent-blue);
            color: white;
        }

        .btn-primary:hover {
            background: var(--accent-blue-hover);
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
        }

        .btn-sm {
            padding: 0.4rem 0.75rem;
            font-size: 0.8rem;
        }

        /* Main Layout */
        main {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1.5rem;
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 1.5rem;
            min-height: calc(100vh - 73px);
        }

        /* Results Section */
        .results-section {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .results-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--border-color);
        }

        .results-count {
            color: var(--text-secondary);
            font-size: 0.875rem;
        }

        .case-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .case-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.25rem;
            cursor: pointer;
            transition: all 0.2s;
        }

        .case-card:hover {
            border-color: var(--accent-blue);
            background: var(--bg-tertiary);
        }

        .case-card.active {
            border-color: var(--accent-blue);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
        }

        .case-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 1rem;
            margin-bottom: 0.75rem;
        }

        .case-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            line-height: 1.4;
        }

        .case-meta {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .case-court {
            background: var(--bg-tertiary);
            padding: 0.25rem 0.625rem;
            border-radius: 4px;
            font-size: 0.75rem;
            color: var(--accent-blue);
            font-weight: 500;
        }

        .case-date {
            color: var(--text-muted);
            font-size: 0.8rem;
        }

        .case-citation {
            color: var(--text-secondary);
            font-size: 0.8rem;
            font-style: italic;
        }

        .case-snippet {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.6;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Detail View */
        .detail-view {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            height: fit-content;
            max-height: calc(100vh - 120px);
            position: sticky;
            top: 100px;
        }

        .detail-header {
            padding: 1.25rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 1rem;
        }

        .detail-title {
            font-size: 1.25rem;
            font-weight: 600;
            line-height: 1.4;
        }

        .detail-close {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            padding: 0.25rem;
            font-size: 1.25rem;
        }

        .detail-close:hover {
            color: var(--text-primary);
        }

        .detail-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            background: var(--bg-tertiary);
        }

        .tab-btn {
            flex: 1;
            padding: 0.875rem 1rem;
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-weight: 500;
            font-size: 0.9rem;
            transition: all 0.2s;
            border-bottom: 2px solid transparent;
        }

        .tab-btn:hover {
            color: var(--text-primary);
            background: var(--bg-hover);
        }

        .tab-btn.active {
            color: var(--accent-blue);
            border-bottom-color: var(--accent-blue);
        }

        .detail-content {
            padding: 1.25rem;
            overflow-y: auto;
            flex: 1;
            max-height: 400px;
        }

        .detail-actions {
            padding: 1rem 1.25rem;
            border-top: 1px solid var(--border-color);
            display: flex;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .content-text {
            color: var(--text-secondary);
            line-height: 1.8;
            font-size: 0.95rem;
        }

        .content-text p {
            margin-bottom: 1rem;
        }

        .content-text h3 {
            color: var(--text-primary);
            font-size: 1rem;
            margin: 1.25rem 0 0.75rem;
        }

        /* Entity Highlights */
        .highlight-name {
            background: rgba(6, 182, 212, 0.2);
            color: var(--highlight-name);
            padding: 0.125rem 0.25rem;
            border-radius: 3px;
            font-weight: 500;
        }

        .highlight-date {
            background: rgba(168, 85, 247, 0.2);
            color: var(--highlight-date);
            padding: 0.125rem 0.25rem;
            border-radius: 3px;
            font-weight: 500;
        }

        .highlight-org {
            background: rgba(34, 197, 94, 0.2);
            color: var(--highlight-org);
            padding: 0.125rem 0.25rem;
            border-radius: 3px;
            font-weight: 500;
        }

        /* Notes Sidebar */
        .notes-sidebar {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            height: fit-content;
            max-height: calc(100vh - 120px);
            position: sticky;
            top: 100px;
        }

        .notes-header {
            padding: 1.25rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .notes-title {
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .notes-list {
            padding: 1rem;
            overflow-y: auto;
            flex: 1;
            max-height: 500px;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .note-item {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 0.875rem;
            position: relative;
        }

        .note-case {
            font-size: 0.75rem;
            color: var(--accent-blue);
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .note-text {
            color: var(--text-secondary);
            font-size: 0.85rem;
            line-height: 1.5;
            font-style: italic;
        }

        .note-delete {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 1rem;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .note-item:hover .note-delete {
            opacity: 1;
        }

        .note-delete:hover {
            color: #ef4444;
        }

        .notes-empty {
            text-align: center;
            padding: 2rem;
            color: var(--text-muted);
            font-size: 0.875rem;
        }

        .add-note-form {
            padding: 1rem;
            border-top: 1px solid var(--border-color);
        }

        .note-input {
            width: 100%;
            padding: 0.75rem;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-size: 0.875rem;
            resize: vertical;
            min-height: 80px;
            margin-bottom: 0.75rem;
        }

        .note-input:focus {
            outline: none;
            border-color: var(--accent-blue);
        }

        .note-input::placeholder {
            color: var(--text-muted);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-muted);
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        .empty-state h3 {
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        /* Hidden Detail Placeholder */
        .detail-placeholder {
            background: var(--bg-secondary);
            border: 1px dashed var(--border-color);
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 3rem;
            color: var(--text-muted);
            text-align: center;
        }

        .detail-placeholder-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            opacity: 0.4;
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border-color);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-muted);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            main {
                grid-template-columns: 1fr;
            }

            .detail-view, .notes-sidebar {
                position: static;
                max-height: none;
            }
        }

        @media (max-width: 640px) {
            .header-content {
                flex-wrap: wrap;
            }

            .search-container {
                order: 3;
                max-width: 100%;
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">‚öñ</div>
                <div class="logo-text">Vibe<span>Law</span></div>
            </div>
            <div class="search-container">
                <span class="search-icon">üîç</span>
                <input type="text" class="search-input" id="searchInput" placeholder="Search case law by title, court, or keywords...">
            </div>
            <div class="header-actions">
                <button class="btn btn-secondary" onclick="clearSelection()">Clear</button>
            </div>
        </div>
    </header>

    <main>
        <section class="results-section">
            <div class="results-header">
                <h2>Case Results</h2>
                <span class="results-count" id="resultsCount">Loading...</span>
            </div>
            <div class="case-list" id="caseList">
                <!-- Cases will be rendered here -->
            </div>
        </section>

        <section class="detail-section">
            <div id="detailPlaceholder" class="detail-placeholder">
                <div class="detail-placeholder-icon">üìã</div>
                <h3>Select a Case</h3>
                <p>Click on any case from the list to view details</p>
            </div>
            <div id="detailView" class="detail-view" style="display: none;">
                <div class="detail-header">
                    <h3 class="detail-title" id="detailTitle">Case Title</h3>
                    <button class="detail-close" onclick="closeDetailView()">√ó</button>
                </div>
                <div class="detail-tabs">
                    <button class="tab-btn active" data-tab="summary" onclick="switchTab('summary')">Summary</button>
                    <button class="tab-btn" data-tab="fulltext" onclick="switchTab('fulltext')">Full Text</button>
                </div>
                <div class="detail-content" id="detailContent">
                    <!-- Content will be rendered here -->
                </div>
                <div class="detail-actions">
                    <button class="btn btn-primary btn-sm" onclick="extractEntities()">‚ú® Extract Entities</button>
                    <button class="btn btn-secondary btn-sm" onclick="addCurrentToNotes()">üìå Save Snippet</button>
                </div>
            </div>
        </section>

        <aside class="notes-sidebar">
            <div class="notes-header">
                <div class="notes-title">
                    <span>üìù</span> Notes
                </div>
                <button class="btn btn-secondary btn-sm" onclick="clearAllNotes()">Clear All</button>
            </div>
            <div class="notes-list" id="notesList">
                <!-- Notes will be rendered here -->
            </div>
            <div class="add-note-form">
                <textarea class="note-input" id="noteInput" placeholder="Add a custom note..."></textarea>
                <button class="btn btn-primary btn-sm" style="width: 100%" onclick="addCustomNote()">Add Note</button>
            </div>
        </aside>
    </main>

    <script>
        // Mock Legal Cases Data
        const mockCases = [
            {
                id: 1,
                title: "Miranda v. Arizona",
                court: "Supreme Court of the United States",
                date: "June 13, 1966",
                citation: "384 U.S. 436",
                snippet: "The Supreme Court held that the Fifth Amendment's protection against self-incrimination requires law enforcement officials to advise a suspect of their rights before interrogation begins.",
                summary: "This landmark case established the Miranda warning, requiring police to inform suspects of their right to remain silent and their right to an attorney before custodial interrogation. The Court ruled that statements made without such warnings are inadmissible as evidence.",
                fullText: "The opinion of the Court, delivered by Chief Justice Earl Warren, held that the prosecution may not use statements stemming from custodial interrogation of the defendant unless it demonstrates the use of procedural safeguards effective to secure the privilege against self-incrimination. As Chief Justice Warren stated, 'The person must be warned that he has a right to remain silent, that any statement he does make may be used as evidence against him, and that he has a right to the presence of an attorney, either retained or appointed.' The defendant, Ernesto Miranda, had signed a confession without being informed of these rights. The Court's decision fundamentally changed police procedures across the United States and established what are now known as Miranda Rights."
            },
            {
                id: 2,
                title: "Brown v. Board of Education",
                court: "Supreme Court of the United States",
                date: "May 17, 1954",
                citation: "347 U.S. 483",
                snippet: "The Court declared that state laws establishing separate public schools for black and white students were unconstitutional, overturning Plessy v. Ferguson.",
                summary: "This historic decision overturned the 'separate but equal' doctrine established in Plessy v. Ferguson (1896). The Court unanimously ruled that racial segregation in public education violated the Equal Protection Clause of the Fourteenth Amendment.",
                fullText: "Chief Justice Earl Warren delivered the unanimous opinion, stating that 'separate educational facilities are inherently unequal.' The Court based its decision on psychological studies demonstrating the harmful effects of segregation on African American children. Warren wrote, 'To separate them from others of similar age and qualifications solely because of their race generates a feeling of inferiority as to their status in the community that may affect their hearts and minds in a way unlikely ever to be undone.' This decision became the legal foundation for the Civil Rights Movement and led to the desegregation of public schools across America."
            },
            {
                id: 3,
                title: "Roe v. Wade",
                court: "Supreme Court of the United States",
                date: "January 22, 1973",
                citation: "410 U.S. 113",
                snippet: "The Court ruled that the Constitution of the United States generally protected a pregnant woman's liberty to choose to have an abortion.",
                summary: "The Court ruled that the right to privacy under the Due Process Clause of the Fourteenth Amendment extended to a woman's decision to have an abortion. However, this right was not absolute and had to be balanced against the state's interests in protecting women's health and prenatal life.",
                fullText: "Justice Harry Blackmun wrote the majority opinion, which established a trimester framework for evaluating abortion regulations. During the first trimester, states could not regulate abortion except to require that it be performed by a licensed physician. During the second trimester, states could regulate abortion to protect maternal health. During the third trimester, states could prohibit abortion except when necessary to protect the mother's life or health. The decision was one of the most controversial in Supreme Court history and shaped American political discourse for decades."
            },
            {
                id: 4,
                title: "Marbury v. Madison",
                court: "Supreme Court of the United States",
                date: "February 24, 1803",
                citation: "5 U.S. 137",
                snippet: "This case established the principle of judicial review, giving the Supreme Court the power to declare laws unconstitutional.",
                summary: "Chief Justice John Marshall established the doctrine of judicial review, affirming the Supreme Court's power to strike down laws that violate the Constitution. This case is foundational to American constitutional law.",
                fullText: "The case arose from William Marbury's petition for a writ of mandamus to compel Secretary of State James Madison to deliver his commission as justice of the peace. Chief Justice Marshall's opinion addressed three questions: Did Marbury have a right to the commission? Was he entitled to a remedy? Could the Supreme Court issue the remedy? While ruling that Marbury was entitled to his commission, Marshall also held that the Court could not issue the writ because the law granting such authority was unconstitutional. Marshall wrote, 'It is emphatically the province and duty of the judicial department to say what the law is.' This established judicial review as a cornerstone of American constitutional government."
            },
            {
                id: 5,
                title: "Gideon v. Wainwright",
                court: "Supreme Court of the United States",
                date: "March 18, 1963",
                citation: "372 U.S. 335",
                snippet: "The Court held that the Sixth Amendment's guarantee of counsel is a fundamental right essential to a fair trial, applicable to the states through the Fourteenth Amendment.",
                summary: "Clarence Earl Gideon, charged with felony breaking and entering, could not afford an attorney and was forced to represent himself. The Court unanimously ruled that states must provide counsel to indigent defendants in felony cases.",
                fullText: "Justice Hugo Black wrote the unanimous opinion, stating that 'in our adversary system of criminal justice, any person haled into court who is too poor to hire a lawyer cannot be assured a fair trial unless counsel is provided for him.' The Court overruled Betts v. Brady (1942) and incorporated the Sixth Amendment right to counsel to the states through the Fourteenth Amendment's Due Process Clause. Gideon's case was retried with appointed counsel, and he was acquitted. This decision dramatically expanded public defender systems across the United States."
            },
            {
                id: 6,
                title: "Citizens United v. FEC",
                court: "Supreme Court of the United States",
                date: "January 21, 2010",
                citation: "558 U.S. 310",
                snippet: "The Court ruled that the free speech clause of the First Amendment prohibits the government from restricting independent expenditures for political communications by corporations.",
                summary: "In a 5-4 decision, the Court held that political spending is a form of protected speech under the First Amendment, and the government may not ban corporations (including nonprofits, unions, and other associations) from independent political spending.",
                fullText: "Justice Anthony Kennedy wrote the majority opinion, arguing that 'the Government may not suppress political speech on the basis of the speaker's corporate identity. No sufficient governmental interest justifies limits on the political speech of nonprofit or for-profit corporations.' The decision overturned portions of the Bipartisan Campaign Reform Act (McCain-Feingold) and previous Supreme Court decisions in Austin v. Michigan Chamber of Commerce and McConnell v. FEC. The ruling has had profound effects on American campaign finance, leading to the rise of Super PACs and increased independent political expenditures."
            },
            {
                id: 7,
                title: "United States v. Nixon",
                court: "Supreme Court of the United States",
                date: "July 24, 1974",
                citation: "418 U.S. 683",
                snippet: "The Court unanimously ruled that President Nixon must comply with a subpoena for tape recordings, rejecting his claim of absolute executive privilege.",
                summary: "This unanimous decision was a critical blow to the Nixon presidency during the Watergate scandal. The Court held that executive privilege is not absolute and must yield when evidence is needed in a criminal trial.",
                fullText: "Chief Justice Warren Burger wrote the unanimous opinion, stating that 'neither the doctrine of separation of powers, nor the need for confidentiality of high-level communications, without more, can sustain an absolute, unqualified Presidential privilege of immunity from judicial process under all circumstances.' The Court emphasized that the Constitution 'does not absolutely immunize the President from judicial process,' and that the privilege must be balanced against the need for evidence in criminal proceedings. Nixon's compliance with the subpoena revealed the 'smoking gun' tape, leading to his resignation on August 9, 1974."
            },
            {
                id: 8,
                title: "Obergefell v. Hodges",
                court: "Supreme Court of the United States",
                date: "June 26, 2015",
                citation: "576 U.S. 644",
                snippet: "The Court ruled that the fundamental right to marry is guaranteed to same-sex couples under the Due Process and Equal Protection Clauses of the Fourteenth Amendment.",
                summary: "In a 5-4 decision, the Court held that state bans on same-sex marriage are unconstitutional. This decision legalized same-sex marriage nationwide and was a landmark victory for LGBTQ+ rights.",
                fullText: "Justice Anthony Kennedy wrote the majority opinion, joined by the Court's liberal justices. Kennedy wrote, 'No union is more profound than marriage, for it embodies the highest ideals of love, fidelity, devotion, sacrifice, and family. In forming a marital union, two people become something greater than once they were.' The Court held that the right to marry is a fundamental right inherent in the liberty of the person, and that same-sex couples may not be deprived of that right. The decision consolidated several cases from Michigan, Kentucky, Ohio, and Tennessee, and required all states to perform and recognize same-sex marriages."
            },
            {
                id: 9,
                title: "Terry v. Ohio",
                court: "Supreme Court of the United States",
                date: "June 10, 1968",
                citation: "392 U.S. 1",
                snippet: "The Court held that police may stop and frisk a person if they have reasonable suspicion that criminal activity is afoot.",
                summary: "This case established the 'stop and frisk' doctrine, allowing law enforcement officers to conduct brief investigatory stops and limited searches for weapons based on reasonable suspicion rather than probable cause.",
                fullText: "Chief Justice Earl Warren wrote the majority opinion, upholding the conviction of Terry based on evidence obtained during a stop and frisk. Warren explained that 'a police officer may in appropriate circumstances and in an appropriate manner approach a person for purposes of investigating possibly criminal behavior even though there is no probable cause to make an arrest.' The Court reasoned that the Fourth Amendment's reasonableness standard, rather than its warrant requirement, governs such brief stops. The decision has been highly influential in criminal procedure and has been the subject of ongoing debate regarding racial profiling and police practices."
            },
            {
                id: 10,
                title: "New York Times Co. v. Sullivan",
                court: "Supreme Court of the United States",
                date: "March 9, 1964",
                citation: "376 U.S. 254",
                snippet: "The Court established the 'actual malice' standard for defamation claims by public officials, requiring proof that false statements were made with knowledge of falsity or reckless disregard for truth.",
                summary: "This First Amendment case revolutionized defamation law, making it significantly harder for public officials to win libel suits and providing robust protection for press freedom.",
                fullText: "Justice William Brennan wrote the unanimous opinion, holding that 'the constitutional guarantees require, we think, a federal rule that prohibits a public official from recovering damages for a defamatory falsehood centering on his official conduct unless he proves "actual malice"‚Äîthat the statement was made with knowledge of its falsity or with reckless disregard of whether it was true or false.' The Court emphasized that 'debate on public issues should be uninhibited, robust, and wide-open, and that it may well include vehement, caustic, and sometimes unpleasantly sharp attacks on government and public officials.' This decision has been called 'the landmark case' in First Amendment law."
            },
            {
                id: 11,
                title: "Mapp v. Ohio",
                court: "Supreme Court of the United States",
                date: "June 19, 1961",
                citation: "367 U.S. 643",
                snippet: "The Court extended the exclusionary rule to state courts, requiring that evidence obtained in violation of the Fourth Amendment cannot be used in state criminal prosecutions.",
                summary: "This case incorporated the Fourth Amendment's protection against unreasonable searches and seizures to the states through the Fourteenth Amendment, applying the exclusionary rule to state proceedings.",
                fullText: "Justice Tom Clark wrote the majority opinion, overruling Wolf v. Colorado (1949). Clark stated that 'all evidence obtained by searches and seizures in violation of the Constitution is, by that same authority, inadmissible in a state court.' The case arose when Dollree Mapp was convicted based on obscene materials found during an illegal police search of her home. The Court held that the exclusionary rule was 'an essential part' of the Fourth Amendment's privacy protections. This decision significantly strengthened constitutional protections against unreasonable searches and required state law enforcement to obtain warrants based on probable cause."
            },
            {
                id: 12,
                title: "District of Columbia v. Heller",
                court: "Supreme Court of the United States",
                date: "June 26, 2008",
                citation: "554 U.S. 570",
                snippet: "The Court held that the Second Amendment protects an individual's right to possess a firearm for self-defense, unconnected with service in a militia.",
                summary: "In a 5-4 decision, the Court affirmed that the Second Amendment guarantees an individual right to keep and bear arms, striking down D.C.'s handgun ban as unconstitutional.",
                fullText: "Justice Antonin Scalia wrote the majority opinion, holding that 'the Second Amendment protects an individual right to possess a firearm unconnected with service in a militia, and to use that arm for traditionally lawful purposes, such as self-defense within the home.' The Court distinguished the Amendment's prefatory clause from its operative clause, concluding that the right is not limited to militia service. However, Scalia noted that the right is not unlimited and that reasonable regulations, such as prohibitions on firearm possession by felons and the mentally ill, remain permissible. This was the first Supreme Court case to explicitly affirm an individual's right to gun ownership under the Second Amendment."
            },
            {
                id: 13,
                title: "Bush v. Gore",
                court: "Supreme Court of the United States",
                date: "December 12, 2000",
                citation: "531 U.S. 98",
                snippet: "The Court ruled that the Florida Supreme Court's method for recounting ballots was unconstitutional, effectively ending the recount and determining the outcome of the 2000 presidential election.",
                summary: "In a controversial 5-4 per curiam decision, the Court halted the Florida recount, leading to George W. Bush's victory over Al Gore in the presidential election.",
                fullText: "The per curiam opinion held that the Florida Supreme Court's recount scheme violated the Equal Protection Clause because it lacked uniform standards for evaluating ballots. The Court stated that 'the recount process, in its features here described, is inconsistent with the minimum procedures necessary to protect the fundamental right of each voter.' The Court also found that under Florida election law, no alternative recount method could be established before the December 12 'safe harbor' deadline for selecting electors. The decision was highly controversial, with critics arguing it represented judicial overreach and that different justices might have reached different conclusions. The case remains one of the most debated in Supreme Court history."
            },
            {
                id: 14,
                title: "Shaw v. Reno",
                court: "Supreme Court of the United States",
                date: "June 28, 1993",
                citation: "509 U.S. 630",
                snippet: "The Court held that redistricting based on race can violate the Equal Protection Clause, even if the purpose is to create majority-minority districts.",
                summary: "This case established that racial gerrymandering‚Äîdrawing district lines primarily based on race‚Äîmust be subject to strict scrutiny under the Equal Protection Clause.",
                fullText: "Justice Sandra Day O'Connor wrote the majority opinion, holding that 'a plaintiff challenging a reapportionment statute under the Equal Protection Clause may state a claim by alleging that the legislation, though race-neutral on its face, rationally cannot be understood as anything other than an effort to separate voters on the basis of race.' The Court emphasized that 'appearances do matter' and that bizarrely shaped districts primarily designed to segregate voters by race raise constitutional concerns. The decision launched a new era of Supreme Court scrutiny of redistricting plans and has been influential in subsequent voting rights cases."
            },
            {
                id: 15,
                title: "Kelo v. City of New London",
                court: "Supreme Court of the United States",
                date: "June 23, 2005",
                citation: "545 U.S. 469",
                snippet: "The Court held that the city's taking of private property for economic development qualified as a 'public use' under the Fifth Amendment's Takings Clause.",
                summary: "In a controversial 5-4 decision, the Court ruled that economic development benefits constitute a public use under the Takings Clause, allowing governments to use eminent domain for private economic development projects.",
                fullText: "Justice John Paul Stevens wrote the majority opinion, concluding that 'the City's determination that the area was sufficiently distressed to justify a program of economic rejuvenation is entitled to our deference.' The Court held that promoting economic development is a traditional government function and that the City's proposed use qualified as a public use. Justice O'Connor's dissent warned that 'the specter of condemnation hangs over all property. Nothing is to prevent the State from replacing any Motel 6 with a Ritz-Carlton, any home with a shopping mall, or any farm with a factory.' The decision sparked widespread public backlash and led many states to enact laws restricting the use of eminent domain for economic development."
            }
        ];

        // State
        let selectedCase = null;
        let currentTab = 'summary';
        let entitiesExtracted = false;
        let notes = JSON.parse(localStorage.getItem('vibelaw_notes') || '[]');

        // DOM Elements
        const searchInput = document.getElementById('searchInput');
        const caseList = document.getElementById('caseList');
        const resultsCount = document.getElementById('resultsCount');
        const detailPlaceholder = document.getElementById('detailPlaceholder');
        const detailView = document.getElementById('detailView');
        const detailTitle = document.getElementById('detailTitle');
        const detailContent = document.getElementById('detailContent');
        const notesList = document.getElementById('notesList');
        const noteInput = document.getElementById('noteInput');

        // Initialize
        function init() {
            renderCases(mockCases);
            renderNotes();
            setupEventListeners();
        }

        function setupEventListeners() {
            searchInput.addEventListener('input', debounce(handleSearch, 300));
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        function handleSearch(e) {
            const query = e.target.value.toLowerCase().trim();
            const filtered = mockCases.filter(c => 
                c.title.toLowerCase().includes(query) ||
                c.court.toLowerCase().includes(query) ||
                c.snippet.toLowerCase().includes(query) ||
                c.summary.toLowerCase().includes(query)
            );
            renderCases(filtered);
        }

        function renderCases(cases) {
            resultsCount.textContent = `${cases.length} case${cases.length !== 1 ? 's' : ''} found`;
            
            if (cases.length === 0) {
                caseList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üîç</div>
                        <h3>No cases found</h3>
                        <p>Try adjusting your search terms</p>
                    </div>
                `;
                return;
            }

            caseList.innerHTML = cases.map(c => `
                <div class="case-card ${selectedCase?.id === c.id ? 'active' : ''}" onclick="selectCase(${c.id})">
                    <div class="case-header">
                        <h3 class="case-title">${highlightSearchTerm(c.title)}</h3>
                    </div>
                    <div class="case-meta">
                        <span class="case-court">${c.court}</span>
                        <span class="case-date">${c.date}</span>
                        <span class="case-citation">${c.citation}</span>
                    </div>
                    <p class="case-snippet">${highlightSearchTerm(c.snippet)}</p>
                </div>
            `).join('');
        }

        function highlightSearchTerm(text) {
            const query = searchInput.value.toLowerCase().trim();
            if (!query) return text;
            
            const regex = new RegExp(`(${escapeRegex(query)})`, 'gi');
            return text.replace(regex, '<mark style="background: rgba(59, 130, 246, 0.3); padding: 0.125rem 0.25rem; border-radius: 2px;">$1</mark>');
        }

        function escapeRegex(string) {
            return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }

        function selectCase(id) {
            selectedCase = mockCases.find(c => c.id === id);
            entitiesExtracted = false;
            currentTab = 'summary';
            
            // Update UI
            document.querySelectorAll('.case-card').forEach(card => card.classList.remove('active'));
            renderCases(getFilteredCases());
            
            detailPlaceholder.style.display = 'none';
            detailView.style.display = 'flex';
            
            updateDetailView();
            updateTabs();
        }

        function getFilteredCases() {
            const query = searchInput.value.toLowerCase().trim();
            return mockCases.filter(c => 
                c.title.toLowerCase().includes(query) ||
                c.court.toLowerCase().includes(query) ||
                c.snippet.toLowerCase().includes(query)
            );
        }

        function updateDetailView() {
            if (!selectedCase) return;
            
            detailTitle.textContent = `${selectedCase.title} (${selectedCase.citation})`;
            
            if (currentTab === 'summary') {
                detailContent.innerHTML = `
                    <div class="content-text" id="textContent">
                        <h3>Summary</h3>
                        <p>${selectedCase.summary}</p>
                        <h3>Case Information</h3>
                        <p><strong>Court:</strong> ${selectedCase.court}</p>
                        <p><strong>Date:</strong> ${selectedCase.date}</p>
                        <p><strong>Citation:</strong> ${selectedCase.citation}</p>
                    </div>
                `;
            } else {
                detailContent.innerHTML = `
                    <div class="content-text" id="textContent">
                        <h3>Full Text</h3>
                        <p>${selectedCase.fullText}</p>
                    </div>
                `;
            }
            
            if (entitiesExtracted) {
                applyEntityHighlights();
            }
        }

        function switchTab(tab) {
            currentTab = tab;
            updateTabs();
            updateDetailView();
        }

        function updateTabs() {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.tab === currentTab);
            });
        }

        function extractEntities() {
            if (!selectedCase) return;
            
            entitiesExtracted = true;
            applyEntityHighlights();
        }

        function applyEntityHighlights() {
            const textContent = document.getElementById('textContent');
            if (!textContent) return;
            
            let html = textContent.innerHTML;
            
            // Highlight names (capitalized words that look like names)
            html = html.replace(/\b([A-Z][a-z]+)\s+([A-Z][a-z]+)\b/g, '<span class="highlight-name">$1 $2</span>');
            
            // Highlight dates
            html = html.replace(/\b((January|February|March|April|May|June|July|August|September|October|November|December)\s+\d{1,2},?\s+\d{4}|\d{4})\b/g, '<span class="highlight-date">$1</span>');
            
            // Highlight organizations/courts
            html = html.replace(/\b(Supreme Court|Congress|Senate|House of Representatives|Constitution|First Amendment|Second Amendment|Fourth Amendment|Fifth Amendment|Sixth Amendment|Fourteenth Amendment)\b/g, '<span class="highlight-org">$1</span>');
            
            textContent.innerHTML = html;
        }

        function closeDetailView() {
            selectedCase = null;
            entitiesExtracted = false;
            detailView.style.display = 'none';
            detailPlaceholder.style.display = 'flex';
            document.querySelectorAll('.case-card').forEach(card => card.classList.remove('active'));
        }

        function clearSelection() {
            searchInput.value = '';
            closeDetailView();
            renderCases(mockCases);
        }

        function addCurrentToNotes() {
            if (!selectedCase) {
                alert('Please select a case first');
                return;
            }
            
            const snippet = currentTab === 'summary' ? selectedCase.summary : selectedCase.fullText.substring(0, 200) + '...';
            
            const note = {
                id: Date.now(),
                caseId: selectedCase.id,
                caseTitle: selectedCase.title,
                text: snippet,
                timestamp: new Date().toISOString()
            };
            
            notes.unshift(note);
            saveNotes();
            renderNotes();
        }

        function addCustomNote() {
            const text = noteInput.value.trim();
            if (!text) {
                alert('Please enter a note');
                return;
            }
            
            const note = {
                id: Date.now(),
                caseId: selectedCase?.id || null,
                caseTitle: selectedCase?.title || 'General Note',
                text: text,
                timestamp: new Date().toISOString()
            };
            
            notes.unshift(note);
            noteInput.value = '';
            saveNotes();
            renderNotes();
        }

        function deleteNote(id) {
            notes = notes.filter(n => n.id !== id);
            saveNotes();
            renderNotes();
        }

        function clearAllNotes() {
            if (notes.length === 0) return;
            if (confirm('Are you sure you want to delete all notes?')) {
                notes = [];
                saveNotes();
                renderNotes();
            }
        }

        function saveNotes() {
            localStorage.setItem('vibelaw_notes', JSON.stringify(notes));
        }

        function renderNotes() {
            if (notes.length === 0) {
                notesList.innerHTML = `
                    <div class="notes-empty">
                        <p>No notes yet</p>
                        <p style="font-size: 0.75rem; margin-top: 0.5rem;">Save snippets from cases or add custom notes</p>
                    </div>
                `;
                return;
            }

            notesList.innerHTML = notes.map(n => `
                <div class="note-item">
                    <button class="note-delete" onclick="deleteNote(${n.id})">√ó</button>
                    <div class="note-case">${n.caseTitle}</div>
                    <p class="note-text">"${n.text}"</p>
                </div>
            `).join('');
        }

        // Initialize app
        init();
    </script>
</body>
</html>