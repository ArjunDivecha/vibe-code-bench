<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Typing Speed Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
            max-width: 800px;
        }

        h1 {
            text-align: center;
        }

        #text-display {
            border: 1px solid #ccc;
            padding: 20px;
            font-size: 1.2em;
            line-height: 1.5em;
            margin-bottom: 20px;
            white-space: pre-wrap;
            min-height: 150px;
        }

        #text-display .correct {
            color: green;
        }

        #text-display .incorrect {
            color: red;
        }

        #input-area {
            width: 100%;
            height: 100px;
            font-size: 1.1em;
        }

        #stats {
            margin-top: 20px;
            font-size: 1.1em;
        }

        #timer {
            font-weight: bold;
        }

        #restart-btn {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 1em;
        }
    </style>
</head>
<body>
    <h1>Typing Speed Test</h1>
    <div id="text-display"></div>
    <textarea id="input-area" placeholder="Start typing here..." disabled></textarea>
    <div id="stats">
        Time: <span id="timer">0</span>s |
        WPM: <span id="wpm">0</span> |
        Accuracy: <span id="accuracy">100</span>%
    </div>
    <button id="restart-btn">Start Test</button>

    <script>
        const textSamples = [
            "The quick brown fox jumps over the lazy dog.",
            "Typing tests are a fun way to improve your speed.",
            "Practice makes perfect, especially when typing.",
            "JavaScript allows you to make interactive web pages.",
            "Always remember to save your work frequently.",
            "A watched pot never boils, or so they say.",
            "She sells seashells by the seashore every day.",
            "Learning to type faster helps your productivity.",
            "Never give up, even when the going gets tough.",
            "To be or not to be, that is the question."
        ];

        const textDisplay = document.getElementById('text-display');
        const inputArea = document.getElementById('input-area');
        const timerDisplay = document.getElementById('timer');
        const wpmDisplay = document.getElementById('wpm');
        const accuracyDisplay = document.getElementById('accuracy');
        const restartBtn = document.getElementById('restart-btn');

        let currentSample = '';
        let timer = null;
        let startTime = null;
        let timeElapsed = 0;
        const TEST_DURATION = 30;

        function getRandomSample() {
            return textSamples[Math.floor(Math.random() * textSamples.length)];
        }

        function renderTextDisplay() {
            textDisplay.innerHTML = '';
            for (const char of currentSample) {
                const span = document.createElement('span');
                span.textContent = char;
                textDisplay.appendChild(span);
            }
        }

        function startTest() {
            currentSample = getRandomSample();
            renderTextDisplay();
            inputArea.disabled = false;
            inputArea.value = '';
            inputArea.focus();
            startTime = Date.now();
            timeElapsed = 0;
            timerDisplay.textContent = '0';
            wpmDisplay.textContent = '0';
            accuracyDisplay.textContent = '100';
            resetHighlights();
            if (timer) clearInterval(timer);
            timer = setInterval(updateTimer, 1000);
        }

        function updateTimer() {
            const now = Date.now();
            timeElapsed = Math.floor((now - startTime) / 1000);
            timerDisplay.textContent = timeElapsed;
            if (timeElapsed >= TEST_DURATION) {
                endTest();
            }
        }

        function endTest() {
            clearInterval(timer);
            inputArea.disabled = true;
            updateStats(); // one last update
        }

        function resetHighlights() {
            const spans = textDisplay.querySelectorAll('span');
            spans.forEach(span => {
                span.classList.remove('correct', 'incorrect');
            });
        }

        function updateStats() {
            const input = inputArea.value;
            let correctChars = 0;
            const spans = textDisplay.querySelectorAll('span');
            for (let i = 0; i < spans.length; i++) {
                const char = input[i];
                const span = spans[i];
                if (char == null) {
                    span.classList.remove('correct', 'incorrect');
                } else if (char === span.textContent) {
                    span.classList.add('correct');
                    span.classList.remove('incorrect');
                    correctChars++;
                } else {
                    span.classList.add('incorrect');
                    span.classList.remove('correct');
                }
            }

            const wordsTyped = input.trim().split(/\s+/).length;
            const minutes = timeElapsed / 60;
            const wpm = minutes > 0 ? Math.round((wordsTyped) / minutes) : 0;
            wpmDisplay.textContent = wpm;

            const totalTyped = input.length;
            const accuracy = totalTyped > 0 ? Math.round((correctChars / totalTyped) * 100) : 100;
            accuracyDisplay.textContent = accuracy;
        }

        inputArea.addEventListener('input', () => {
            updateStats();
        });

        restartBtn.addEventListener('click', () => {
            startTest();
        });

    </script>
</body>
</html>