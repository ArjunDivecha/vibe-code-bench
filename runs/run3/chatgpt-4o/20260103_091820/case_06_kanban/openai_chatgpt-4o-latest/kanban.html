<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Kanban Board</title>
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: #f4f4f4;
        }
        h1 {
            text-align: center;
            padding: 1em;
            background-color: #333;
            color: white;
            margin: 0;
        }
        .board {
            display: flex;
            justify-content: space-around;
            padding: 1em;
        }
        .column {
            background: #e2e2e2;
            padding: 1em;
            border-radius: 5px;
            width: 30%;
            min-height: 400px;
        }
        .column h2 {
            text-align: center;
        }
        .card {
            background: white;
            padding: 0.5em;
            margin: 0.5em 0;
            border-radius: 5px;
            cursor: move;
        }
        .card.low {
            border-left: 5px solid green;
        }
        .card.medium {
            border-left: 5px solid orange;
        }
        .card.urgent {
            border-left: 5px solid red;
        }
        .add-card {
            display: flex;
            flex-direction: column;
            gap: 0.5em;
            margin-top: 1em;
        }
        .add-card input, .add-card select, .add-card button {
            padding: 0.5em;
        }
        .card:hover {
            background-color: #f0f0f0;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 10;
            left: 0; top: 0;
            width: 100%; height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        .modal-content {
            background: white;
            margin: 10% auto;
            padding: 1em;
            width: 300px;
            border-radius: 5px;
        }
        .modal-content input, .modal-content select, .modal-content button {
            margin-top: 0.5em;
            width: 100%;
            padding: 0.5em;
        }
    </style>
</head>
<body>
    <h1>Kanban Board</h1>
    <div class="board">
        <div class="column" data-status="todo">
            <h2>To Do</h2>
            <div class="card-list" id="todo"></div>
            <div class="add-card">
                <input type="text" id="todo-title" placeholder="Card title">
                <select id="todo-priority">
                    <option value="low">Low</option>
                    <option value="medium">Medium</option>
                    <option value="urgent">Urgent</option>
                </select>
                <button onclick="addCard('todo')">Add</button>
            </div>
        </div>
        <div class="column" data-status="inprogress">
            <h2>In Progress</h2>
            <div class="card-list" id="inprogress"></div>
            <div class="add-card">
                <input type="text" id="inprogress-title" placeholder="Card title">
                <select id="inprogress-priority">
                    <option value="low">Low</option>
                    <option value="medium">Medium</option>
                    <option value="urgent">Urgent</option>
                </select>
                <button onclick="addCard('inprogress')">Add</button>
            </div>
        </div>
        <div class="column" data-status="done">
            <h2>Done</h2>
            <div class="card-list" id="done"></div>
            <div class="add-card">
                <input type="text" id="done-title" placeholder="Card title">
                <select id="done-priority">
                    <option value="low">Low</option>
                    <option value="medium">Medium</option>
                    <option value="urgent">Urgent</option>
                </select>
                <button onclick="addCard('done')">Add</button>
            </div>
        </div>
    </div>

    <div class="modal" id="editModal">
        <div class="modal-content">
            <h3>Edit Card</h3>
            <input type="text" id="editTitle">
            <select id="editPriority">
                <option value="low">Low</option>
                <option value="medium">Medium</option>
                <option value="urgent">Urgent</option>
            </select>
            <button onclick="saveEdit()">Save</button>
            <button onclick="deleteCard()">Delete</button>
            <button onclick="closeModal()">Cancel</button>
        </div>
    </div>

    <script>
        let draggedCard = null;
        let editCardId = null;

        function uuid() {
            return '_' + Math.random().toString(36).substr(2, 9);
        }

        function addCard(status) {
            const titleInput = document.getElementById(status + '-title');
            const prioritySelect = document.getElementById(status + '-priority');
            const title = titleInput.value.trim();
            const priority = prioritySelect.value;

            if (!title) return;

            const card = {
                id: uuid(),
                title: title,
                priority: priority,
                status: status
            };

            const cards = getCards();
            cards.push(card);
            saveCards(cards);
            titleInput.value = '';
            renderCards();
        }

        function getCards() {
            return JSON.parse(localStorage.getItem('kanbanCards') || '[]');
        }

        function saveCards(cards) {
            localStorage.setItem('kanbanCards', JSON.stringify(cards));
        }

        function renderCards() {
            ['todo', 'inprogress', 'done'].forEach(status => {
                const list = document.getElementById(status);
                list.innerHTML = '';
            });

            const cards = getCards();
            cards.forEach(card => {
                const div = document.createElement('div');
                div.className = 'card ' + card.priority;
                div.draggable = true;
                div.textContent = card.title;
                div.dataset.id = card.id;

                div.addEventListener('dragstart', e => {
                    draggedCard = card;
                });

                div.addEventListener('click', e => {
                    editCardId = card.id;
                    document.getElementById('editTitle').value = card.title;
                    document.getElementById('editPriority').value = card.priority;
                    document.getElementById('editModal').style.display = 'block';
                });

                document.getElementById(card.status).appendChild(div);
            });
        }

        document.querySelectorAll('.card-list').forEach(list => {
            list.addEventListener('dragover', e => {
                e.preventDefault();
            });
            list.addEventListener('drop', e => {
                e.preventDefault();
                if (draggedCard) {
                    const cards = getCards();
                    const index = cards.findIndex(c => c.id === draggedCard.id);
                    if (index !== -1) {
                        cards[index].status = list.id;
                        saveCards(cards);
                        renderCards();
                    }
                }
            });
        });

        function saveEdit() {
            const newTitle = document.getElementById('editTitle').value.trim();
            const newPriority = document.getElementById('editPriority').value;

            if (!newTitle) return;

            const cards = getCards();
            const index = cards.findIndex(c => c.id === editCardId);
            if (index !== -1) {
                cards[index].title = newTitle;
                cards[index].priority = newPriority;
                saveCards(cards);
                renderCards();
                closeModal();
            }
        }

        function deleteCard() {
            let cards = getCards();
            cards = cards.filter(c => c.id !== editCardId);
            saveCards(cards);
            renderCards();
            closeModal();
        }

        function closeModal() {
            document.getElementById('editModal').style.display = 'none';
            editCardId = null;
        }

        window.onclick = function(event) {
            const modal = document.getElementById('editModal');
            if (event.target == modal) {
                closeModal();
            }
        }

        renderCards();
    </script>
</body>
</html>