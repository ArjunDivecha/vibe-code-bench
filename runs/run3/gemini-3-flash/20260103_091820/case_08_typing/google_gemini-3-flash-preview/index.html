<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speed Typer</title>
    <style>
        :root {
            --bg-color: #1a1a1a;
            --text-color: #e0e0e0;
            --accent-color: #4CAF50;
            --error-color: #ff5252;
            --dim-color: #666;
            --card-bg: #2d2d2d;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            width: 100%;
            background: var(--card-bg);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        h1 {
            text-align: center;
            margin-bottom: 2rem;
            color: var(--accent-color);
        }

        #stats-bar {
            display: flex;
            justify-content: space-around;
            margin-bottom: 1.5rem;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .stat-box {
            background: rgba(0,0,0,0.2);
            padding: 10px 20px;
            border-radius: 8px;
            min-width: 120px;
            text-align: center;
        }

        .stat-label {
            font-size: 0.8rem;
            color: var(--dim-color);
            text-transform: uppercase;
            display: block;
        }

        #text-display {
            font-size: 1.4rem;
            line-height: 1.6;
            margin-bottom: 1.5rem;
            letter-spacing: 0.5px;
            word-break: break-word;
            user-select: none;
            padding: 15px;
            background: rgba(255,255,255,0.05);
            border-radius: 8px;
        }

        #text-display span {
            position: relative;
        }

        .char-correct {
            color: var(--accent-color);
        }

        .char-incorrect {
            color: var(--error-color);
            background: rgba(255, 82, 82, 0.2);
            text-decoration: underline;
        }

        .char-current {
            border-bottom: 3px solid var(--accent-color);
            animation: blink 1s infinite;
        }

        @keyframes blink {
            50% { border-color: transparent; }
        }

        #input-area {
            width: 100%;
            background: transparent;
            border: 2px solid var(--dim-color);
            color: var(--text-color);
            font-size: 1.2rem;
            padding: 12px;
            border-radius: 8px;
            outline: none;
            box-sizing: border-box;
            transition: border-color 0.3s;
        }

        #input-area:focus {
            border-color: var(--accent-color);
        }

        .controls {
            margin-top: 2rem;
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        button {
            background: var(--accent-color);
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 1rem;
            border-radius: 6px;
            cursor: pointer;
            transition: opacity 0.2s, transform 0.1s;
        }

        button:hover {
            opacity: 0.9;
        }

        button:active {
            transform: scale(0.98);
        }

        #results-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            align-items: center;
            justify-content: center;
            z-index: 100;
        }

        .modal-content {
            background: var(--card-bg);
            padding: 3rem;
            border-radius: 12px;
            text-align: center;
            max-width: 400px;
            width: 90%;
        }

        .modal-content h2 {
            margin-top: 0;
        }

        .final-stat {
            font-size: 2.5rem;
            color: var(--accent-color);
            margin: 10px 0;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Speed Typer</h1>

    <div id="stats-bar">
        <div class="stat-box">
            <span class="stat-label">Time</span>
            <span id="timer">30s</span>
        </div>
        <div class="stat-box">
            <span class="stat-label">WPM</span>
            <span id="wpm">0</span>
        </div>
        <div class="stat-box">
            <span class="stat-label">Accuracy</span>
            <span id="accuracy">100%</span>
        </div>
    </div>

    <div id="text-display"></div>
    
    <input type="text" id="input-area" placeholder="Start typing here..." autocomplete="off">

    <div class="controls">
        <button id="reset-btn">New Test / Reset</button>
    </div>
</div>

<div id="results-modal">
    <div class="modal-content">
        <h2>Test Complete!</h2>
        <div>
            <span class="stat-label">Final WPM</span>
            <div id="final-wpm" class="final-stat">0</div>
        </div>
        <div>
            <span class="stat-label">Accuracy</span>
            <div id="final-accuracy" class="final-stat">0%</div>
        </div>
        <button onclick="closeModal()">Try Again</button>
    </div>
</div>

<script>
    const samples = [
        "The quick brown fox jumps over the lazy dog.",
        "Programming is the art of telling another human what one wants the computer to do.",
        "Success is not final, failure is not fatal: it is the courage to continue that counts.",
        "In the end, we will remember not the words of our enemies, but the silence of our friends.",
        "A journey of a thousand miles begins with a single step.",
        "To be or not to be, that is the question: whether 'tis nobler in the mind to suffer.",
        "Life is what happens when you're busy making other plans.",
        "The only way to do great work is to love what you do.",
        "Information is not knowledge. Knowledge is not wisdom. Wisdom is not truth.",
        "The best time to plant a tree was twenty years ago. The second best time is now."
    ];

    const DURATION = 30;
    let timer = DURATION;
    let interval = null;
    let isStarted = false;
    let currentText = "";
    let mistakes = 0;
    let typedChars = 0;

    const display = document.getElementById('text-display');
    const input = document.getElementById('input-area');
    const timerEl = document.getElementById('timer');
    const wpmEl = document.getElementById('wpm');
    const accuracyEl = document.getElementById('accuracy');
    const resetBtn = document.getElementById('reset-btn');
    const modal = document.getElementById('results-modal');

    function init() {
        clearInterval(interval);
        isStarted = false;
        timer = DURATION;
        mistakes = 0;
        typedChars = 0;
        input.value = "";
        input.disabled = false;
        timerEl.innerText = timer + "s";
        wpmEl.innerText = "0";
        accuracyEl.innerText = "100%";
        
        // Select random text
        currentText = samples[Math.floor(Math.random() * samples.length)];
        
        // Render text spans
        display.innerHTML = "";
        currentText.split('').forEach((char, index) => {
            const span = document.createElement('span');
            span.innerText = char;
            if (index === 0) span.classList.add('char-current');
            display.appendChild(span);
        });
        
        input.focus();
    }

    function startTimer() {
        isStarted = true;
        interval = setInterval(() => {
            timer--;
            timerEl.innerText = timer + "s";
            
            if (timer <= 0) {
                finish();
            }
        }, 1000);
    }

    function updateStats() {
        const timeElapsed = DURATION - timer;
        if (timeElapsed <= 0) return;

        // WPM = (chars / 5) / minutes
        const wpm = Math.round(((typedChars - mistakes) / 5) / (timeElapsed / 60));
        wpmEl.innerText = wpm > 0 ? wpm : 0;

        const accuracy = Math.round(((typedChars - mistakes) / typedChars) * 100);
        accuracyEl.innerText = (accuracy >= 0 ? accuracy : 100) + "%";
    }

    function finish() {
        clearInterval(interval);
        input.disabled = true;
        
        document.getElementById('final-wpm').innerText = wpmEl.innerText;
        document.getElementById('final-accuracy').innerText = accuracyEl.innerText;
        modal.style.display = 'flex';
    }

    function closeModal() {
        modal.style.display = 'none';
        init();
    }

    input.addEventListener('input', (e) => {
        if (!isStarted && input.value.length > 0) {
            startTimer();
        }

        const val = input.value.split('');
        const spans = display.querySelectorAll('span');
        
        typedChars = val.length;
        mistakes = 0;

        spans.forEach((span, i) => {
            const char = val[i];
            
            // Reset classes
            span.classList.remove('char-correct', 'char-incorrect', 'char-current');

            if (char == null) {
                if (i === val.length) span.classList.add('char-current');
            } else {
                if (char === span.innerText) {
                    span.classList.add('char-correct');
                } else {
                    span.classList.add('char-incorrect');
                    mistakes++;
                }
            }
        });

        updateStats();

        // Auto-finish if text completed
        if (val.length >= currentText.length) {
            finish();
        }
    });

    resetBtn.addEventListener('click', init);

    // Initial load
    init();
</script>

</body>
</html>