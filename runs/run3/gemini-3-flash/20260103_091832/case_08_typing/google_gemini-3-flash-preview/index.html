<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Speed Typer</title>
    <style>
        :root {
            --bg: #121213;
            --text: #d7dadc;
            --correct: #538d4e;
            --incorrect: #e22d2d;
            --highlight: #818384;
            --accent: #d1d0c5;
        }

        body {
            font-family: 'Courier New', Courier, monospace;
            background-color: var(--bg);
            color: var(--text);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            width: 100%;
        }

        h1 {
            text-align: center;
            color: var(--accent);
            letter-spacing: 2px;
        }

        #stats-container {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent);
        }

        #text-display {
            font-size: 1.5rem;
            line-height: 1.6;
            margin-bottom: 20px;
            background: #1e1e1f;
            padding: 20px;
            border-radius: 8px;
            user-select: none;
            word-wrap: break-word;
            position: relative;
        }

        .char {
            border-bottom: 2px solid transparent;
        }

        .char.correct {
            color: var(--correct);
        }

        .char.incorrect {
            color: var(--incorrect);
            background-color: rgba(226, 45, 45, 0.2);
        }

        .char.current {
            border-bottom: 2px solid var(--accent);
            animation: blink 1s infinite;
        }

        @keyframes blink {
            50% { border-color: transparent; }
        }

        #input-field {
            position: absolute;
            opacity: 0;
            z-index: -1;
        }

        .input-trigger {
            width: 100%;
            height: 100px;
            background: transparent;
            border: 2px dashed #3a3a3c;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        .input-trigger:hover {
            border-color: var(--accent);
        }

        .results {
            text-align: center;
            display: none;
            background: #1e1e1f;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        button {
            background-color: var(--accent);
            color: var(--bg);
            border: none;
            padding: 10px 25px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            border-radius: 4px;
            margin-top: 20px;
            transition: opacity 0.2s;
        }

        button:hover {
            opacity: 0.8;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>SPEED TYPER</h1>

    <div id="stats-container">
        <div>WPM: <span id="wpm">0</span></div>
        <div>Time: <span id="timer">30</span>s</div>
        <div>Acc: <span id="accuracy">100</span>%</div>
    </div>

    <div id="text-display"></div>
    
    <input type="text" id="input-field" autocomplete="off" autofocus>
    
    <div class="input-trigger" id="focus-area">
        Click here or just start typing...
    </div>

    <div id="results-screen" class="results">
        <h2>Test Complete!</h2>
        <p>Final WPM: <span id="final-wpm">0</span></p>
        <p>Accuracy: <span id="final-accuracy">0</span>%</p>
        <p>Characters: <span id="final-chars">0</span></p>
        <button onclick="resetGame()">Try Again</button>
    </div>
</div>

<script>
    const samples = [
        "The quick brown fox jumps over the lazy dog in the middle of a sunny afternoon while others watched in complete silence.",
        "Programming is not about what you know; it is about what you can figure out using logic and documentation.",
        "A journey of a thousand miles begins with a single step, but you must ensure you are heading in the right direction.",
        "The mysterious island was hidden by a thick fog that never seemed to lift regardless of the season or time of day.",
        "In the future, artificial intelligence will help humans solve complex problems that were once thought to be impossible.",
        "Coffee is a brewed drink prepared from roasted coffee beans, the seeds of berries from certain flowering plants.",
        "To be or not to be, that is the question whether it is nobler in the mind to suffer the slings and arrows of fortune.",
        "Success is not final, failure is not fatal: it is the courage to continue that counts in the long run of life.",
        "The stars twinkled brightly in the night sky, casting a faint glow over the calm waters of the mountain lake.",
        "Web development involves creating websites for the internet using languages like HTML, CSS, and JavaScript."
    ];

    let timer = 30;
    let timeLeft = timer;
    let timerInterval = null;
    let isPlaying = false;
    let currentText = "";
    let charIndex = 0;
    let mistakes = 0;
    let totalCharsTyped = 0;

    const textDisplay = document.getElementById('text-display');
    const inputField = document.getElementById('input-field');
    const timerEl = document.getElementById('timer');
    const wpmEl = document.getElementById('wpm');
    const accEl = document.getElementById('accuracy');
    const focusArea = document.getElementById('focus-area');
    const resultsScreen = document.getElementById('results-screen');

    function initGame() {
        const randomIndex = Math.floor(Math.random() * samples.length);
        currentText = samples[randomIndex];
        textDisplay.innerHTML = "";
        
        currentText.split("").forEach(char => {
            const span = document.createElement('span');
            span.classList.add('char');
            span.innerText = char;
            textDisplay.appendChild(span);
        });
        
        textDisplay.querySelectorAll('.char')[0].classList.add('current');
        
        // Reset variables
        timeLeft = timer;
        charIndex = 0;
        mistakes = 0;
        totalCharsTyped = 0;
        isPlaying = false;
        clearInterval(timerInterval);
        
        // UI Reset
        timerEl.innerText = timeLeft;
        wpmEl.innerText = 0;
        accEl.innerText = 100;
        inputField.value = "";
        resultsScreen.style.display = "none";
        textDisplay.classList.remove('hidden');
        focusArea.classList.remove('hidden');
        inputField.focus();
    }

    function startTimer() {
        isPlaying = true;
        timerInterval = setInterval(() => {
            if (timeLeft > 0) {
                timeLeft--;
                timerEl.innerText = timeLeft;
                updateStats();
            } else {
                endGame();
            }
        }, 1000);
    }

    function updateStats() {
        // WPM calculation: (Correct Chars / 5) / (Time Elapsed in Minutes)
        const timeElapsed = (timer - timeLeft) / 60;
        const correctChars = charIndex - mistakes;
        const wpm = timeElapsed > 0 ? Math.round((correctChars / 5) / timeElapsed) : 0;
        wpmEl.innerText = wpm >= 0 ? wpm : 0;

        // Accuracy
        const acc = totalCharsTyped > 0 ? Math.round(((totalCharsTyped - mistakes) / totalCharsTyped) * 100) : 100;
        accEl.innerText = acc;
    }

    function endGame() {
        clearInterval(timerInterval);
        isPlaying = false;
        inputField.blur();
        
        document.getElementById('final-wpm').innerText = wpmEl.innerText;
        document.getElementById('final-accuracy').innerText = accEl.innerText;
        document.getElementById('final-chars').innerText = totalCharsTyped;
        
        resultsScreen.style.display = "block";
        textDisplay.classList.add('hidden');
        focusArea.classList.add('hidden');
    }

    inputField.addEventListener('input', (e) => {
        if (!isPlaying && timeLeft > 0) {
            startTimer();
        }

        const characters = textDisplay.querySelectorAll('.char');
        const typedChar = inputField.value.split("")[charIndex];

        if (charIndex < characters.length && timeLeft > 0) {
            if (typedChar == null) {
                // Handle backspace if needed (though we use a standard input, 
                // we treat this logic as forward-only for simplicity in this specific UI)
            } else {
                totalCharsTyped++;
                if (characters[charIndex].innerText === typedChar) {
                    characters[charIndex].classList.add('correct');
                } else {
                    mistakes++;
                    characters[charIndex].classList.add('incorrect');
                }
                
                characters[charIndex].classList.remove('current');
                charIndex++;
                
                if (charIndex < characters.length) {
                    characters[charIndex].classList.add('current');
                } else {
                    endGame();
                }
            }
            updateStats();
        }
    });

    // Handle focus
    focusArea.addEventListener('click', () => inputField.focus());
    document.addEventListener('keydown', () => {
        if (resultsScreen.style.display !== "block") {
            inputField.focus();
        }
    });

    function resetGame() {
        initGame();
    }

    // Initialize on load
    initGame();
</script>

</body>
</html>