<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Typing Speed Test</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 20px;
        }
        .text-display {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #f9f9f9;
            min-height: 120px;
        }
        .char-correct {
            color: green;
            background-color: #e8f5e8;
        }
        .char-incorrect {
            color: red;
            background-color: #ffe8e8;
            text-decoration: underline;
        }
        .char-current {
            background-color: #d4e6f1;
            border-left: 2px solid #3498db;
            padding-left: 1px;
        }
        .input-area {
            width: 100%;
            margin-bottom: 20px;
        }
        #typing-input {
            width: 100%;
            height: 100px;
            padding: 15px;
            font-size: 18px;
            border: 1px solid #ddd;
            border-radius: 5px;
            resize: none;
            box-sizing: border-box;
        }
        #typing-input:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 5px rgba(52, 152, 219, 0.3);
        }
        .stats {
            display: flex;
            justify-content: space-around;
            margin-bottom: 20px;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
        }
        .stat-box {
            padding: 10px;
            border-radius: 5px;
            background-color: #f0f0f0;
            flex: 1;
            margin: 0 5px;
        }
        button {
            display: block;
            width: 200px;
            margin: 20px auto;
            padding: 12px;
            font-size: 18px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        .completed {
            text-align: center;
            font-size: 20px;
            margin: 20px 0;
            color: #2c3e50;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Typing Speed Test</h1>
        
        <div class="stats">
            <div class="stat-box">
                WPM: <span id="wpm">0</span>
            </div>
            <div class="stat-box">
                Accuracy: <span id="accuracy">0%</span>
            </div>
            <div class="stat-box">
                Time: <span id="time">0s</span>
            </div>
        </div>
        
        <div id="text-display" class="text-display"></div>
        
        <div class="input-area">
            <textarea id="typing-input" placeholder="Start typing here..." disabled></textarea>
        </div>
        
        <div id="result" class="completed"></div>
        
        <button id="restart-button">Try Again</button>
    </div>

    <script>
        // Array of text samples for the typing test
        const textSamples = [
            "The quick brown fox jumps over the lazy dog. This pangram contains every letter of the alphabet at least once, making it perfect for typing practice and keyboard testing.",
            "Programming is the process of creating a set of instructions that tell a computer how to perform a task. Programming can be done using a variety of computer programming languages.",
            "The Internet is a global network of billions of computers and smart devices that are all connected to each other. Through the Internet, people can share information and communicate from anywhere.",
            "Artificial intelligence is intelligence demonstrated by machines, in contrast to the natural intelligence displayed by humans and animals. Leading AI textbooks define the field as the study of intelligent agents.",
            "Photosynthesis is a process used by plants and other organisms to convert light energy into chemical energy that can later be released to fuel the organisms' activities.",
            "The human brain is the command center for the human nervous system. It receives signals from the body's sensory organs and outputs information to the muscles. The human brain has the same basic structure as other mammal brains.",
            "Climate change refers to long-term shifts in temperatures and weather patterns. Such shifts can be natural, due to changes in the sun's activity or large volcanic eruptions.",
            "A computer is a machine that can be instructed to carry out sequences of arithmetic or logical operations automatically via computer programming.",
            "The solar system consists of the Sun and the astronomical objects gravitationally bound to it. The eight planets of the solar system orbit the Sun with their various moons and other objects.",
            "Music is an art form and cultural activity whose medium is sound organized in time. The common elements of music are pitch, rhythm, dynamics, and the sonic qualities of timbre and texture."
        ];

        // DOM elements
        const textDisplay = document.getElementById('text-display');
        const typingInput = document.getElementById('typing-input');
        const wpmDisplay = document.getElementById('wpm');
        const accuracyDisplay = document.getElementById('accuracy');
        const timeDisplay = document.getElementById('time');
        const resultDisplay = document.getElementById('result');
        const restartButton = document.getElementById('restart-button');

        // Variables to track the test state
        let currentText = '';
        let startTime = null;
        let timer = null;
        let totalKeystrokes = 0;
        let correctKeystrokes = 0;
        let testCompleted = false;

        // Initialize the test
        function initTest() {
            // Reset variables
            totalKeystrokes = 0;
            correctKeystrokes = 0;
            testCompleted = false;
            startTime = null;
            
            // Clear previous results
            resultDisplay.textContent = '';
            typingInput.value = '';
            wpmDisplay.textContent = '0';
            accuracyDisplay.textContent = '0%';
            timeDisplay.textContent = '0s';
            
            // Clear any existing timer
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            
            // Select a random text sample
            currentText = textSamples[Math.floor(Math.random() * textSamples.length)];
            
            // Display the text with each character wrapped in a span
            textDisplay.innerHTML = '';
            for (let i = 0; i < currentText.length; i++) {
                const charSpan = document.createElement('span');
                charSpan.textContent = currentText[i];
                charSpan.id = `char-${i}`;
                textDisplay.appendChild(charSpan);
            }
            
            // Reset the first character highlight
            if (currentText.length > 0) {
                document.getElementById('char-0').classList.add('char-current');
            }
            
            // Enable the input field and focus on it
            typingInput.disabled = false;
            typingInput.focus();
        }

        // Update the real-time statistics
        function updateStats(currentInput) {
            // Start the timer on first keystroke
            if (startTime === null && currentInput.length > 0) {
                startTime = new Date();
                timer = setInterval(updateTime, 1000);
            }
            
            // Calculate WPM (Words per minute)
            // Standard typing test assumes 5 characters = 1 word
            const timeElapsedMinutes = startTime ? (new Date() - startTime) / 60000 : 0;
            const wpm = timeElapsedMinutes > 0 ? Math.round(currentInput.length / 5 / timeElapsedMinutes) : 0;
            wpmDisplay.textContent = wpm;
            
            // Calculate accuracy
            let correct = 0;
            for (let i = 0; i < currentInput.length; i++) {
                if (i < currentText.length && currentInput[i] === currentText[i]) {
                    correct++;
                }
            }
            
            // Update keystroke counters
            totalKeystrokes = currentInput.length;
            correctKeystrokes = correct;
            
            const accuracy = totalKeystrokes > 0 ? Math.round((correctKeystrokes / totalKeystrokes) * 100) : 0;
            accuracyDisplay.textContent = `${accuracy}%`;
            
            // Update the text display with highlighting
            for (let i = 0; i < currentText.length; i++) {
                const charSpan = document.getElementById(`char-${i}`);
                charSpan.className = '';
                
                if (i === currentInput.length && !testCompleted) {
                    // Highlight the current character to be typed
                    charSpan.classList.add('char-current');
                }
                
                if (i < currentInput.length) {
                    // Highlight correct/incorrect characters
                    if (currentInput[i] === currentText[i]) {
                        charSpan.classList.add('char-correct');
                    } else {
                        charSpan.classList.add('char-incorrect');
                    }
                }
            }
            
            // Check if the test is complete
            if (currentInput.length === currentText.length && !testCompleted) {
                completeTest();
            }
        }

        // Update the time display
        function updateTime() {
            if (startTime) {
                const seconds = Math.floor((new Date() - startTime) / 1000);
                timeDisplay.textContent = `${seconds}s`;
            }
        }

        // Complete the test
        function completeTest() {
            testCompleted = true;
            
            // Stop the timer
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            
            // Disable the input field
            typingInput.disabled = true;
            
            // Show final results
            const totalTimeMinutes = (new Date() - startTime) / 60000;
            const finalWpm = Math.round(currentText.length / 5 / totalTimeMinutes);
            const finalAccuracy = Math.round((correctKeystrokes / totalKeystrokes) * 100);
            
            resultDisplay.innerHTML = `
                <p>Test Complete!</p>
                <p>Final WPM: <strong>${finalWpm}</strong></p>
                <p>Accuracy: <strong>${finalAccuracy}%</strong></p>
                <p>Time: <strong>${Math.floor((new Date() - startTime) / 1000)} seconds</strong></p>
            `;
        }

        // Event Listeners
        typingInput.addEventListener('input', (e) => {
            updateStats(e.target.value);
        });

        typingInput.addEventListener('keydown', (e) => {
            // Prevent default behavior for backspace to allow corrections
            if (e.key === 'Backspace') {
                // Allow backspace to work normally
                return;
            }
            
            // Optionally, you could add code here to prevent typing ahead
            // of the current position, but it's not necessary for basic functionality
        });

        restartButton.addEventListener('click', () => {
            initTest();
        });

        // Initialize the test when the page loads
        initTest();
    </script>
</body>
</html>