<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Habit Tracker</title>
    <style>
        :root {
            --primary: #4a6fa5;
            --success: #4ade80;
            --success-light: #dcfce7;
            --danger: #f87171;
            --warning: #fbbf24;
            --dark: #1e293b;
            --light: #f8f9fa;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background-color: #f1f5f9;
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            color: var(--primary);
        }
        
        h1 {
            margin: 0;
            font-size: 2.5rem;
        }
        
        .subtitle {
            color: #64748b;
            font-weight: normal;
            margin-top: 5px;
        }
        
        .card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .card-title {
            margin: 0;
            color: var(--primary);
            font-size: 1.3rem;
        }
        
        .habit-form {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .habit-input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid #cbd5e1;
            border-radius: 6px;
            font-size: 1rem;
        }
        
        .habit-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(74, 111, 165, 0.2);
        }
        
        .btn {
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #3a5a8c;
            transform: translateY(-1px);
        }
        
        .btn-sm {
            padding: 6px 12px;
            font-size: 0.9rem;
        }
        
        .btn-outline {
            background: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
        }
        
        .habit-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .habit-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid #f1f5f9;
            transition: background-color 0.2s ease;
        }
        
        .habit-item:hover {
            background-color: #f8fafc;
        }
        
        .habit-item:last-child {
            border-bottom: none;
        }
        
        .habit-info {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .habit-name {
            font-weight: 500;
            margin: 0;
        }
        
        .habit-stats {
            display: flex;
            gap: 15px;
            font-size: 0.85rem;
            color: #64748b;
            margin-top: 4px;
        }
        
        .stat {
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .streak {
            color: var(--success);
            font-weight: 600;
        }
        
        .percentage {
            color: var(--primary);
        }
        
        .habit-actions {
            display: flex;
            gap: 5px;
        }
        
        .btn-icon {
            padding: 6px;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        
        .btn-delete {
            background-color: #f87171;
            color: white;
        }
        
        .btn-delete:hover {
            background-color: #ef4444;
        }
        
        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 6px;
            margin-top: 15px;
        }
        
        .calendar-header {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 6px;
            margin-bottom: 8px;
        }
        
        .calendar-header span {
            text-align: center;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--primary);
            text-transform: uppercase;
        }
        
        .day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            font-size: 0.8rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            background-color: white;
            border: 1px solid #e2e8f0;
        }
        
        .day.today {
            border: 2px solid var(--primary);
            font-weight: 600;
        }
        
        .day.completed {
            background-color: var(--success);
            border-color: var(--success);
            color: white;
        }
        
        .day.empty {
            background-color: #f8fafc;
            border-color: #e2e8f0;
        }
        
        .day:hover:not(.empty) {
            transform: scale(1.05);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .no-habits {
            text-align: center;
            color: #64748b;
            padding: 40px 0;
        }
        
        .motivation {
            text-align: center;
            margin: 20px 0;
            font-style: italic;
            color: var(--primary);
            font-weight: 500;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .habit-form {
                flex-direction: column;
            }
            
            .card-header {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Habit Tracker</h1>
            <p class="subtitle">Build better habits, one day at a time</p>
        </header>
        
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">My Habits</h2>
            </div>
            
            <form class="habit-form" id="habitForm">
                <input type="text" class="habit-input" id="habitInput" placeholder="Add a new habit..." required>
                <button type="submit" class="btn btn-primary">Add Habit</button>
            </form>
            
            <ul class="habit-list" id="habitList">
                <!-- Habits will be added here -->
            </ul>
            
            <div id="noHabits" class="no-habits">
                <p>No habits yet. Add your first habit to get started!</p>
            </div>
        </div>
        
        <div id="calendarSection" class="card" style="display: none;">
            <div class="card-header">
                <h2 class="card-title">Calendar</h2>
                <button id="clearProgress" class="btn btn-outline btn-sm">Clear All Progress</button>
            </div>
            
            <div id="motivation" class="motivation">
                Every day is a new opportunity to grow!
            </div>
            
            <div class="calendar-header">
                <span>Sun</span>
                <span>Mon</span>
                <span>Tue</span>
                <span>Wed</span>
                <span>Thu</span>
                <span>Fri</span>
                <span>Sat</span>
            </div>
            
            <div class="calendar" id="calendar">
                <!-- Calendar days will be generated here -->
            </div>
        </div>
    </div>

    <script>
        // Main Habit Tracker Class
        class HabitTracker {
            constructor() {
                this.habits = [];
                this.currentDate = new Date();
                this.today = this.formatDate(this.currentDate);
                this.motivationalMessages = [
                    "Every day is a new opportunity to grow!",
                    "Small steps lead to big changes!",
                    "Consistency is the key to success!",
                    "You're doing great, keep going!",
                    "Progress, not perfection!",
                    "You've got this!",
                    "Another day, another win!",
                    "Building habits one day at a time!"
                ];
                
                this.initializeElements();
                this.loadFromLocalStorage();
                this.renderHabits();
                this.setupEventListeners();
            }
            
            initializeElements() {
                this.habitForm = document.getElementById('habitForm');
                this.habitInput = document.getElementById('habitInput');
                this.habitList = document.getElementById('habitList');
                this.noHabits = document.getElementById('noHabits');
                this.calendar = document.getElementById('calendar');
                this.calendarSection = document.getElementById('calendarSection');
                this.clearProgressBtn = document.getElementById('clearProgress');
                this.motivation = document.getElementById('motivation');
            }
            
            setupEventListeners() {
                this.habitForm.addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.addHabit();
                });
                
                this.clearProgressBtn.addEventListener('click', () => {
                    if (confirm('Are you sure you want to clear all your progress? This cannot be undone.')) {
                        this.clearAllProgress();
                    }
                });
            }
            
            formatDate(date) {
                // Returns date in YYYY-MM-DD format
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            }
            
            parseDate(dateString) {
                const [year, month, day] = dateString.split('-').map(Number);
                return new Date(year, month - 1, day);
            }
            
            getPast30Days() {
                const days = [];
                const today = new Date();
                
                for (let i = 29; i >= 0; i--) {
                    const date = new Date();
                    date.setDate(today.getDate() - i);
                    days.push(this.formatDate(date));
                }
                
                return days;
            }
            
            addHabit() {
                const name = this.habitInput.value.trim();
                
                if (name && !this.habits.some(habit => habit.name.toLowerCase() === name.toLowerCase())) {
                    const newHabit = {
                        id: Date.now().toString(),
                        name: name,
                        completedDates: [],
                        createdAt: this.today
                    };
                    
                    this.habits.push(newHabit);
                    this.saveToLocalStorage();
                    this.renderHabits();
                    this.habitInput.value = '';
                } else if (this.habits.some(habit => habit.name.toLowerCase() === name.toLowerCase())) {
                    alert('You already have a habit with this name!');
                }
            }
            
            deleteHabit(id) {
                if (confirm('Are you sure you want to delete this habit?')) {
                    this.habits = this.habits.filter(habit => habit.id !== id);
                    this.saveToLocalStorage();
                    this.renderHabits();
                }
            }
            
            toggleHabitStatus(habitId, date) {
                const habit = this.habits.find(h => h.id === habitId);
                if (!habit) return;
                
                const dateIndex = habit.completedDates.indexOf(date);
                if (dateIndex === -1) {
                    habit.completedDates.push(date);
                } else {
                    habit.completedDates.splice(dateIndex, 1);
                }
                
                this.saveToLocalStorage();
                this.renderHabits();
                this.renderCalendar();
            }
            
            calculateStreak(habit) {
                // Sort dates in descending order
                const sortedDates = [...habit.completedDates].sort((a, b) => {
                    return new Date(b) - new Date(a);
                });
                
                if (sortedDates.length === 0) return 0;
                
                // Check if today is completed
                let currentStreak = 0;
                let currentDate = new Date(this.today);
                
                // Start checking from today
                for (let i = 0; i < sortedDates.length; i++) {
                    const date = new Date(sortedDates[i]);
                    
                    // If dates match, increment streak and move to previous day
                    if (date.toDateString() === currentDate.toDateString()) {
                        currentStreak++;
                        currentDate.setDate(currentDate.getDate() - 1);
                    } else if (i === 0) {
                        // If the most recent date isn't today, streak is broken
                        break;
                    } else {
                        // If there's a gap in dates, streak is broken
                        break;
                    }
                }
                
                return currentStreak;
            }
            
            calculateCompletionRate(habit) {
                if (this.habits.length === 0) return 0;
                
                const allDates = this.getPast30Days();
                const completedCount = habit.completedDates.filter(date => 
                    allDates.includes(date)
                ).length;
                
                return Math.round((completedCount / allDates.length) * 100);
            }
            
            clearAllProgress() {
                this.habits.forEach(habit => {
                    habit.completedDates = [];
                });
                
                this.saveToLocalStorage();
                this.renderHabits();
                this.renderCalendar();
            }
            
            saveToLocalStorage() {
                localStorage.setItem('habitTracker_habits', JSON.stringify(this.habits));
            }
            
            loadFromLocalStorage() {
                const saved = localStorage.getItem('habitTracker_habits');
                if (saved) {
                    this.habits = JSON.parse(saved);
                }
            }
            
            getRandomMotivation() {
                const randomIndex = Math.floor(Math.random() * this.motivationalMessages.length);
                return this.motivationalMessages[randomIndex];
            }
            
            renderHabits() {
                // Sort habits by name
                this.habits.sort((a, b) => a.name.localeCompare(b.name));
                
                // Toggle visibility of no habits message
                if (this.habits.length === 0) {
                    this.habitList.innerHTML = '';
                    this.noHabits.style.display = 'block';
                    this.calendarSection.style.display = 'none';
                } else {
                    this.noHabits.style.display = 'none';
                    this.calendarSection.style.display = 'block';
                    
                    // Generate habit list
                    this.habitList.innerHTML = this.habits.map(habit => {
                        const streak = this.calculateStreak(habit);
                        const completionRate = this.calculateCompletionRate(habit);
                        
                        return `
                            <li class="habit-item" data-id="${habit.id}">
                                <div class="habit-info">
                                    <p class="habit-name">${habit.name}</p>
                                    <div class="habit-stats">
                                        <span class="stat">
                                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12Z" stroke="currentColor" stroke-width="2"/>
                                                <path d="M12 8V12L15 15" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                            </svg>
                                            <span class="percentage">${completionRate}%</span>
                                        </span>
                                        <span class="stat">
                                            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                <path d="M22 11.08V12C21.9988 14.1564 21.3005 16.2547 20.0093 17.9818C18.7182 19.709 16.9033 20.9785 14.8354 21.6145C12.7674 22.2504 10.5573 22.22 8.5043 21.5273C6.45131 20.8346 4.65528 19.5148 3.35426 17.7521C2.05324 15.9895 1.30856 13.8697 1.22132 11.6917C1.13408 9.5138 1.70918 7.3899 2.86592 5.62275C4.02267 3.85561 5.69434 2.53671 7.65978 1.85501C9.62523 1.17332 11.783 1.16922 13.75 1.84" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                                <path d="M22 4L12 14.01L9 11.01" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                            </svg>
                                            <span class="streak">${streak} day${streak !== 1 ? 's' : ''}</span>
                                        </span>
                                    </div>
                                </div>
                                <div class="habit-actions">
                                    <button class="btn btn-icon btn-delete delete-habit" data-id="${habit.id}">
                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path d="M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                            <path d="M6 6L18 18" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                        </svg>
                                    </button>
                                </div>
                            </li>
                        `;
                    }).join('');
                    
                    // Add event listeners to delete buttons
                    document.querySelectorAll('.delete-habit').forEach(btn => {
                        btn.addEventListener('click', (e) => {
                            this.deleteHabit(e.currentTarget.dataset.id);
                        });
                    });
                }
                
                // Update motivation message
                this.motivation.textContent = this.getRandomMotivation();
                
                // Render calendar after updating habits
                this.renderCalendar();
            }
            
            renderCalendar() {
                if (this.habits.length === 0) {
                    this.calendar.innerHTML = '';
                    return;
                }
                
                const dates = this.getPast30Days();
                const today = this.today;
                
                // Clear existing calendar
                this.calendar.innerHTML = '';
                
                // Add days to calendar
                dates.forEach(date => {
                    const dateObj = this.parseDate(date);
                    const day = dateObj.getDate();
                    const isToday = date === today;
                    
                    const dayElement = document.createElement('div');
                    dayElement.className = `day ${isToday ? 'today' : ''}`;
                    dayElement.textContent = day;
                    dayElement.dataset.date = date;
                    
                    // If no habits have been completed on this date, mark as empty
                    const hasCompletion = this.habits.some(habit => 
                        habit.completedDates.includes(date)
                    );
                    
                    if (!hasCompletion && !isToday) {
                        dayElement.classList.add('empty');
                    }
                    
                    // Add click handler
                    if (hasCompletion || isToday) {
                        dayElement.addEventListener('click', () => {
                            this.showDayModal(date);
                        });
                    }
                    
                    this.calendar.appendChild(dayElement);
                });
            }
            
            showDayModal(date) {
                // Create a temporary modal-like experience
                const selectedDate = this.parseDate(date);
                const formattedDate = selectedDate.toLocaleDateString('en-US', {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric'
                });
                
                // Create overlay
                const overlay = document.createElement('div');
                overlay.style.position = 'fixed';
                overlay.style.top = 0;
                overlay.style.left = 0;
                overlay.style.width = '100%';
                overlay.style.height = '100%';
                overlay.style.backgroundColor = 'rgba(0,0,0,0.5)';
                overlay.style.display = 'flex';
                overlay.style.justifyContent = 'center';
                overlay.style.alignItems = 'center';
                overlay.style.zIndex = '1000';
                
                // Create modal
                const modal = document.createElement('div');
                modal.style.backgroundColor = 'white';
                modal.style.borderRadius = '10px';
                modal.style.padding = '20px';
                modal.style.width = '90%';
                modal.style.maxWidth = '500px';
                modal.style.boxShadow = '0 4px 20px rgba(0,0,0,0.2)';
                
                // Modal header
                const header = document.createElement('h3');
                header.textContent = formattedDate;
                header.style.margin = '0 0 15px 0';
                header.style.color = 'var(--primary)';
                header.style.textAlign = 'center';
                
                // Habits list for this day
                const habitsList = document.createElement('div');
                habitsList.style.maxHeight = '300px';
                habitsList.style.overflowY = 'auto';
                
                // Add each habit as a toggleable item
                this.habits.forEach(habit => {
                    const habitItem = document.createElement('div');
                    habitItem.style.display = 'flex';
                    habitItem.style.alignItems = 'center';
                    habitItem.style.padding = '10px';
                    habitItem.style.marginBottom = '8px';
                    habitItem.style.borderRadius = '6px';
                    habitItem.style.backgroundColor = '#f8fafc';
                    habitItem.style.cursor = 'pointer';
                    habitItem.style.transition = 'all 0.2s ease';
                    
                    habitItem.addEventListener('mouseenter', () => {
                        habitItem.style.backgroundColor = '#e2e8f0';
                    });
                    
                    habitItem.addEventListener('mouseleave', () => {
                        habitItem.style.backgroundColor = '#f8fafc';
                    });
                    
                    // Check if habit is completed on this date
                    const isCompleted = habit.completedDates.includes(date);
                    if (isCompleted) {
                        habitItem.style.backgroundColor = 'var(--success-light)';
                    }
                    
                    // Toggle completion on click
                    habitItem.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.toggleHabitStatus(habit.id, date);
                        
                        // Update the visual state
                        if (habit.completedDates.includes(date)) {
                            habitItem.style.backgroundColor = 'var(--success-light)';
                        } else {
                            habitItem.style.backgroundColor = '#f8fafc';
                        }
                    });
                    
                    // Checkbox
                    const checkbox = document.createElement('div');
                    checkbox.style.width = '20px';
                    checkbox.style.height = '20px';
                    checkbox.style.borderRadius = '4px';
                    checkbox.style.border = '2px solid var(--primary)';
                    checkbox.style.marginRight = '12px';
                    checkbox.style.flexShrink = '0';
                    
                    if (isCompleted) {
                        checkbox.style.backgroundColor = 'var(--success)';
                        checkbox.style.border = '2px solid var(--success)';
                        
                        // Add checkmark
                        const checkmark = document.createElement('svg');
                        checkmark.setAttribute('width', '16');
                        checkmark.setAttribute('height', '16');
                        checkmark.setAttribute('viewBox', '0 0 24 24');
                        checkmark.setAttribute('fill', 'none');
                        checkmark.innerHTML = `
                            <path d="M5 13L9 17L19 7" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                        `;
                        checkbox.appendChild(checkmark);
                    }
                    
                    // Habit name
                    const nameSpan = document.createElement('span');
                    nameSpan.textContent = habit.name;
                    nameSpan.style.fontWeight = '500';
                    
                    habitItem.appendChild(checkbox);
                    habitItem.appendChild(nameSpan);
                    habitsList.appendChild(habitItem);
                });
                
                // Close button
                const closeBtn = document.createElement('button');
                closeBtn.textContent = 'Close';
                closeBtn.className = 'btn btn-primary';
                closeBtn.style.display = 'block';
                closeBtn.style.margin = '20px auto 0 auto';
                closeBtn.style.padding = '10px 20px';
                
                closeBtn.addEventListener('click', () => {
                    document.body.removeChild(overlay);
                });
                
                // Assemble modal
                modal.appendChild(header);
                modal.appendChild(habitsList);
                modal.appendChild(closeBtn);
                overlay.appendChild(modal);
                document.body.appendChild(overlay);
            }
        }
        
        // Initialize the app when the DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            const habitTracker = new HabitTracker();
        });
    </script>
</body>
</html>