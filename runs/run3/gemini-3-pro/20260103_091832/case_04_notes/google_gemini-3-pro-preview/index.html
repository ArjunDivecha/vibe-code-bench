<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimal Notes</title>
    <style>
        :root {
            --bg-color: #f4f4f5;
            --card-bg: #ffffff;
            --text-color: #333;
            --secondary-text: #666;
            --accent-color: #3b82f6;
            --danger-color: #ef4444;
            --border-color: #e5e7eb;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --modal-overlay: rgba(0, 0, 0, 0.5);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.5;
            padding: 20px;
        }

        /* Header & Search */
        header {
            max-width: 1200px;
            margin: 0 auto 30px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            align-items: center;
        }

        @media (min-width: 600px) {
            header {
                flex-direction: row;
                justify-content: space-between;
            }
        }

        h1 {
            font-size: 1.5rem;
            font-weight: 700;
            color: #111;
        }

        .search-container {
            position: relative;
            width: 100%;
            max-width: 400px;
        }

        .search-input {
            width: 100%;
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid var(--border-color);
            font-size: 1rem;
            outline: none;
            transition: border-color 0.2s;
        }

        .search-input:focus {
            border-color: var(--accent-color);
        }

        /* Notes Grid */
        .notes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .note-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            display: flex;
            flex-direction: column;
            height: 250px;
            overflow: hidden;
            border: 1px solid transparent;
        }

        .note-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            border-color: var(--border-color);
        }

        .note-card h3 {
            margin-bottom: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .note-card .preview {
            color: var(--secondary-text);
            font-size: 0.95rem;
            flex-grow: 1;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 7;
            -webkit-box-orient: vertical;
        }
        
        .note-card .date {
            margin-top: 15px;
            font-size: 0.8rem;
            color: #999;
        }

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: var(--accent-color);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            cursor: pointer;
            border: none;
            transition: transform 0.2s, background-color 0.2s;
            z-index: 100;
        }

        .fab:hover {
            transform: scale(1.1);
            background-color: #2563eb;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--modal-overlay);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            z-index: 1000;
            padding: 20px;
        }

        .modal-overlay.active {
            opacity: 1;
            pointer-events: all;
        }

        .modal {
            background-color: var(--card-bg);
            width: 100%;
            max-width: 600px;
            height: 80vh;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .modal-header {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title-input {
            border: none;
            font-size: 1.2rem;
            font-weight: 600;
            width: 100%;
            outline: none;
            color: var(--text-color);
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--secondary-text);
            padding: 0 10px;
        }

        .toolbar {
            padding: 10px 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            gap: 10px;
            background-color: #fafafa;
        }

        .toolbar button {
            background: white;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 5px 10px;
            cursor: pointer;
            font-weight: 600;
            min-width: 30px;
        }

        .toolbar button:hover {
            background: #eee;
        }

        .modal-body {
            flex-grow: 1;
            padding: 20px;
            overflow-y: auto;
            outline: none;
            font-size: 1rem;
            line-height: 1.6;
        }

        .modal-body:empty:before {
            content: 'Type your note here...';
            color: #aaa;
        }

        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .btn {
            padding: 8px 16px;
            border-radius: 6px;
            border: none;
            font-weight: 500;
            cursor: pointer;
            font-size: 0.9rem;
            transition: opacity 0.2s;
        }

        .btn:hover {
            opacity: 0.9;
        }

        .btn-primary {
            background-color: var(--accent-color);
            color: white;
        }

        .btn-danger {
            background-color: var(--danger-color);
            color: white;
        }

        .btn-text {
            background: none;
            color: var(--secondary-text);
        }

        .hidden {
            display: none;
        }
        
        /* Empty State */
        .empty-state {
            text-align: center;
            margin-top: 100px;
            color: var(--secondary-text);
            grid-column: 1 / -1;
        }

    </style>
</head>
<body>

    <header>
        <h1>My Notes</h1>
        <div class="search-container">
            <input type="text" id="searchInput" class="search-input" placeholder="Search notes...">
        </div>
    </header>

    <div id="notesGrid" class="notes-grid">
        <!-- Notes will be injected here -->
    </div>
    
    <div id="emptyState" class="empty-state hidden">
        <p>No notes found. Create one to get started!</p>
    </div>

    <button id="addBtn" class="fab">+</button>

    <!-- Edit/Create Modal -->
    <div id="modalOverlay" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <input type="text" id="noteTitle" class="modal-title-input" placeholder="Note Title">
                <button id="closeModalBtn" class="close-btn">&times;</button>
            </div>
            <div class="toolbar">
                <button onclick="document.execCommand('bold',false,null)" title="Bold">B</button>
                <button onclick="document.execCommand('italic',false,null)" title="Italic">I</button>
                <button onclick="document.execCommand('underline',false,null)" title="Underline">U</button>
            </div>
            <div id="noteContent" class="modal-body" contenteditable="true"></div>
            <div class="modal-footer">
                <button id="deleteBtn" class="btn btn-danger hidden">Delete</button>
                <div style="flex-grow: 1;"></div> <!-- Spacer -->
                <button id="cancelBtn" class="btn btn-text" style="margin-right: 10px;">Cancel</button>
                <button id="saveBtn" class="btn btn-primary">Save Note</button>
            </div>
        </div>
    </div>

    <script>
        // State
        let notes = [];
        let currentNoteId = null;

        // DOM Elements
        const notesGrid = document.getElementById('notesGrid');
        const emptyState = document.getElementById('emptyState');
        const searchInput = document.getElementById('searchInput');
        const addBtn = document.getElementById('addBtn');
        const modalOverlay = document.getElementById('modalOverlay');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const cancelBtn = document.getElementById('cancelBtn');
        const saveBtn = document.getElementById('saveBtn');
        const deleteBtn = document.getElementById('deleteBtn');
        const noteTitleInput = document.getElementById('noteTitle');
        const noteContentDiv = document.getElementById('noteContent');

        // Initialization
        window.addEventListener('DOMContentLoaded', () => {
            loadNotes();
            renderNotes();
        });

        // Event Listeners
        addBtn.addEventListener('click', () => openModal());
        closeModalBtn.addEventListener('click', closeModal);
        cancelBtn.addEventListener('click', closeModal);
        modalOverlay.addEventListener('click', (e) => {
            if (e.target === modalOverlay) closeModal();
        });
        
        saveBtn.addEventListener('click', saveNote);
        deleteBtn.addEventListener('click', deleteNote);
        searchInput.addEventListener('input', (e) => renderNotes(e.target.value));

        // Functions

        function loadNotes() {
            const stored = localStorage.getItem('my-notes-app-data');
            if (stored) {
                notes = JSON.parse(stored);
            }
        }

        function saveNotesToStorage() {
            localStorage.setItem('my-notes-app-data', JSON.stringify(notes));
        }

        function renderNotes(searchTerm = '') {
            notesGrid.innerHTML = '';
            
            // Filter notes
            const filteredNotes = notes.filter(note => {
                const term = searchTerm.toLowerCase();
                // Strip HTML from content for search
                const contentText = note.content.replace(/<[^>]*>?/gm, '');
                return note.title.toLowerCase().includes(term) || 
                       contentText.toLowerCase().includes(term);
            });

            // Sort by date modified (newest first)
            filteredNotes.sort((a, b) => b.timestamp - a.timestamp);

            if (filteredNotes.length === 0) {
                emptyState.classList.remove('hidden');
            } else {
                emptyState.classList.add('hidden');
                filteredNotes.forEach(note => {
                    const card = createNoteCard(note);
                    notesGrid.appendChild(card);
                });
            }
        }

        function createNoteCard(note) {
            const div = document.createElement('div');
            div.className = 'note-card';
            
            const date = new Date(note.timestamp).toLocaleDateString(undefined, {
                year: 'numeric', month: 'short', day: 'numeric'
            });

            // Create preview text (strip html)
            const tmp = document.createElement('DIV');
            tmp.innerHTML = note.content;
            const plainText = tmp.textContent || tmp.innerText || "";
            const previewText = plainText.length > 0 ? plainText : '<i>No content</i>';

            const titleText = note.title.trim() === '' ? 'Untitled Note' : note.title;

            div.innerHTML = `
                <h3>${escapeHtml(titleText)}</h3>
                <div class="preview">${note.content}</div> <!-- Allowing HTML in preview to show formatting, but CSS clamps lines -->
                <div class="date">${date}</div>
            `;

            div.addEventListener('click', () => openModal(note));
            return div;
        }

        function openModal(note = null) {
            if (note) {
                currentNoteId = note.id;
                noteTitleInput.value = note.title;
                noteContentDiv.innerHTML = note.content;
                deleteBtn.classList.remove('hidden');
            } else {
                currentNoteId = null;
                noteTitleInput.value = '';
                noteContentDiv.innerHTML = '';
                deleteBtn.classList.add('hidden');
            }
            modalOverlay.classList.add('active');
            noteTitleInput.focus();
        }

        function closeModal() {
            modalOverlay.classList.remove('active');
        }

        function saveNote() {
            const title = noteTitleInput.value;
            const content = noteContentDiv.innerHTML;
            const timestamp = Date.now();

            if (!title.trim() && !content.trim()) {
                closeModal();
                return;
            }

            if (currentNoteId) {
                // Update existing
                const index = notes.findIndex(n => n.id === currentNoteId);
                if (index !== -1) {
                    notes[index] = { ...notes[index], title, content, timestamp };
                }
            } else {
                // Create new
                const newNote = {
                    id: Date.now().toString(),
                    title,
                    content,
                    timestamp
                };
                notes.push(newNote);
            }

            saveNotesToStorage();
            renderNotes(searchInput.value);
            closeModal();
        }

        function deleteNote() {
            if (currentNoteId && confirm('Are you sure you want to delete this note?')) {
                notes = notes.filter(n => n.id !== currentNoteId);
                saveNotesToStorage();
                renderNotes(searchInput.value);
                closeModal();
            }
        }

        function escapeHtml(text) {
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.replace(/[&<>"']/g, function(m) { return map[m]; });
        }
    </script>
</body>
</html>