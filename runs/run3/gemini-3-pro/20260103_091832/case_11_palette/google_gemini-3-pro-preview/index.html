<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color Palette Generator</title>
    <style>
        :root {
            --bg-color: #f0f2f5;
            --text-color: #333;
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
            --transition-speed: 0.3s;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Nav */
        nav {
            background: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
            z-index: 10;
        }

        nav h1 {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(to right, #ff00cc, #333399);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-controls {
            display: flex;
            gap: 1rem;
        }

        button {
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: transform 0.1s, opacity 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
        }

        button:active {
            transform: scale(0.95);
        }

        .btn-primary {
            background-color: #333;
            color: white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .btn-secondary {
            background-color: white;
            border: 1px solid #ddd;
            color: #333;
        }

        .btn-secondary:hover {
            background-color: #f9f9f9;
        }

        /* Main Palette Area */
        .palette-container {
            flex: 1;
            display: flex;
            width: 100%;
            height: 100%;
        }

        .color-col {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            transition: background-color var(--transition-speed) ease;
        }

        .color-info {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            opacity: 0.9;
            transition: opacity 0.2s;
        }

        .color-info h2 {
            font-size: 1.8rem;
            text-transform: uppercase;
            cursor: pointer;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            transition: background 0.2s;
        }

        .color-info h2:hover {
            background: rgba(255,255,255,0.2);
        }

        .color-info span {
            font-size: 0.9rem;
            font-weight: 500;
            letter-spacing: 1px;
        }

        .color-name {
            font-size: 1.1rem !important;
            font-weight: 700 !important;
            margin-bottom: 5px;
            text-transform: capitalize;
        }

        .lock-btn {
            background: transparent;
            border: none;
            margin-top: 2rem;
            font-size: 1.5rem;
            cursor: pointer;
            opacity: 0.5;
            transition: all 0.2s;
            color: inherit;
        }

        .lock-btn:hover {
            opacity: 1;
            transform: scale(1.1);
        }

        .lock-btn.locked {
            opacity: 1;
        }

        /* Library / Saved Palettes */
        .library-panel {
            position: fixed;
            top: 0;
            right: 0;
            width: 350px;
            height: 100%;
            background: white;
            box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
            z-index: 20;
            display: flex;
            flex-direction: column;
        }

        .library-panel.active {
            transform: translateX(0);
        }

        .library-header {
            padding: 1.5rem;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .close-library {
            background: transparent;
            font-size: 1.5rem;
            color: #333;
            padding: 0;
        }

        .library-content {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
        }

        .saved-palette {
            background: #f9f9f9;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .saved-palette:hover {
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .preview {
            display: flex;
            height: 40px;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .preview-color {
            flex: 1;
        }

        .palette-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            color: #666;
        }

        .delete-btn {
            background: #ff4d4d;
            color: white;
            padding: 0.2rem 0.5rem;
            font-size: 0.7rem;
        }

        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: #333;
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 30px;
            font-weight: 500;
            opacity: 0;
            transition: all 0.3s;
            z-index: 50;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        /* Icons */
        svg {
            width: 20px;
            height: 20px;
            fill: currentColor;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .palette-container {
                flex-direction: column;
            }
            .color-info {
                flex-direction: row;
                justify-content: space-between;
                width: 90%;
            }
            .lock-btn {
                margin-top: 0;
            }
            nav h1 {
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>

    <nav>
        <h1>PaletteGen</h1>
        <div class="nav-controls">
            <button class="btn-secondary" onclick="openLibrary()">
                <svg viewBox="0 0 24 24"><path d="M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"/><path d="M14 17H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
                Library
            </button>
            <button class="btn-primary" onclick="generatePalette()">
                <svg viewBox="0 0 24 24"><path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg>
                Generate
            </button>
            <button class="btn-primary" onclick="savePalette()">
                <svg viewBox="0 0 24 24"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                Save
            </button>
        </div>
    </nav>

    <div class="palette-container" id="palette-container">
        <!-- Columns will be injected here by JS -->
    </div>

    <!-- Library Sidebar -->
    <div class="library-panel" id="library-panel">
        <div class="library-header">
            <h3>Saved Palettes</h3>
            <button class="close-library" onclick="closeLibrary()">&times;</button>
        </div>
        <div class="library-content" id="library-content">
            <!-- Saved items -->
        </div>
    </div>

    <div class="toast" id="toast">Color copied to clipboard!</div>

    <script>
        // --- Data & State ---
        class Color {
            constructor(hex, name, locked = false) {
                this.hex = hex;
                this.name = name;
                this.locked = locked;
            }
        }

        let colors = [];
        const savedPalettesKey = 'paletteGenerator_favorites';

        // Simple Color Name Dictionary (Subset of CSS/Common Colors)
        const colorNames = {
            "#000000": "Black", "#ffffff": "White", "#ff0000": "Red", "#00ff00": "Lime", "#0000ff": "Blue",
            "#ffff00": "Yellow", "#00ffff": "Cyan", "#ff00ff": "Magenta", "#c0c0c0": "Silver", "#808080": "Gray",
            "#800000": "Maroon", "#808000": "Olive", "#008000": "Green", "#800080": "Purple", "#008080": "Teal",
            "#000080": "Navy", "#ffa500": "Orange", "#a52a2a": "Brown", "#fa8072": "Salmon", "#ffc0cb": "Pink",
            "#ffd700": "Gold", "#f0e68c": "Khaki", "#e6e6fa": "Lavender", "#dda0dd": "Plum", "#4b0082": "Indigo",
            "#f5f5dc": "Beige", "#ffe4c4": "Bisque", "#ff7f50": "Coral", "#dc143c": "Crimson", "#b8860b": "DarkGoldenRod",
            "#006400": "DarkGreen", "#bdb76b": "DarkKhaki", "#8b008b": "DarkMagenta", "#556b2f": "DarkOliveGreen",
            "#ff8c00": "DarkOrange", "#9932cc": "DarkOrchid", "#8b0000": "DarkRed", "#e9967a": "DarkSalmon",
            "#9400d3": "DarkViolet", "#ff1493": "DeepPink", "#00bfff": "DeepSkyBlue", "#696969": "DimGray",
            "#1e90ff": "DodgerBlue", "#b22222": "FireBrick", "#228b22": "ForestGreen", "#dcdcdc": "Gainsboro",
            "#f8f8ff": "GhostWhite", "#adff2f": "GreenYellow", "#f0fff0": "Honeydew", "#ff69b4": "HotPink",
            "#cd5c5c": "IndianRed", "#4b0082": "Indigo", "#fffff0": "Ivory", "#f0e68c": "Khaki", "#e6e6fa": "Lavender",
            "#fff0f5": "LavenderBlush", "#7cfc00": "LawnGreen", "#fffacd": "LemonChiffon", "#add8e6": "LightBlue",
            "#f08080": "LightCoral", "#e0ffff": "LightCyan", "#fafad2": "LightGoldenRodYellow", "#d3d3d3": "LightGray",
            "#90ee90": "LightGreen", "#ffb6c1": "LightPink", "#ffa07a": "LightSalmon", "#20b2aa": "LightSeaGreen",
            "#87cefa": "LightSkyBlue", "#778899": "LightSlateGray", "#b0c4de": "LightSteelBlue", "#ffffe0": "LightYellow",
            "#32cd32": "LimeGreen", "#faf0e6": "Linen", "#66cdaa": "MediumAquaMarine", "#0000cd": "MediumBlue",
            "#ba55d3": "MediumOrchid", "#9370db": "MediumPurple", "#3cb371": "MediumSeaGreen", "#7b68ee": "MediumSlateBlue",
            "#00fa9a": "MediumSpringGreen", "#48d1cc": "MediumTurquoise", "#c71585": "MediumVioletRed", "#191970": "MidnightBlue",
            "#f5fffa": "MintCream", "#ffe4e1": "MistyRose", "#ffe4b5": "Moccasin", "#ffdead": "NavajoWhite",
            "#fdf5e6": "OldLace", "#6b8e23": "OliveDrab", "#ff4500": "OrangeRed", "#da70d6": "Orchid",
            "#eee8aa": "PaleGoldenRod", "#98fb98": "PaleGreen", "#afeeee": "PaleTurquoise", "#db7093": "PaleVioletRed",
            "#ffefd5": "PapayaWhip", "#ffdab9": "PeachPuff", "#cd853f": "Peru", "#b0e0e6": "PowderBlue",
            "#bc8f8f": "RosyBrown", "#4169e1": "RoyalBlue", "#8b4513": "SaddleBrown", "#f4a460": "SandyBrown",
            "#2e8b57": "SeaGreen", "#fff5ee": "SeaShell", "#a0522d": "Sienna", "#87ceeb": "SkyBlue",
            "#6a5acd": "SlateBlue", "#708090": "SlateGray", "#fffafa": "Snow", "#00ff7f": "SpringGreen",
            "#4682b4": "SteelBlue", "#d2b48c": "Tan", "#d8bfd8": "Thistle", "#ff6347": "Tomato",
            "#40e0d0": "Turquoise", "#ee82ee": "Violet", "#f5deb3": "Wheat", "#f5f5f5": "WhiteSmoke",
            "#9acd32": "YellowGreen"
        };

        // --- Utils ---

        function generateHex() {
            // Generate visually pleasing colors using HSL
            const h = Math.floor(Math.random() * 360);
            const s = Math.floor(Math.random() * (100 - 50) + 50); // 50-100% saturation
            const l = Math.floor(Math.random() * (70 - 30) + 30);  // 30-70% lightness
            return hslToHex(h, s, l);
        }

        function hslToHex(h, s, l) {
            l /= 100;
            const a = s * Math.min(l, 1 - l) / 100;
            const f = n => {
                const k = (n + h / 30) % 12;
                const color = l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);
                return Math.round(255 * color).toString(16).padStart(2, '0');
            };
            return `#${f(0)}${f(8)}${f(4)}`;
        }

        function hexToRgb(hex) {
            const r = parseInt(hex.slice(1, 3), 16);
            const g = parseInt(hex.slice(3, 5), 16);
            const b = parseInt(hex.slice(5, 7), 16);
            return { r, g, b };
        }

        function getLuminance(r, g, b) {
            const a = [r, g, b].map(function (v) {
                v /= 255;
                return v <= 0.03928 ? v / 12.92 : Math.pow((v + 0.055) / 1.055, 2.4);
            });
            return a[0] * 0.2126 + a[1] * 0.7152 + a[2] * 0.0722;
        }

        function getTextColor(hex) {
            const { r, g, b } = hexToRgb(hex);
            const luminance = getLuminance(r, g, b);
            return luminance > 0.5 ? '#000000' : '#ffffff';
        }

        function findClosestColorName(hex) {
            // Exact match
            if (colorNames[hex]) return colorNames[hex];

            // Nearest Neighbor in RGB space
            const target = hexToRgb(hex);
            let minDistance = Infinity;
            let closestName = "Custom";

            for (const [key, value] of Object.entries(colorNames)) {
                const current = hexToRgb(key);
                const distance = Math.sqrt(
                    Math.pow(target.r - current.r, 2) +
                    Math.pow(target.g - current.g, 2) +
                    Math.pow(target.b - current.b, 2)
                );
                if (distance < minDistance) {
                    minDistance = distance;
                    closestName = value;
                }
            }
            return closestName;
        }

        // --- Core Logic ---

        function init() {
            // Initialize with 5 random colors
            for (let i = 0; i < 5; i++) {
                const hex = generateHex();
                colors.push(new Color(hex, findClosestColorName(hex)));
            }
            renderPalette();
            loadLibrary();
        }

        function generatePalette() {
            colors = colors.map(color => {
                if (color.locked) return color;
                const hex = generateHex();
                return new Color(hex, findClosestColorName(hex), false);
            });
            renderPalette();
        }

        function renderPalette() {
            const container = document.getElementById('palette-container');
            container.innerHTML = '';

            colors.forEach((color, index) => {
                const col = document.createElement('div');
                col.className = 'color-col';
                col.style.backgroundColor = color.hex;
                
                const textColor = getTextColor(color.hex);
                
                const rgb = hexToRgb(color.hex);
                const rgbString = `rgb(${rgb.r}, ${rgb.g}, ${rgb.b})`;

                // Lock Icon SVG
                const lockIcon = color.locked 
                    ? `<path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/>` 
                    : `<path d="M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm0 12H6V10h12v10z"/>`;

                col.innerHTML = `
                    <div class="color-info" style="color: ${textColor}">
                        <span class="color-name">${color.name}</span>
                        <h2 onclick="copyToClipboard('${color.hex}')">${color.hex}</h2>
                        <span>${rgbString}</span>
                        <button class="lock-btn ${color.locked ? 'locked' : ''}" onclick="toggleLock(${index})">
                            <svg viewBox="0 0 24 24">${lockIcon}</svg>
                        </button>
                    </div>
                `;

                container.appendChild(col);
            });
        }

        function toggleLock(index) {
            colors[index].locked = !colors[index].locked;
            renderPalette();
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showToast(`Copied ${text} to clipboard!`);
            });
        }

        function showToast(msg) {
            const toast = document.getElementById('toast');
            toast.innerText = msg;
            toast.classList.add('show');
            setTimeout(() => {
                toast.classList.remove('show');
            }, 2000);
        }

        // --- Library / LocalStorage ---

        function savePalette() {
            const saved = getSavedPalettes();
            saved.push({
                id: Date.now(),
                colors: colors.map(c => ({ hex: c.hex, name: c.name }))
            });
            localStorage.setItem(savedPalettesKey, JSON.stringify(saved));
            loadLibrary();
            showToast('Palette Saved!');
            openLibrary();
        }

        function getSavedPalettes() {
            const raw = localStorage.getItem(savedPalettesKey);
            return raw ? JSON.parse(raw) : [];
        }

        function loadLibrary() {
            const saved = getSavedPalettes();
            const container = document.getElementById('library-content');
            container.innerHTML = '';

            if (saved.length === 0) {
                container.innerHTML = '<p style="color:#888; text-align:center; margin-top:2rem;">No saved palettes yet.</p>';
                return;
            }

            saved.forEach(palette => {
                const div = document.createElement('div');
                div.className = 'saved-palette';
                
                // Construct preview
                let previewHtml = '<div class="preview">';
                palette.colors.forEach(c => {
                    previewHtml += `<div class="preview-color" style="background-color: ${c.hex}"></div>`;
                });
                previewHtml += '</div>';

                div.innerHTML = `
                    ${previewHtml}
                    <div class="palette-meta">
                        <span>${new Date(palette.id).toLocaleDateString()}</span>
                        <button class="delete-btn" onclick="deletePalette(event, ${palette.id})">Delete</button>
                    </div>
                `;

                div.onclick = (e) => {
                    // Don't trigger if delete button clicked
                    if (e.target.classList.contains('delete-btn')) return;
                    loadPaletteFromLibrary(palette.id);
                };

                container.appendChild(div);
            });
        }

        function deletePalette(e, id) {
            e.stopPropagation();
            let saved = getSavedPalettes();
            saved = saved.filter(p => p.id !== id);
            localStorage.setItem(savedPalettesKey, JSON.stringify(saved));
            loadLibrary();
        }

        function loadPaletteFromLibrary(id) {
            const saved = getSavedPalettes();
            const palette = saved.find(p => p.id === id);
            if (palette) {
                colors = palette.colors.map(c => new Color(c.hex, c.name, false));
                renderPalette();
                closeLibrary();
            }
        }

        function openLibrary() {
            document.getElementById('library-panel').classList.add('active');
        }

        function closeLibrary() {
            document.getElementById('library-panel').classList.remove('active');
        }

        // --- Event Listeners ---

        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                generatePalette();
            }
        });

        // Init
        init();

    </script>
</body>
</html>